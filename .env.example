# MediaNest Production Environment Configuration
# Copy this file to .env and update values for your environment
# DO NOT commit .env to version control - it contains sensitive information

# =============================================================================
# üö® CRITICAL SECURITY SETTINGS
# =============================================================================

# JWT Authentication
# Generate with: openssl rand -base64 32
JWT_SECRET=your-super-secure-jwt-secret-at-least-32-characters-long
JWT_EXPIRES_IN=7d
JWT_REFRESH_EXPIRES_IN=30d

# Session Security
SESSION_SECRET=your-session-secret-at-least-32-characters-long
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=strict
SESSION_MAX_AGE=604800000

# Encryption Keys
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY=your-encryption-key-for-sensitive-data-32-chars
API_KEY_ENCRYPTION=your-api-key-encryption-secret-32-chars

# =============================================================================
# üóÑÔ∏è DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL Primary Database
DATABASE_URL=postgresql://medianest_user:secure_password@localhost:5432/medianest_prod
DB_HOST=localhost
DB_PORT=5432
DB_NAME=medianest_prod
DB_USER=medianest_user
DB_PASSWORD=secure_database_password
DB_SSL_MODE=require
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=10000
DB_IDLE_TIMEOUT=30000

# Database Connection Pool
DB_POOL_ACQUIRE_TIMEOUT=60000
DB_POOL_CREATE_TIMEOUT=30000
DB_POOL_DESTROY_TIMEOUT=5000
DB_POOL_IDLE_TIMEOUT=30000
DB_POOL_REAP_INTERVAL=1000

# =============================================================================
# üì± REDIS CONFIGURATION
# =============================================================================

# Redis for Caching and Sessions
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=secure_redis_password
REDIS_DB=0
REDIS_TLS=true
REDIS_CONNECT_TIMEOUT=10000
REDIS_COMMAND_TIMEOUT=5000
REDIS_RETRY_DELAY_ON_FAILURE=100

# Redis Connection Pool
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000
REDIS_FAMILY=4

# =============================================================================
# üåê SERVER CONFIGURATION
# =============================================================================

# Application Server
NODE_ENV=production
PORT=3000
HOST=0.0.0.0
API_VERSION=v1
BASE_URL=https://medianest.yourdomain.com

# SSL/TLS Configuration
HTTPS_ENABLED=true
SSL_CERT_PATH=/etc/ssl/certs/medianest.crt
SSL_KEY_PATH=/etc/ssl/private/medianest.key
SSL_CA_PATH=/etc/ssl/certs/ca-certificates.crt

# Server Timeouts
SERVER_TIMEOUT=30000
KEEP_ALIVE_TIMEOUT=5000
HEADERS_TIMEOUT=60000

# =============================================================================
# üîí CORS AND SECURITY HEADERS
# =============================================================================

# CORS Configuration
CORS_ORIGIN=https://medianest.yourdomain.com,https://www.medianest.yourdomain.com
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Security Headers
HSTS_MAX_AGE=31536000
CSP_REPORT_URI=/api/csp-report
CONTENT_TYPE_NOSNIFF=true
FRAME_OPTIONS=DENY
XSS_PROTECTION=1; mode=block

# =============================================================================
# üìä PLEX INTEGRATION
# =============================================================================

# Plex Media Server
PLEX_URL=http://plex.local:32400
PLEX_TOKEN=your-plex-token-here
PLEX_CLIENT_IDENTIFIER=medianest-prod
PLEX_PRODUCT=MediaNest
PLEX_VERSION=1.0.0
PLEX_DEVICE=Server

# Plex Connection Settings
PLEX_TIMEOUT=30000
PLEX_RETRY_ATTEMPTS=3
PLEX_RETRY_DELAY=1000

# =============================================================================
# üé¨ OVERSEERR INTEGRATION
# =============================================================================

# Overseerr Request Management
OVERSEERR_URL=http://overseerr.local:5055
OVERSEERR_API_KEY=your-overseerr-api-key
OVERSEERR_TIMEOUT=15000
OVERSEERR_RETRY_ATTEMPTS=3

# =============================================================================
# üìß EMAIL CONFIGURATION
# =============================================================================

# SMTP Settings for Notifications
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
SMTP_FROM=MediaNest <noreply@yourdomain.com>

# Email Templates
EMAIL_TEMPLATE_DIR=./templates/email
EMAIL_SUBJECT_PREFIX=[MediaNest]

# =============================================================================
# üìã LOGGING CONFIGURATION
# =============================================================================

# Log Levels: error, warn, info, http, verbose, debug, silly
LOG_LEVEL=info
LOG_FILE_PATH=/var/log/medianest/app.log
LOG_ERROR_FILE=/var/log/medianest/error.log
LOG_COMBINED_FILE=/var/log/medianest/combined.log

# Log Rotation
LOG_MAX_SIZE=10MB
LOG_MAX_FILES=7
LOG_DATE_PATTERN=YYYY-MM-DD

# Request Logging
LOG_REQUESTS=true
LOG_RESPONSES=false
LOG_REQUEST_BODY=false

# =============================================================================
# üö¶ RATE LIMITING
# =============================================================================

# General Rate Limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# API Rate Limiting
API_RATE_LIMIT_WINDOW=900000
API_RATE_LIMIT_MAX=1000
API_RATE_LIMIT_SKIP_SUCCESS=true

# Authentication Rate Limiting
AUTH_RATE_LIMIT_WINDOW=900000
AUTH_RATE_LIMIT_MAX=5
AUTH_RATE_LIMIT_BLOCK_DURATION=3600000

# =============================================================================
# üîç MONITORING AND HEALTH CHECKS
# =============================================================================

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000
HEALTH_CHECK_RETRIES=3

# Metrics Collection
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Performance Monitoring
APM_ENABLED=true
APM_SERVICE_NAME=medianest-prod
APM_ENVIRONMENT=production

# =============================================================================
# üóÑÔ∏è FILE STORAGE
# =============================================================================

# File Upload Configuration
UPLOAD_DIR=/var/medianest/uploads
UPLOAD_MAX_SIZE=10485760
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,image/webp
UPLOAD_TEMP_DIR=/tmp/medianest

# Static Files
STATIC_FILES_DIR=/var/medianest/static
STATIC_FILES_MAX_AGE=31536000

# =============================================================================
# üîß CACHE CONFIGURATION
# =============================================================================

# Application Cache
CACHE_TTL=3600000
CACHE_MAX_ITEMS=10000
CACHE_CHECK_PERIOD=600000

# API Response Cache
API_CACHE_TTL=300000
API_CACHE_MAX_ITEMS=5000

# Media Metadata Cache
MEDIA_CACHE_TTL=86400000
MEDIA_CACHE_MAX_ITEMS=50000

# =============================================================================
# üöÄ PERFORMANCE SETTINGS
# =============================================================================

# Node.js Performance
UV_THREADPOOL_SIZE=128
NODE_OPTIONS=--max-old-space-size=2048

# Compression
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6
COMPRESSION_THRESHOLD=1024

# Connection Limits
MAX_CONNECTIONS=1000
MAX_CONNECTIONS_PER_IP=10

# =============================================================================
# üåç EXTERNAL SERVICES
# =============================================================================

# CDN Configuration
CDN_URL=https://cdn.yourdomain.com
CDN_API_KEY=your-cdn-api-key
CDN_ZONE_ID=your-cdn-zone-id

# Analytics
ANALYTICS_ENABLED=true
ANALYTICS_TRACKING_ID=your-analytics-id

# Error Reporting
ERROR_REPORTING_ENABLED=true
ERROR_REPORTING_DSN=your-error-reporting-dsn

# =============================================================================
# üß™ FEATURE FLAGS
# =============================================================================

# Feature Toggles
FEATURE_REAL_TIME_UPDATES=true
FEATURE_ADVANCED_SEARCH=true
FEATURE_RECOMMENDATIONS=true
FEATURE_SOCIAL_FEATURES=false
FEATURE_BETA_UI=false

# =============================================================================
# üê≥ CONTAINER CONFIGURATION
# =============================================================================

# Docker Settings (if using containers)
DOCKER_NETWORK=medianest_network
DOCKER_RESTART_POLICY=unless-stopped

# Health Check URLs
HEALTH_CHECK_URL=http://localhost:3000/health
READINESS_CHECK_URL=http://localhost:3000/ready

# =============================================================================
# üìù ADDITIONAL NOTES
# =============================================================================

# 1. Generate secure secrets using: openssl rand -base64 32
# 2. Use environment-specific values for each deployment
# 3. Regularly rotate secrets and API keys
# 4. Monitor logs for security events
# 5. Test configurations in staging before production
# 6. Use a secrets management system for sensitive values
# 7. Enable monitoring and alerting for all services
# 8. Keep backups of configuration files (without secrets)
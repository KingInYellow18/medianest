FROM node:20-alpine
WORKDIR /app
RUN apk add --no-cache curl
RUN echo "const http = require(\"http\"); const server = http.createServer((req, res) => { if (req.url === \"/health\") { res.writeHead(200, { \"Content-Type\": \"application/json\" }); res.end(JSON.stringify({ status: \"healthy\", timestamp: new Date().toISOString() })); } else { res.writeHead(200, { \"Content-Type\": \"application/json\" }); res.end(JSON.stringify({ message: \"MediaNest Test\", status: \"running\" })); } }); const PORT = 4000; server.listen(PORT, () => console.log(\`Server on port \${PORT}\`)); process.on(\"SIGTERM\", () => server.close(() => process.exit(0)));" > server.js
HEALTHCHECK --interval=30s --timeout=10s --start-period=10s --retries=3 CMD curl -f http://localhost:4000/health || exit 1
EXPOSE 4000
CMD ["node", "server.js"]

# Migration Execution Scripts - Medianest Project

**Generated by MigrationExpert Agent**  
**Purpose:** Automated scripts for safe dependency migration execution

## ğŸš€ Phase 1 Execution Scripts

### React Version Standardization Script
```bash
#!/bin/bash
# react-migration.sh

set -e
echo "ğŸ”„ Starting React version standardization..."

# Backup current state
git stash push -m "Pre-React-migration backup"

# Update performance-analysis package
cd performance-analysis
echo "ğŸ“¦ Updating React in performance-analysis..."
npm install react@19.1.0 react-dom@19.1.0

# Search for deprecated patterns
echo "ğŸ” Checking for deprecated React patterns..."
if grep -r "ReactDOM.render" .; then
    echo "âš ï¸  Found ReactDOM.render usage - manual update required"
    echo "Replace with createRoot() pattern"
fi

# Run tests
echo "ğŸ§ª Running tests after React migration..."
cd ..
npm run test:performance

echo "âœ… React migration completed successfully"
```

### Node.js Types Migration Script
```bash
#!/bin/bash
# node-types-migration.sh

set -e
echo "ğŸ”„ Starting Node.js types migration..."

# Backup package.json
cp package.json package.json.backup

# Update @types/node incrementally
echo "ğŸ“¦ Updating @types/node to intermediate version..."
npm install --save-dev @types/node@22.0.0

# Test intermediate version
echo "ğŸ§ª Testing intermediate version..."
npx tsc --noEmit
if [ $? -ne 0 ]; then
    echo "âŒ Intermediate version failed - stopping migration"
    npm install --save-dev @types/node@20.19.7
    exit 1
fi

# Update to target version
echo "ğŸ“¦ Updating to target @types/node@24.1.0..."
npm install --save-dev @types/node@24.1.0

# Run comprehensive checks
echo "ğŸ§ª Running comprehensive validation..."
npx tsc --noEmit
npm run test:run

echo "âœ… Node.js types migration completed successfully"
```

## ğŸ”§ Phase 2 Execution Scripts

### Vitest Migration Script
```bash
#!/bin/bash
# vitest-migration.sh

set -e
echo "ğŸ”„ Starting Vitest ecosystem migration..."

# Backup configurations
echo "ğŸ’¾ Backing up test configurations..."
cp vitest.config.ts vitest.config.ts.backup
cp vitest.a11y.config.ts vitest.a11y.config.ts.backup
cp vitest.performance.config.ts vitest.performance.config.ts.backup
cp test-setup.ts test-setup.ts.backup

# Update Vitest packages
echo "ğŸ“¦ Updating Vitest ecosystem..."
npm install --save-dev vitest@3.2.4 @vitest/coverage-v8@3.2.4 @vitest/ui@3.2.4

# Test individual components
echo "ğŸ§ª Testing individual test suites..."
npm run test:frontend || echo "âš ï¸  Frontend tests need attention"
npm run test:backend || echo "âš ï¸  Backend tests need attention"

# Run full test suite
echo "ğŸ§ª Running complete test suite..."
npm run test:run

# Test coverage generation
echo "ğŸ“Š Testing coverage generation..."
npm run test:coverage

echo "âœ… Vitest migration completed successfully"
```

### ESLint 9 Migration Script
```bash
#!/bin/bash
# eslint-migration.sh

set -e
echo "ğŸ”„ Starting ESLint 9 migration..."

# Backup existing ESLint config
if [ -f .eslintrc.json ]; then
    cp .eslintrc.json .eslintrc.json.backup
fi

# Update ESLint packages
echo "ğŸ“¦ Updating ESLint ecosystem..."
npm install --save-dev eslint@9.32.0 @typescript-eslint/eslint-plugin@8.38.0 @typescript-eslint/parser@8.38.0

# Create flat config (this should be done manually based on project needs)
echo "âš ï¸  Manual step required: Create eslint.config.js with flat config"
echo "See MIGRATION_STRATEGIES_REPORT.md for configuration template"

# Test new configuration (after manual config creation)
echo "ğŸ§ª Testing new ESLint configuration..."
npm run lint || echo "âš ï¸  Linting issues found - review needed"

echo "âœ… ESLint migration setup completed - manual config required"
```

## ğŸ›¡ï¸ Safety & Rollback Scripts

### Health Check Script
```bash
#!/bin/bash
# health-check.sh

echo "ğŸ” Running comprehensive health checks..."

# Build validation
echo "ğŸ—ï¸  Testing build process..."
npm run build
if [ $? -ne 0 ]; then
    echo "âŒ Build failed - system unstable"
    exit 1
fi

# Test suite validation
echo "ğŸ§ª Running test suite..."
npm run test:run
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed - system unstable"
    exit 1
fi

# Type checking
echo "ğŸ“ Checking TypeScript types..."
npx tsc --noEmit
if [ $? -ne 0 ]; then
    echo "âŒ Type checking failed - system unstable"
    exit 1
fi

# Linting check
echo "ğŸ” Running linting checks..."
npm run lint
if [ $? -ne 0 ]; then
    echo "âš ï¸  Linting issues found - review recommended"
fi

# Security audit
echo "ğŸ”’ Running security audit..."
npm audit --audit-level moderate
if [ $? -gt 0 ]; then
    echo "âš ï¸  Security issues found - review required"
fi

echo "âœ… Health checks completed successfully"
```

### Emergency Rollback Script
```bash
#!/bin/bash
# emergency-rollback.sh

echo "ğŸš¨ EMERGENCY ROLLBACK: Reverting all dependency changes"

# Restore package.json files
echo "ğŸ“¦ Restoring package configurations..."
git checkout HEAD~1 -- package.json package-lock.json
git checkout HEAD~1 -- frontend/package.json frontend/package-lock.json
git checkout HEAD~1 -- performance-analysis/package.json

# Clean install from restored state
echo "ğŸ’¿ Reinstalling dependencies..."
npm ci
cd frontend && npm ci && cd ..
cd performance-analysis && npm ci && cd ..

# Restore configuration files
echo "âš™ï¸  Restoring configuration files..."
if [ -f vitest.config.ts.backup ]; then
    cp vitest.config.ts.backup vitest.config.ts
fi

if [ -f .eslintrc.json.backup ]; then
    cp .eslintrc.json.backup .eslintrc.json
fi

# Run health check
echo "ğŸ” Running post-rollback health check..."
npm run test:run

if [ $? -eq 0 ]; then
    echo "âœ… Emergency rollback completed successfully"
else
    echo "âŒ Rollback validation failed - manual intervention required"
    exit 1
fi
```

### Incremental Rollback Script
```bash
#!/bin/bash
# incremental-rollback.sh

# Accept package name as parameter
PACKAGE=$1

if [ -z "$PACKAGE" ]; then
    echo "Usage: ./incremental-rollback.sh <package-name>"
    echo "Available packages: vitest, eslint, node-types, react"
    exit 1
fi

echo "ğŸ”„ Rolling back $PACKAGE to previous version..."

case $PACKAGE in
    "vitest")
        npm install --save-dev vitest@1.6.1 @vitest/coverage-v8@1.6.1 @vitest/ui@1.6.1
        if [ -f vitest.config.ts.backup ]; then
            cp vitest.config.ts.backup vitest.config.ts
        fi
        ;;
    "eslint")
        npm install --save-dev eslint@8.57.1 @typescript-eslint/eslint-plugin@7.18.0 @typescript-eslint/parser@7.18.0
        if [ -f .eslintrc.json.backup ]; then
            cp .eslintrc.json.backup .eslintrc.json
        fi
        ;;
    "node-types")
        npm install --save-dev @types/node@20.19.7
        ;;
    "react")
        cd performance-analysis
        npm install react@18.2.0 react-dom@18.2.0
        cd ..
        ;;
    *)
        echo "âŒ Unknown package: $PACKAGE"
        exit 1
        ;;
esac

echo "âœ… Rollback of $PACKAGE completed"
```

## ğŸ“Š Migration Monitoring Scripts

### Performance Monitoring Script
```bash
#!/bin/bash
# performance-monitor.sh

echo "ğŸ“Š Monitoring migration performance impact..."

# Measure build time
echo "â±ï¸  Measuring build performance..."
time npm run build

# Measure test execution time
echo "â±ï¸  Measuring test performance..."
time npm run test:run

# Check bundle size (if applicable)
echo "ğŸ“¦ Checking bundle size..."
if [ -d "dist" ]; then
    du -h dist/
fi

# Memory usage during tests
echo "ğŸ’¾ Monitoring memory usage..."
ps aux | grep node | grep -v grep

echo "âœ… Performance monitoring completed"
```

### Migration Status Script
```bash
#!/bin/bash
# migration-status.sh

echo "ğŸ“‹ Migration Status Report"
echo "=========================="

# Check current versions
echo "ğŸ“¦ Current Package Versions:"
npm list --depth=0 | grep -E "(vitest|eslint|@types/node|react)"

# Check configuration files
echo ""
echo "âš™ï¸  Configuration Status:"
[ -f "eslint.config.js" ] && echo "âœ… ESLint flat config exists" || echo "âŒ ESLint flat config missing"
[ -f "vitest.config.ts" ] && echo "âœ… Vitest config exists" || echo "âŒ Vitest config missing"

# Check for backup files
echo ""
echo "ğŸ’¾ Backup Status:"
[ -f "package.json.backup" ] && echo "âœ… Package backup exists"
[ -f "vitest.config.ts.backup" ] && echo "âœ… Vitest config backup exists"
[ -f ".eslintrc.json.backup" ] && echo "âœ… ESLint config backup exists"

# Test status
echo ""
echo "ğŸ§ª Test Status:"
npm run test:run >/dev/null 2>&1 && echo "âœ… Tests passing" || echo "âŒ Tests failing"

echo ""
echo "Migration status check completed"
```

## ğŸ”§ Usage Instructions

### Make Scripts Executable
```bash
chmod +x react-migration.sh
chmod +x node-types-migration.sh
chmod +x vitest-migration.sh
chmod +x eslint-migration.sh
chmod +x health-check.sh
chmod +x emergency-rollback.sh
chmod +x incremental-rollback.sh
chmod +x performance-monitor.sh
chmod +x migration-status.sh
```

### Recommended Execution Order
```bash
# Phase 1
./health-check.sh  # Baseline health check
./react-migration.sh
./health-check.sh  # Validate React migration
./node-types-migration.sh
./health-check.sh  # Validate Node types

# Phase 2
./vitest-migration.sh
./health-check.sh  # Validate Vitest
./eslint-migration.sh
# Manual: Create eslint.config.js
./health-check.sh  # Validate ESLint

# Monitor throughout
./performance-monitor.sh
./migration-status.sh
```

---

*These scripts provide automated execution of the migration strategy with built-in safety checks and rollback capabilities.*
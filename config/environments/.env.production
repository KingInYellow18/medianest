# MediaNest Production Environment Configuration
# This file contains PUBLIC configuration only
# SECRETS MUST BE PROVIDED via environment variables or secure secret management

# =============================================================================
# ENVIRONMENT CONFIGURATION
# =============================================================================

NODE_ENV=production
APP_NAME=medianest
APP_VERSION=1.0.0

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

MEDIANEST_BACKEND_PORT=4000
MEDIANEST_BACKEND_HOST=0.0.0.0
BACKEND_API_PREFIX=/api/v1

MEDIANEST_FRONTEND_PORT=3000
MEDIANEST_FRONTEND_HOST=0.0.0.0

# CORS_ORIGIN should be set via environment variables
# CORS_ORIGIN=${PRODUCTION_FRONTEND_URL}
CORS_CREDENTIALS=true

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# Database URL MUST be provided via environment variable
# DATABASE_URL=${PRODUCTION_DATABASE_URL}
DB_SSL=true
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=60000
DB_IDLE_TIMEOUT=30000

DB_MIGRATE_ON_START=false
DB_SEED_ON_START=false

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================

# Redis URL MUST be provided via environment variable
# REDIS_URL=${PRODUCTION_REDIS_URL}
REDIS_PREFIX=medianest:prod:
REDIS_TTL=7200
REDIS_MAX_RETRIES=5

# =============================================================================
# AUTHENTICATION & SECURITY
# =============================================================================

# ALL SECRETS MUST be provided via environment variables
# JWT_SECRET=${PRODUCTION_JWT_SECRET}
JWT_EXPIRE_IN=15m
JWT_REFRESH_EXPIRE_IN=30d
JWT_ISSUER=medianest-production

# SESSION_SECRET=${PRODUCTION_SESSION_SECRET}
SESSION_MAX_AGE=86400000
SESSION_SECURE=true
SESSION_HTTP_ONLY=true
SESSION_SAME_SITE=strict

# Security enabled in production
SECURITY_HELMET_ENABLED=true
SECURITY_RATE_LIMIT_ENABLED=true
SECURITY_RATE_LIMIT_WINDOW=15
SECURITY_RATE_LIMIT_MAX_REQUESTS=100

# Strong hashing in production
BCRYPT_ROUNDS=12

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# Provider configurations (secrets via env vars)
EMAIL_PROVIDER=sendgrid
# EMAIL_API_KEY=${PRODUCTION_EMAIL_API_KEY}
EMAIL_FROM=noreply@medianest.com
EMAIL_FROM_NAME=MediaNest

STORAGE_PROVIDER=s3
# AWS_ACCESS_KEY_ID=${PRODUCTION_AWS_ACCESS_KEY_ID}
# AWS_SECRET_ACCESS_KEY=${PRODUCTION_AWS_SECRET_ACCESS_KEY}
AWS_REGION=us-east-1
AWS_S3_BUCKET=medianest-prod-uploads

EXTERNAL_API_TIMEOUT=30000
EXTERNAL_API_RETRY_ATTEMPTS=3

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=/var/log/medianest/app.log
LOG_FILE_MAX_SIZE=50m
LOG_FILE_MAX_FILES=10

# =============================================================================
# DEVELOPMENT TOOLS
# =============================================================================

# Disabled in production
DEBUG_ENABLED=false
DEBUG_NAMESPACE=
PROFILING_ENABLED=false

WATCH_MODE=false
AUTO_RESTART=false

# =============================================================================
# TESTING CONFIGURATION
# =============================================================================

# Not applicable in production
TEST_TIMEOUT=0
TEST_SETUP_TIMEOUT=0
TEST_TEARDOWN_TIMEOUT=0

# =============================================================================
# MONITORING & METRICS
# =============================================================================

HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_TIMEOUT=5000

METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

APM_ENABLED=true
APM_SERVICE_NAME=medianest
APM_ENVIRONMENT=production

# =============================================================================
# DOCKER & CONTAINERIZATION
# =============================================================================

DOCKER_NETWORK=medianest-prod-network
DOCKER_COMPOSE_PROJECT_NAME=medianest-prod

CONTAINER_HEALTH_CHECK_INTERVAL=30s
CONTAINER_HEALTH_CHECK_TIMEOUT=10s
CONTAINER_HEALTH_CHECK_RETRIES=3

# =============================================================================
# PRODUCTION-SPECIFIC CONFIGURATION
# =============================================================================

# Process management
PM2_ENABLED=true
PM2_INSTANCES=max
PM2_MAX_MEMORY_RESTART=500M

# SSL/TLS configuration
SSL_ENABLED=true
SSL_REDIRECT=true

# Caching
CACHE_ENABLED=true
CACHE_TTL=3600

# Content compression
COMPRESSION_ENABLED=true
COMPRESSION_LEVEL=6

# Static file serving
STATIC_CACHE_MAX_AGE=31536000
STATIC_ETAG_ENABLED=true

# Request limits
REQUEST_SIZE_LIMIT=10mb
REQUEST_PARAMETER_LIMIT=1000

# Graceful shutdown
GRACEFUL_SHUTDOWN_TIMEOUT=30000

# =============================================================================
# SECRET MANAGEMENT PLACEHOLDERS
# =============================================================================
# The following variables MUST be provided via:
# - Environment variables
# - Docker secrets
# - Kubernetes secrets
# - AWS Secrets Manager
# - Azure Key Vault
# - HashiCorp Vault
# - Or similar secure secret management system
#
# NEVER commit actual production secrets to version control!
# =============================================================================

# Required production secrets (provide via secure methods):
# DATABASE_URL
# REDIS_URL
# JWT_SECRET
# SESSION_SECRET
# EMAIL_API_KEY
# AWS_ACCESS_KEY_ID
# AWS_SECRET_ACCESS_KEY
# Any other API keys or sensitive configuration

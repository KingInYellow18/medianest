<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Complete documentation for MediaNest - Advanced Media Management Platform with Plex Integration, API, and Developer Resources"><meta name="author" content="MediaNest Development Team"><link rel="canonical" href="https://kinginyellow.github.io/medianest/environment-variables/"><link rel="icon" href="../assets/images/favicon.ico"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.19"><title>MediaNest Environment Variables Reference - MediaNest Documentation</title><link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css"><link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../css/timeago.css"><link rel="stylesheet" href="../stylesheets/extra.css"><link rel="stylesheet" href="../stylesheets/medianest-theme.css"><link rel="stylesheet" href="../stylesheets/material-enhancements.css"><link rel="stylesheet" href="../stylesheets/animations.css"><link rel="stylesheet" href="../stylesheets/responsive.css"><link rel="stylesheet" href="../stylesheets/diagram-styles.css"><link rel="stylesheet" href="../stylesheets/api-docs.css"><link rel="stylesheet" href="../stylesheets/code-highlights.css"><link rel="stylesheet" href="../stylesheets/mermaid-custom.css"><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-XXXXXXXXXX"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-XXXXXXXXXX",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script><script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script></head><body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple"><input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"><input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"><label class="md-overlay" for="__drawer"></label><div data-md-component="skip"><a href="#medianest-environment-variables-reference" class="md-skip"> Skip to content </a></div><div data-md-component="announce"></div><div data-md-color-scheme="default" data-md-component="outdated" hidden></div><header class="md-header md-header--shadow md-header--lifted" data-md-component="header"><nav class="md-header__inner md-grid" aria-label="Header"><a href="https://kinginyellow.github.io/medianest/" title="MediaNest Documentation" class="md-header__button md-logo" aria-label="MediaNest Documentation" data-md-component="logo"><img src="../assets/images/logo.svg" alt="logo"></a><label class="md-header__button md-icon" for="__drawer"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg></label><div class="md-header__title" data-md-component="header-title"><div class="md-header__ellipsis"><div class="md-header__topic"><span class="md-ellipsis"> MediaNest Documentation </span></div><div class="md-header__topic" data-md-component="header-topic"><span class="md-ellipsis"> MediaNest Environment Variables Reference </span></div></div></div><form class="md-header__option" data-md-component="palette"><input class="md-option" data-md-color-media data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="purple" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0"><label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label><input class="md-option" data-md-color-media data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="purple" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1"><label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg></label></form><script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script><label class="md-header__button md-icon" for="__search"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required><label class="md-search__icon md-icon" for="__search"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg></label><nav class="md-search__options" aria-label="Search"><a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text data-md-component="search-share" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg></a><button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg></button></nav><div class="md-search__suggest" data-md-component="search-suggest"></div></form><div class="md-search__output"><div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix><div class="md-search-result" data-md-component="search-result"><div class="md-search-result__meta"> Initializing search </div><ol class="md-search-result__list" role="presentation"></ol></div></div></div></div></div><div class="md-header__source"><a href="https://github.com/kinginyellow/medianest" title="Go to repository" class="md-source" data-md-component="source"><div class="md-source__icon md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg></div><div class="md-source__repository"> kinginyellow/medianest </div></a></div></nav><nav class="md-tabs" aria-label="Tabs" data-md-component="tabs"><div class="md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href=".." class="md-tabs__link"> Home </a></li><li class="md-tabs__item"><a href="../getting-started/" class="md-tabs__link"> Getting Started </a></li><li class="md-tabs__item"><a href="../architecture/component-architecture/" class="md-tabs__link"> Architecture </a></li><li class="md-tabs__item"><a href="../api/overview/" class="md-tabs__link"> API Reference </a></li><li class="md-tabs__item"><a href="../operations/monitoring-stack/" class="md-tabs__link"> Operations </a></li><li class="md-tabs__item"><a href="../deployment/ci-cd/" class="md-tabs__link"> Deployment </a></li><li class="md-tabs__item"><a href="../developers/contributing/" class="md-tabs__link"> Developers </a></li><li class="md-tabs__item"><a href="../visuals/database-schema/" class="md-tabs__link"> Visuals </a></li><li class="md-tabs__item"><a href="../standards/documentation-checklist/" class="md-tabs__link"> Standards </a></li></ul></div></nav></header><div class="md-container" data-md-component="container"><main class="md-main" data-md-component="main"><div class="md-main__inner md-grid"><div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0"><label class="md-nav__title" for="__drawer"><a href="https://kinginyellow.github.io/medianest/" title="MediaNest Documentation" class="md-nav__button md-logo" aria-label="MediaNest Documentation" data-md-component="logo"><img src="../assets/images/logo.svg" alt="logo"></a> MediaNest Documentation </label><div class="md-nav__source"><a href="https://github.com/kinginyellow/medianest" title="Go to repository" class="md-source" data-md-component="source"><div class="md-source__icon md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg></div><div class="md-source__repository"> kinginyellow/medianest </div></a></div><ul class="md-nav__list" data-md-scrollfix><li class="md-nav__item"><a href=".." class="md-nav__link"><span class="md-ellipsis"> Home </span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../getting-started/" class="md-nav__link"><span class="md-ellipsis"> Getting Started </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../architecture/component-architecture/" class="md-nav__link"><span class="md-ellipsis"> Architecture </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../api/overview/" class="md-nav__link"><span class="md-ellipsis"> API Reference </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../operations/monitoring-stack/" class="md-nav__link"><span class="md-ellipsis"> Operations </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../deployment/ci-cd/" class="md-nav__link"><span class="md-ellipsis"> Deployment </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../developers/contributing/" class="md-nav__link"><span class="md-ellipsis"> Developers </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../visuals/database-schema/" class="md-nav__link"><span class="md-ellipsis"> Visuals </span><span class="md-nav__icon md-icon"></span></a></li><li class="md-nav__item md-nav__item--pruned md-nav__item--nested"><a href="../standards/documentation-checklist/" class="md-nav__link"><span class="md-ellipsis"> Standards </span><span class="md-nav__icon md-icon"></span></a></li></ul></nav></div></div></div><div class="md-content" data-md-component="content"><article class="md-content__inner md-typeset"><a href="https://github.com/kinginyellow/medianest/edit/develop/docs/environment-variables.md" title="Edit this page" class="md-content__button md-icon" rel="edit"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg></a><a href="https://github.com/kinginyellow/medianest/raw/develop/docs/environment-variables.md" title="View source of this page" class="md-content__button md-icon"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg></a><h1 id="medianest-environment-variables-reference">MediaNest Environment Variables Reference<a class="headerlink" href="#medianest-environment-variables-reference" title="Permanent link">&para;</a></h1><h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2><ol><li><a href="#complete-environment-variables-reference">Complete Environment Variables Reference</a></li><li><a href="#environment-setup-guide">Environment Setup Guide</a></li><li><a href="#security-best-practices">Security Best Practices</a></li><li><a href="#troubleshooting-guide">Troubleshooting Guide</a></li></ol><hr><h2 id="complete-environment-variables-reference">Complete Environment Variables Reference<a class="headerlink" href="#complete-environment-variables-reference" title="Permanent link">&para;</a></h2><p>MediaNest uses 150+ environment variables organized by category for maximum flexibility and security.</p><h3 id="general-configuration">🌍 General Configuration<a class="headerlink" href="#general-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>NODE_ENV</code></td><td>Application environment</td><td><code>development\|production\|test</code></td><td><code>development</code></td><td>✅</td><td>All services</td></tr><tr><td><code>VERSION</code></td><td>Application version</td><td>String</td><td><code>latest</code></td><td>❌</td><td>Docker, CI/CD</td></tr><tr><td><code>BUILD_DATE</code></td><td>Build timestamp</td><td>ISO Date</td><td>-</td><td>❌</td><td>Docker</td></tr><tr><td><code>VCS_REF</code></td><td>Git commit hash</td><td>String</td><td>-</td><td>❌</td><td>Docker</td></tr><tr><td><code>APP_NAME</code></td><td>Application name</td><td>String</td><td><code>MediaNest</code></td><td>❌</td><td>Config files</td></tr><tr><td><code>APP_VERSION</code></td><td>Version identifier</td><td>String</td><td><code>1.0.0</code></td><td>❌</td><td>API responses</td></tr></tbody></table><h3 id="domain-urls">🌐 Domain &amp; URLs<a class="headerlink" href="#domain-urls" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>DOMAIN_NAME</code></td><td>Production domain</td><td>FQDN</td><td><code>medianest.local</code></td><td>Prod</td><td>Nginx, SSL</td></tr><tr><td><code>FRONTEND_URL</code></td><td>Frontend base URL</td><td>URL</td><td><code>http://localhost:3000</code></td><td>✅</td><td>Backend, Auth</td></tr><tr><td><code>BACKEND_URL</code></td><td>Backend API URL</td><td>URL</td><td><code>http://localhost:3001</code></td><td>✅</td><td>Frontend</td></tr><tr><td><code>NEXTAUTH_URL</code></td><td>NextAuth callback URL</td><td>URL</td><td><code>http://localhost:3000</code></td><td>✅</td><td>NextAuth.js</td></tr><tr><td><code>NEXT_PUBLIC_API_URL</code></td><td>Public API endpoint</td><td>URL</td><td><code>http://localhost:4000/api</code></td><td>✅</td><td>Frontend</td></tr><tr><td><code>NEXT_PUBLIC_WS_URL</code></td><td>WebSocket URL</td><td>WebSocket URL</td><td><code>ws://localhost:4000</code></td><td>❌</td><td>Frontend</td></tr><tr><td><code>CORS_ORIGIN</code></td><td>CORS allowed origins</td><td>URL/Array</td><td><code>http://localhost:3000</code></td><td>✅</td><td>Backend</td></tr></tbody></table><h3 id="database-configuration">🗄️ Database Configuration<a class="headerlink" href="#database-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>DATABASE_URL</code></td><td>PostgreSQL connection string</td><td>postgres:// URL</td><td>-</td><td>✅</td><td>Backend, Tests</td></tr><tr><td><code>DATABASE_URL_FILE</code></td><td>Docker secrets file path</td><td>File path</td><td><code>/run/secrets/database_url</code></td><td>Prod</td><td>Backend</td></tr><tr><td><code>POSTGRES_DB</code></td><td>Database name</td><td>String</td><td><code>medianest_dev</code></td><td>✅</td><td>Docker</td></tr><tr><td><code>POSTGRES_USER</code></td><td>Database user</td><td>String</td><td><code>medianest</code></td><td>✅</td><td>Docker</td></tr><tr><td><code>POSTGRES_PASSWORD</code></td><td>Database password</td><td>String</td><td>-</td><td>✅</td><td>Docker</td></tr><tr><td><code>POSTGRES_PASSWORD_FILE</code></td><td>Password secrets file</td><td>File path</td><td><code>/run/secrets/postgres_password</code></td><td>Prod</td><td>Docker</td></tr><tr><td><code>DB_HOST</code></td><td>Database host</td><td>Hostname/IP</td><td><code>localhost</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_PORT</code></td><td>Database port</td><td>Number</td><td><code>5432</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_NAME</code></td><td>Database name</td><td>String</td><td><code>medianest</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_USER</code></td><td>Database username</td><td>String</td><td><code>postgres</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_PASSWORD</code></td><td>Database password</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_SSL</code></td><td>Enable SSL connection</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_POOL_MIN</code></td><td>Minimum pool connections</td><td>Number</td><td><code>2</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_POOL_MAX</code></td><td>Maximum pool connections</td><td>Number</td><td><code>10</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DB_TIMEOUT</code></td><td>Connection timeout (ms)</td><td>Number</td><td><code>30000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DATABASE_POOL_SIZE</code></td><td>Connection pool size</td><td>Number</td><td><code>10</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DATABASE_POOL_TIMEOUT</code></td><td>Pool timeout (ms)</td><td>Number</td><td><code>30000</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>DATABASE_CONNECTION_LIMIT</code></td><td>Max connections</td><td>Number</td><td><code>20</code></td><td>❌</td><td>Tests</td></tr></tbody></table><h3 id="redis-configuration">📊 Redis Configuration<a class="headerlink" href="#redis-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>REDIS_URL</code></td><td>Redis connection string</td><td>redis:// URL</td><td><code>redis://localhost:6379</code></td><td>✅</td><td>Backend, Tests</td></tr><tr><td><code>REDIS_URL_FILE</code></td><td>Docker secrets file path</td><td>File path</td><td><code>/run/secrets/redis_url</code></td><td>Prod</td><td>Backend</td></tr><tr><td><code>REDIS_HOST</code></td><td>Redis hostname</td><td>Hostname/IP</td><td><code>localhost</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_PORT</code></td><td>Redis port</td><td>Number</td><td><code>6379</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_PASSWORD</code></td><td>Redis password</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_PASSWORD_FILE</code></td><td>Password secrets file</td><td>File path</td><td><code>/run/secrets/redis_password</code></td><td>Prod</td><td>Docker</td></tr><tr><td><code>REDIS_DB</code></td><td>Redis database number</td><td>Number</td><td><code>0</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_MAX_RETRIES</code></td><td>Max retry attempts</td><td>Number</td><td><code>3</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_RETRY_DELAY_MS</code></td><td>Retry delay (ms)</td><td>Number</td><td><code>2000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_KEY_PREFIX</code></td><td>Key prefix</td><td>String</td><td><code>medianest:</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>REDIS_MAX_MEMORY_POLICY</code></td><td>Memory eviction policy</td><td>String</td><td><code>allkeys-lru</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>REDIS_MAX_CLIENTS</code></td><td>Maximum clients</td><td>Number</td><td><code>1000</code></td><td>❌</td><td>Tests</td></tr></tbody></table><h3 id="authentication-security">🔐 Authentication &amp; Security<a class="headerlink" href="#authentication-security" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>NEXTAUTH_SECRET</code></td><td>NextAuth.js secret</td><td>String (32+ chars)</td><td>-</td><td>✅</td><td>NextAuth.js</td></tr><tr><td><code>NEXTAUTH_SECRET_FILE</code></td><td>NextAuth secrets file</td><td>File path</td><td><code>/run/secrets/nextauth_secret</code></td><td>Prod</td><td>NextAuth.js</td></tr><tr><td><code>JWT_SECRET</code></td><td>JWT signing secret</td><td>String (32+ chars)</td><td>-</td><td>✅</td><td>Backend</td></tr><tr><td><code>JWT_SECRET_FILE</code></td><td>JWT secrets file</td><td>File path</td><td><code>/run/secrets/jwt_secret</code></td><td>Prod</td><td>Backend</td></tr><tr><td><code>JWT_ISSUER</code></td><td>JWT issuer</td><td>String</td><td><code>medianest</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>JWT_AUDIENCE</code></td><td>JWT audience</td><td>String</td><td><code>medianest-users</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>JWT_EXPIRES_IN</code></td><td>JWT expiration</td><td>Time string</td><td><code>7d</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ENCRYPTION_KEY</code></td><td>AES-256-GCM key</td><td>String (32 bytes)</td><td>-</td><td>✅</td><td>Backend</td></tr><tr><td><code>ENCRYPTION_KEY_FILE</code></td><td>Encryption key secrets file</td><td>File path</td><td><code>/run/secrets/encryption_key</code></td><td>Prod</td><td>Backend</td></tr><tr><td><code>BCRYPT_ROUNDS</code></td><td>BCrypt hash rounds</td><td>Number</td><td><code>12</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>PASSWORD_MIN_LENGTH</code></td><td>Minimum password length</td><td>Number</td><td><code>8</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>MAX_LOGIN_ATTEMPTS</code></td><td>Max failed logins</td><td>Number</td><td><code>5</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>LOCKOUT_TIME</code></td><td>Account lockout time (ms)</td><td>Number</td><td><code>1800000</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="oauth-integrations">🔌 OAuth Integrations<a class="headerlink" href="#oauth-integrations" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>PLEX_CLIENT_ID</code></td><td>Plex OAuth client ID</td><td>String</td><td>-</td><td>✅</td><td>Backend</td></tr><tr><td><code>PLEX_CLIENT_ID_FILE</code></td><td>Plex client ID secrets file</td><td>File path</td><td><code>/run/secrets/plex_client_id</code></td><td>Prod</td><td>Backend</td></tr><tr><td><code>PLEX_CLIENT_SECRET</code></td><td>Plex OAuth client secret</td><td>String</td><td>-</td><td>✅</td><td>Backend</td></tr><tr><td><code>PLEX_CLIENT_SECRET_FILE</code></td><td>Plex client secret file</td><td>File path</td><td><code>/run/secrets/plex_client_secret</code></td><td>Prod</td><td>Backend</td></tr><tr><td><code>PLEX_SERVER_URL</code></td><td>Plex server URL</td><td>URL</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>PLEX_TOKEN</code></td><td>Plex authentication token</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>PLEX_PRODUCT</code></td><td>Plex product identifier</td><td>String</td><td><code>MediaNest</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>PLEX_VERSION</code></td><td>Plex client version</td><td>String</td><td><code>1.0.0</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>PLEX_PLATFORM</code></td><td>Plex platform</td><td>String</td><td><code>Web</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>PLEX_DEVICE</code></td><td>Plex device name</td><td>String</td><td><code>MediaNest Server</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="email-configuration">📧 Email Configuration<a class="headerlink" href="#email-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>SMTP_HOST</code></td><td>SMTP server hostname</td><td>Hostname</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>SMTP_PORT</code></td><td>SMTP server port</td><td>Number</td><td><code>587</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SMTP_SECURE</code></td><td>Use TLS/SSL</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SMTP_USER</code></td><td>SMTP username</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>SMTP_PASS</code></td><td>SMTP password</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>EMAIL_FROM</code></td><td>Default sender email</td><td>Email</td><td><code>noreply@medianest.com</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>EMAIL_FROM_NAME</code></td><td>Default sender name</td><td>String</td><td><code>MediaNest</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>EMAIL_SMTP_HOST</code></td><td>Email SMTP host</td><td>Hostname</td><td>-</td><td>❌</td><td>Config</td></tr><tr><td><code>EMAIL_SMTP_PORT</code></td><td>Email SMTP port</td><td>Number</td><td>-</td><td>❌</td><td>Config</td></tr><tr><td><code>EMAIL_USERNAME</code></td><td>Email username</td><td>String</td><td>-</td><td>❌</td><td>Config</td></tr><tr><td><code>EMAIL_PASSWORD</code></td><td>Email password</td><td>String</td><td>-</td><td>❌</td><td>Config</td></tr></tbody></table><h3 id="storage-file-paths">📂 Storage &amp; File Paths<a class="headerlink" href="#storage-file-paths" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>DATA_PATH</code></td><td>Data storage path</td><td>Directory path</td><td><code>./data</code></td><td>❌</td><td>Docker</td></tr><tr><td><code>LOG_PATH</code></td><td>Log files path</td><td>Directory path</td><td><code>./logs</code></td><td>❌</td><td>Docker</td></tr><tr><td><code>BACKUP_PATH</code></td><td>Backup files path</td><td>Directory path</td><td><code>./backups</code></td><td>❌</td><td>Docker</td></tr></tbody></table><h3 id="ssltls-configuration">🔒 SSL/TLS Configuration<a class="headerlink" href="#ssltls-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>CERTBOT_EMAIL</code></td><td>Let's Encrypt email</td><td>Email</td><td>-</td><td>Prod</td><td>Certbot</td></tr></tbody></table><h3 id="application-settings">🚀 Application Settings<a class="headerlink" href="#application-settings" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>PORT</code></td><td>Server port</td><td>Number</td><td><code>4000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>HOST</code></td><td>Server host</td><td>IP/Hostname</td><td><code>localhost</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>TRUST_PROXY</code></td><td>Trust proxy headers</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>LOG_LEVEL</code></td><td>Logging level</td><td><code>error\|warn\|info\|debug\|verbose</code></td><td><code>info</code></td><td>❌</td><td>All</td></tr><tr><td><code>LOG_FORMAT</code></td><td>Log output format</td><td><code>json\|simple</code></td><td><code>json</code></td><td>❌</td><td>All</td></tr><tr><td><code>LOG_MAX_FILES</code></td><td>Max log files</td><td>Number</td><td><code>7</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>LOG_MAX_SIZE</code></td><td>Max log file size</td><td>String</td><td><code>20m</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DEBUG</code></td><td>Debug namespace</td><td>String</td><td><code>medianest:*</code></td><td>❌</td><td>All</td></tr><tr><td><code>RUN_MIGRATIONS</code></td><td>Run DB migrations</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="monitoring-metrics">📊 Monitoring &amp; Metrics<a class="headerlink" href="#monitoring-metrics" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>GRAFANA_USER</code></td><td>Grafana admin user</td><td>String</td><td><code>admin</code></td><td>❌</td><td>Grafana</td></tr><tr><td><code>GRAFANA_PASSWORD_FILE</code></td><td>Grafana password file</td><td>File path</td><td><code>/run/secrets/grafana_password</code></td><td>❌</td><td>Grafana</td></tr><tr><td><code>HEALTH_CHECK_TIMEOUT</code></td><td>Health check timeout (ms)</td><td>Number</td><td><code>10000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>HEALTH_CHECK_INTERVAL</code></td><td>Health check interval (ms)</td><td>Number</td><td><code>30000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ERROR_REPORTING_ENABLED</code></td><td>Enable error reporting</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ERROR_REPORTING_ENDPOINT</code></td><td>Error reporting URL</td><td>URL</td><td>-</td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="performance-rate-limiting">⚡ Performance &amp; Rate Limiting<a class="headerlink" href="#performance-rate-limiting" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>REQUEST_TIMEOUT</code></td><td>Request timeout (ms)</td><td>Number</td><td><code>30000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>BODY_LIMIT</code></td><td>Request body limit</td><td>String</td><td><code>10mb</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>JSON_LIMIT</code></td><td>JSON payload limit</td><td>String</td><td><code>1mb</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_API_REQUESTS</code></td><td>API rate limit</td><td>Number</td><td><code>100</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_API_WINDOW</code></td><td>API rate window (sec)</td><td>Number</td><td><code>60</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_YOUTUBE_REQUESTS</code></td><td>YouTube API limit</td><td>Number</td><td><code>5</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_YOUTUBE_WINDOW</code></td><td>YouTube rate window (sec)</td><td>Number</td><td><code>3600</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_WINDOW_MS</code></td><td>General rate limit window (ms)</td><td>Number</td><td><code>900000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_MAX_REQUESTS</code></td><td>Max requests per window</td><td>Number</td><td><code>100</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>RATE_LIMIT_SKIP_SUCCESSFUL</code></td><td>Skip successful requests</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="websocket-configuration">🌐 WebSocket Configuration<a class="headerlink" href="#websocket-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>WS_PORT</code></td><td>WebSocket port</td><td>Number</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>WS_CORS_ORIGIN</code></td><td>WebSocket CORS origins</td><td>URL/Array</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>WS_HEARTBEAT_INTERVAL</code></td><td>Heartbeat interval (ms)</td><td>Number</td><td><code>30000</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="feature-flags">🔧 Feature Flags<a class="headerlink" href="#feature-flags" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>ENABLE_REGISTRATION</code></td><td>Allow user registration</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ENABLE_EMAIL_VERIFICATION</code></td><td>Require email verification</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ENABLE_TWO_FACTOR_AUTH</code></td><td>Enable 2FA</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ENABLE_PASSWORD_RESET</code></td><td>Allow password reset</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>ENABLE_REQUEST_LOGGING</code></td><td>Log HTTP requests</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>LOG_REQUESTS</code></td><td>Detailed request logging</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>LOG_ERRORS</code></td><td>Log errors</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="external-services">🔌 External Services<a class="headerlink" href="#external-services" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>YOUTUBE_API_KEY</code></td><td>YouTube Data API key</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>TMDB_API_KEY</code></td><td>The Movie DB API key</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>OVERSEERR_URL</code></td><td>Overseerr server URL</td><td>URL</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>OVERSEERR_API_KEY</code></td><td>Overseerr API key</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>UPTIME_KUMA_URL</code></td><td>Uptime Kuma URL</td><td>URL</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>UPTIME_KUMA_TOKEN</code></td><td>Uptime Kuma token</td><td>String</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>WEBHOOK_URL</code></td><td>Notification webhook URL</td><td>URL</td><td>-</td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="testing-configuration">🧪 Testing Configuration<a class="headerlink" href="#testing-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>CI</code></td><td>Continuous Integration flag</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>TEST_DATABASE_URL</code></td><td>Test database URL</td><td>postgres:// URL</td><td>-</td><td>✅</td><td>Tests</td></tr><tr><td><code>TEST_REDIS_URL</code></td><td>Test Redis URL</td><td>redis:// URL</td><td>-</td><td>✅</td><td>Tests</td></tr><tr><td><code>TEST_BASE_URL</code></td><td>Base URL for tests</td><td>URL</td><td><code>http://localhost:3001</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>MAX_CONCURRENT_USERS</code></td><td>Load test max users</td><td>Number</td><td><code>1000</code></td><td>❌</td><td>Load Tests</td></tr><tr><td><code>TEST_DURATION</code></td><td>Test duration (sec)</td><td>Number</td><td><code>300</code></td><td>❌</td><td>Load Tests</td></tr><tr><td><code>STRESS_TEST_MAX_CONNECTIONS</code></td><td>Max DB test connections</td><td>Number</td><td><code>500</code></td><td>❌</td><td>Stress Tests</td></tr><tr><td><code>STRESS_TEST_MAX_REDIS_CLIENTS</code></td><td>Max Redis test clients</td><td>Number</td><td><code>200</code></td><td>❌</td><td>Stress Tests</td></tr><tr><td><code>MAX_DB_CONNECTIONS</code></td><td>Max DB connections</td><td>Number</td><td><code>100</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>CONCURRENT_QUERIES</code></td><td>Concurrent query limit</td><td>Number</td><td><code>500</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>SAMPLING_INTERVAL</code></td><td>Metrics sampling interval (sec)</td><td>Number</td><td><code>5</code></td><td>❌</td><td>Tests</td></tr><tr><td><code>UPDATE_SECURITY_BASELINE</code></td><td>Update security baseline</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Security Tests</td></tr></tbody></table><h3 id="development-configuration">🔧 Development Configuration<a class="headerlink" href="#development-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>CHOKIDAR_USEPOLLING</code></td><td>Enable file polling</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Dev</td></tr><tr><td><code>WATCHPACK_POLLING</code></td><td>Webpack polling</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Dev</td></tr><tr><td><code>FAST_REFRESH</code></td><td>Enable Fast Refresh</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Dev</td></tr><tr><td><code>NEXT_TELEMETRY_DISABLED</code></td><td>Disable Next.js telemetry</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Dev</td></tr><tr><td><code>NPM_CONFIG_LOGLEVEL</code></td><td>NPM log level</td><td>String</td><td><code>warn</code></td><td>❌</td><td>Dev</td></tr><tr><td><code>NPM_CONFIG_PROGRESS</code></td><td>NPM progress display</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Dev</td></tr><tr><td><code>NODE_OPTIONS</code></td><td>Node.js runtime options</td><td>String</td><td><code>--max-old-space-size=2048</code></td><td>❌</td><td>Dev/Tests</td></tr></tbody></table><h3 id="docker-secrets">🔐 Docker Secrets<a class="headerlink" href="#docker-secrets" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>USE_DOCKER_SECRETS</code></td><td>Enable Docker secrets</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>DOCKER_SECRETS_PATH</code></td><td>Secrets directory path</td><td>Directory path</td><td><code>/run/secrets</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="session-management">🎯 Session Management<a class="headerlink" href="#session-management" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>SESSION_SECRET</code></td><td>Session signing secret</td><td>String (32+ chars)</td><td>-</td><td>✅</td><td>Backend</td></tr><tr><td><code>SESSION_COOKIE_MAX_AGE</code></td><td>Session cookie max age (ms)</td><td>Number</td><td><code>86400000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SESSION_ROLLING</code></td><td>Rolling sessions</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SESSION_SAVE_UNINITIALIZED</code></td><td>Save uninitialized sessions</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SESSION_RESAVE</code></td><td>Force session save</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SESSION_MAX_AGE</code></td><td>Session max age (ms)</td><td>Number</td><td><code>86400000</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SESSION_SECURE</code></td><td>Secure session cookies</td><td>Boolean</td><td><code>false</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>SESSION_SAME_SITE</code></td><td>SameSite cookie attribute</td><td><code>strict\|lax\|none</code></td><td><code>lax</code></td><td>❌</td><td>Backend</td></tr></tbody></table><h3 id="cookie-configuration">🍪 Cookie Configuration<a class="headerlink" href="#cookie-configuration" title="Permanent link">&para;</a></h3><table><thead><tr><th>Variable</th><th>Description</th><th>Format</th><th>Default</th><th>Required</th><th>Used In</th></tr></thead><tbody><tr><td><code>AUTH_COOKIE_NAME</code></td><td>Authentication cookie name</td><td>String</td><td><code>auth-token</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>AUTH_COOKIE_DOMAIN</code></td><td>Cookie domain</td><td>Domain</td><td>-</td><td>❌</td><td>Backend</td></tr><tr><td><code>AUTH_COOKIE_SECURE</code></td><td>Secure cookies (auto in prod)</td><td>Boolean</td><td>Auto</td><td>❌</td><td>Backend</td></tr><tr><td><code>AUTH_COOKIE_HTTP_ONLY</code></td><td>HTTP-only cookies</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>AUTH_COOKIE_SAME_SITE</code></td><td>SameSite attribute</td><td>String</td><td><code>strict</code></td><td>❌</td><td>Backend</td></tr><tr><td><code>CORS_CREDENTIALS</code></td><td>Allow credentials</td><td>Boolean</td><td><code>true</code></td><td>❌</td><td>Backend</td></tr></tbody></table><hr><h2 id="environment-setup-guide">Environment Setup Guide<a class="headerlink" href="#environment-setup-guide" title="Permanent link">&para;</a></h2><h3 id="step-by-step-development-setup">Step-by-Step Development Setup<a class="headerlink" href="#step-by-step-development-setup" title="Permanent link">&para;</a></h3><h4 id="1-clone-and-setup-project">1. Clone and Setup Project<a class="headerlink" href="#1-clone-and-setup-project" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1">1</a></span>
<span class="normal"><a href="#__codelineno-0-2">2</a></span>
<span class="normal"><a href="#__codelineno-0-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1"></a>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/yourusername/medianest.git
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="nb">cd</span><span class="w"> </span>medianest
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3"></a>npm<span class="w"> </span>install
</span></code></pre></div></td></tr></table></div><h4 id="2-create-environment-file">2. Create Environment File<a class="headerlink" href="#2-create-environment-file" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span>
<span class="normal"><a href="#__codelineno-1-2">2</a></span>
<span class="normal"><a href="#__codelineno-1-3">3</a></span>
<span class="normal"><a href="#__codelineno-1-4">4</a></span>
<span class="normal"><a href="#__codelineno-1-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1"># Copy the template</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2"></a>cp<span class="w"> </span>config/docker/docker-environment.env.template<span class="w"> </span>docker-environment.env
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="c1"># Or create manually</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5"></a>touch<span class="w"> </span>docker-environment.env
</span></code></pre></div></td></tr></table></div><h4 id="3-configure-development-environment">3. Configure Development Environment<a class="headerlink" href="#3-configure-development-environment" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-2-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-2-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-2-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-2-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-2-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-2-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-2-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-2-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-2-10">10</a></span>
<span class="normal"><a href="#__codelineno-2-11">11</a></span>
<span class="normal"><a href="#__codelineno-2-12">12</a></span>
<span class="normal"><a href="#__codelineno-2-13">13</a></span>
<span class="normal"><a href="#__codelineno-2-14">14</a></span>
<span class="normal"><a href="#__codelineno-2-15">15</a></span>
<span class="normal"><a href="#__codelineno-2-16">16</a></span>
<span class="normal"><a href="#__codelineno-2-17">17</a></span>
<span class="normal"><a href="#__codelineno-2-18">18</a></span>
<span class="normal"><a href="#__codelineno-2-19">19</a></span>
<span class="normal"><a href="#__codelineno-2-20">20</a></span>
<span class="normal"><a href="#__codelineno-2-21">21</a></span>
<span class="normal"><a href="#__codelineno-2-22">22</a></span>
<span class="normal"><a href="#__codelineno-2-23">23</a></span>
<span class="normal"><a href="#__codelineno-2-24">24</a></span>
<span class="normal"><a href="#__codelineno-2-25">25</a></span>
<span class="normal"><a href="#__codelineno-2-26">26</a></span>
<span class="normal"><a href="#__codelineno-2-27">27</a></span>
<span class="normal"><a href="#__codelineno-2-28">28</a></span>
<span class="normal"><a href="#__codelineno-2-29">29</a></span>
<span class="normal"><a href="#__codelineno-2-30">30</a></span>
<span class="normal"><a href="#__codelineno-2-31">31</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="c1"># Minimal development configuration</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>docker-environment.env<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="s"># Basic Configuration</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="s">NODE_ENV=development</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="s">FRONTEND_URL=http://localhost:3000</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6"></a><span class="s">NEXTAUTH_URL=http://localhost:3000</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7"></a><span class="s">NEXT_PUBLIC_API_URL=http://localhost:4000/api</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8"></a><span class="s">CORS_ORIGIN=http://localhost:3000</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10"></a><span class="s"># Database</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11"></a><span class="s">DATABASE_URL=postgresql://medianest:medianest_dev_password@localhost:5432/medianest_dev</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12"></a><span class="s">POSTGRES_DB=medianest_dev</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13"></a><span class="s">POSTGRES_USER=medianest</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14"></a><span class="s">POSTGRES_PASSWORD=medianest_dev_password</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16"></a><span class="s"># Redis</span>
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17"></a><span class="s">REDIS_URL=redis://localhost:6379</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19"></a><span class="s"># Security (CHANGE THESE IN PRODUCTION!)</span>
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20"></a><span class="s">NEXTAUTH_SECRET=dev-nextauth-secret-change-in-production-32-chars-minimum</span>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21"></a><span class="s">JWT_SECRET=dev-jwt-secret-change-in-production-32-chars-minimum</span>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22"></a><span class="s">ENCRYPTION_KEY=dev-encryption-key-change-in-production-32-chars-minimum</span>
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="s"># OAuth (Get from Plex Developer Console)</span>
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25"></a><span class="s">PLEX_CLIENT_ID=your_plex_client_id_here</span>
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26"></a><span class="s">PLEX_CLIENT_SECRET=your_plex_client_secret_here</span>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27"></a>
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28"></a><span class="s"># Logging</span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29"></a><span class="s">LOG_LEVEL=debug</span>
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30"></a><span class="s">DEBUG=medianest:*</span>
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31"></a><span class="s">EOF</span>
</span></code></pre></div></td></tr></table></div><h4 id="4-start-development-services">4. Start Development Services<a class="headerlink" href="#4-start-development-services" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="c1"># Using Docker Compose</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.dev.yml<span class="w"> </span>--env-file<span class="w"> </span>docker-environment.env<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="c1"># Or start services individually</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5"></a>npm<span class="w"> </span>run<span class="w"> </span>dev:backend<span class="w"> </span><span class="p">&amp;</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6"></a>npm<span class="w"> </span>run<span class="w"> </span>dev:frontend<span class="w"> </span><span class="p">&amp;</span>
</span></code></pre></div></td></tr></table></div><h4 id="5-validate-configuration">5. Validate Configuration<a class="headerlink" href="#5-validate-configuration" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span>
<span class="normal"><a href="#__codelineno-4-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># Check database connection</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2"></a>npm<span class="w"> </span>run<span class="w"> </span>db:test-connection
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1"># Check Redis connection</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5"></a>npm<span class="w"> </span>run<span class="w"> </span>redis:ping
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6"></a>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1"># Run configuration validator</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8"></a>npm<span class="w"> </span>run<span class="w"> </span>config:validate
</span></code></pre></div></td></tr></table></div><h3 id="production-environment-setup">Production Environment Setup<a class="headerlink" href="#production-environment-setup" title="Permanent link">&para;</a></h3><h4 id="1-generate-secure-secrets">1. Generate Secure Secrets<a class="headerlink" href="#1-generate-secure-secrets" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="c1"># generate-secrets.sh</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="c1"># Generate secure random secrets</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Generating production secrets...&quot;</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="c1"># JWT Secret (64 characters)</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="nv">JWT_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;JWT_SECRET=</span><span class="si">${</span><span class="nv">JWT_SECRET</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>.env.production
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10"></a>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="c1"># NextAuth Secret (64 characters)</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="nv">NEXTAUTH_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NEXTAUTH_SECRET=</span><span class="si">${</span><span class="nv">NEXTAUTH_SECRET</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>.env.production
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14"></a>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="c1"># Encryption Key (32 bytes for AES-256)</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="nv">ENCRYPTION_KEY</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ENCRYPTION_KEY=</span><span class="si">${</span><span class="nv">ENCRYPTION_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>.env.production
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18"></a>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="c1"># Session Secret (64 characters)</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="nv">SESSION_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;SESSION_SECRET=</span><span class="si">${</span><span class="nv">SESSION_SECRET</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>.env.production
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22"></a>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Secrets generated in .env.production&quot;</span>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;IMPORTANT: Store these securely and never commit them to version control!&quot;</span>
</span></code></pre></div></td></tr></table></div><h4 id="2-create-docker-secrets">2. Create Docker Secrets<a class="headerlink" href="#2-create-docker-secrets" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-6-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-6-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-6-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-6-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-6-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-6-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-6-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-6-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-6-10">10</a></span>
<span class="normal"><a href="#__codelineno-6-11">11</a></span>
<span class="normal"><a href="#__codelineno-6-12">12</a></span>
<span class="normal"><a href="#__codelineno-6-13">13</a></span>
<span class="normal"><a href="#__codelineno-6-14">14</a></span>
<span class="normal"><a href="#__codelineno-6-15">15</a></span>
<span class="normal"><a href="#__codelineno-6-16">16</a></span>
<span class="normal"><a href="#__codelineno-6-17">17</a></span>
<span class="normal"><a href="#__codelineno-6-18">18</a></span>
<span class="normal"><a href="#__codelineno-6-19">19</a></span>
<span class="normal"><a href="#__codelineno-6-20">20</a></span>
<span class="normal"><a href="#__codelineno-6-21">21</a></span>
<span class="normal"><a href="#__codelineno-6-22">22</a></span>
<span class="normal"><a href="#__codelineno-6-23">23</a></span>
<span class="normal"><a href="#__codelineno-6-24">24</a></span>
<span class="normal"><a href="#__codelineno-6-25">25</a></span>
<span class="normal"><a href="#__codelineno-6-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="c1"># create-docker-secrets.sh</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3"></a>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="c1"># Create secrets directory</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>./secrets
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6"></a>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="c1"># Database URL</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;postgresql://medianest:</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">16</span><span class="k">)</span><span class="s2">@postgres:5432/medianest_prod&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>./secrets/database_url
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9"></a>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="c1"># Redis URL</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;redis://:</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">16</span><span class="k">)</span><span class="s2">@redis:6379&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>./secrets/redis_url
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12"></a>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="c1"># JWT Secret</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14"></a>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="w"> </span>&gt;<span class="w"> </span>./secrets/jwt_secret
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15"></a>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="c1"># NextAuth Secret</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17"></a>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="w"> </span>&gt;<span class="w"> </span>./secrets/nextauth_secret
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18"></a>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="c1"># Encryption Key</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20"></a>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">32</span><span class="w"> </span>&gt;<span class="w"> </span>./secrets/encryption_key
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="c1"># Set secure permissions</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23"></a>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>./secrets/*
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24"></a>chown<span class="w"> </span>root:docker<span class="w"> </span>./secrets/*
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25"></a>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Docker secrets created in ./secrets/&quot;</span>
</span></code></pre></div></td></tr></table></div><h4 id="3-production-environment-file">3. Production Environment File<a class="headerlink" href="#3-production-environment-file" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span>
<span class="normal"><a href="#__codelineno-7-30">30</a></span>
<span class="normal"><a href="#__codelineno-7-31">31</a></span>
<span class="normal"><a href="#__codelineno-7-32">32</a></span>
<span class="normal"><a href="#__codelineno-7-33">33</a></span>
<span class="normal"><a href="#__codelineno-7-34">34</a></span>
<span class="normal"><a href="#__codelineno-7-35">35</a></span>
<span class="normal"><a href="#__codelineno-7-36">36</a></span>
<span class="normal"><a href="#__codelineno-7-37">37</a></span>
<span class="normal"><a href="#__codelineno-7-38">38</a></span>
<span class="normal"><a href="#__codelineno-7-39">39</a></span>
<span class="normal"><a href="#__codelineno-7-40">40</a></span>
<span class="normal"><a href="#__codelineno-7-41">41</a></span>
<span class="normal"><a href="#__codelineno-7-42">42</a></span>
<span class="normal"><a href="#__codelineno-7-43">43</a></span>
<span class="normal"><a href="#__codelineno-7-44">44</a></span>
<span class="normal"><a href="#__codelineno-7-45">45</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1"># Production configuration</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>docker-environment.env<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="s"># Environment</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="s">NODE_ENV=production</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5"></a>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="s"># URLs (UPDATE THESE FOR YOUR DOMAIN)</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="s">DOMAIN_NAME=yourdomain.com</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="s">FRONTEND_URL=https://yourdomain.com</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="s">NEXTAUTH_URL=https://yourdomain.com</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="s">NEXT_PUBLIC_API_URL=https://yourdomain.com/api</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="s">CORS_ORIGIN=https://yourdomain.com</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12"></a>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="s"># Use Docker secrets for sensitive data</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="s">DATABASE_URL_FILE=/run/secrets/database_url</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="s">REDIS_URL_FILE=/run/secrets/redis_url</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="s">NEXTAUTH_SECRET_FILE=/run/secrets/nextauth_secret</span>
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="s">JWT_SECRET_FILE=/run/secrets/jwt_secret</span>
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="s">ENCRYPTION_KEY_FILE=/run/secrets/encryption_key</span>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="s">PLEX_CLIENT_ID_FILE=/run/secrets/plex_client_id</span>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="s">PLEX_CLIENT_SECRET_FILE=/run/secrets/plex_client_secret</span>
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21"></a>
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="s"># Database</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="s">POSTGRES_DB=medianest_prod</span>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="s">POSTGRES_USER=medianest</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="s">POSTGRES_PASSWORD_FILE=/run/secrets/postgres_password</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26"></a>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="s"># Redis</span>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="s">REDIS_PASSWORD_FILE=/run/secrets/redis_password</span>
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29"></a>
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30"></a><span class="s"># SSL/TLS</span>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="s">CERTBOT_EMAIL=admin@yourdomain.com</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32"></a>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33"></a><span class="s"># Security Settings</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34"></a><span class="s">BCRYPT_ROUNDS=14</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35"></a><span class="s">MAX_LOGIN_ATTEMPTS=3</span>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36"></a><span class="s">LOCKOUT_TIME=3600000</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37"></a>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38"></a><span class="s"># Performance</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39"></a><span class="s">DB_POOL_MAX=20</span>
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40"></a><span class="s">REDIS_MAX_CLIENTS=2000</span>
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41"></a>
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42"></a><span class="s"># Monitoring</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43"></a><span class="s">ERROR_REPORTING_ENABLED=true</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44"></a><span class="s">LOG_LEVEL=warn</span>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45"></a><span class="s">EOF</span>
</span></code></pre></div></td></tr></table></div><h4 id="4-deploy-with-docker-compose">4. Deploy with Docker Compose<a class="headerlink" href="#4-deploy-with-docker-compose" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span>
<span class="normal"><a href="#__codelineno-8-2">2</a></span>
<span class="normal"><a href="#__codelineno-8-3">3</a></span>
<span class="normal"><a href="#__codelineno-8-4">4</a></span>
<span class="normal"><a href="#__codelineno-8-5">5</a></span>
<span class="normal"><a href="#__codelineno-8-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="c1"># Deploy production stack</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.prod.yml<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3"></a><span class="w">  </span>--env-file<span class="w"> </span>docker-environment.env<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4"></a>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5"></a><span class="c1"># Verify deployment</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.prod.yml<span class="w"> </span>ps
</span></code></pre></div></td></tr></table></div><h3 id="testing-environment-setup">Testing Environment Setup<a class="headerlink" href="#testing-environment-setup" title="Permanent link">&para;</a></h3><h4 id="1-test-environment-configuration">1. Test Environment Configuration<a class="headerlink" href="#1-test-environment-configuration" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span>
<span class="normal"><a href="#__codelineno-9-20">20</a></span>
<span class="normal"><a href="#__codelineno-9-21">21</a></span>
<span class="normal"><a href="#__codelineno-9-22">22</a></span>
<span class="normal"><a href="#__codelineno-9-23">23</a></span>
<span class="normal"><a href="#__codelineno-9-24">24</a></span>
<span class="normal"><a href="#__codelineno-9-25">25</a></span>
<span class="normal"><a href="#__codelineno-9-26">26</a></span>
<span class="normal"><a href="#__codelineno-9-27">27</a></span>
<span class="normal"><a href="#__codelineno-9-28">28</a></span>
<span class="normal"><a href="#__codelineno-9-29">29</a></span>
<span class="normal"><a href="#__codelineno-9-30">30</a></span>
<span class="normal"><a href="#__codelineno-9-31">31</a></span>
<span class="normal"><a href="#__codelineno-9-32">32</a></span>
<span class="normal"><a href="#__codelineno-9-33">33</a></span>
<span class="normal"><a href="#__codelineno-9-34">34</a></span>
<span class="normal"><a href="#__codelineno-9-35">35</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1"></a>cat<span class="w"> </span>&gt;<span class="w"> </span>docker-environment.test.env<span class="w"> </span><span class="s">&lt;&lt; &#39;EOF&#39;</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="s"># Test Environment</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="s">NODE_ENV=test</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="s"># Test URLs</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="s">FRONTEND_URL=http://localhost:3000</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="s">NEXTAUTH_URL=http://localhost:3000</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8"></a><span class="s">TEST_BASE_URL=http://localhost:3001</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="s"># Test Database</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="s">TEST_DATABASE_URL=postgresql://test_user:test_password@localhost:5432/medianest_test</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="s">DATABASE_URL=postgresql://test_user:test_password@localhost:5432/medianest_test</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="s"># Test Redis</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="s">TEST_REDIS_URL=redis://localhost:6379/15</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="s">REDIS_URL=redis://localhost:6379/15</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17"></a>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="s"># Test Secrets</span>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="s">JWT_SECRET=test-jwt-secret-that-is-at-least-32-characters-long-for-validation</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="s">NEXTAUTH_SECRET=test-nextauth-secret-32-chars-minimum</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="s">ENCRYPTION_KEY=test-encryption-key-32-bytes-long</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22"></a>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="s"># Test OAuth</span>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="s">PLEX_CLIENT_ID=test-plex-client-id</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25"></a><span class="s">PLEX_CLIENT_SECRET=test-plex-client-secret</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26"></a>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27"></a><span class="s"># Performance Testing</span>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28"></a><span class="s">STRESS_TEST_MAX_CONNECTIONS=100</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29"></a><span class="s">STRESS_TEST_MAX_REDIS_CLIENTS=50</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30"></a><span class="s">MAX_DB_CONNECTIONS=50</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31"></a><span class="s">CONCURRENT_QUERIES=100</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32"></a>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33"></a><span class="s"># Logging</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34"></a><span class="s">LOG_LEVEL=error</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35"></a><span class="s">EOF</span>
</span></code></pre></div></td></tr></table></div><h4 id="2-cicd-environment">2. CI/CD Environment<a class="headerlink" href="#2-cicd-environment" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-10-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-10-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-10-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-10-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-10-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-10-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-10-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-10-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-10-10">10</a></span>
<span class="normal"><a href="#__codelineno-10-11">11</a></span>
<span class="normal"><a href="#__codelineno-10-12">12</a></span>
<span class="normal"><a href="#__codelineno-10-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="c1"># .github/workflows/test.yml environment section</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2"></a>env:
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">  </span>NODE_ENV:<span class="w"> </span><span class="nb">test</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">  </span>CI:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">  </span>DATABASE_URL:<span class="w"> </span>postgresql://postgres:postgres@localhost:5432/medianest_test
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">  </span>REDIS_URL:<span class="w"> </span>redis://localhost:6379/15
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">  </span>JWT_SECRET:<span class="w"> </span>ci-test-jwt-secret-32-chars-minimum
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">  </span>NEXTAUTH_SECRET:<span class="w"> </span>ci-test-nextauth-secret-32-chars-minimum
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">  </span>ENCRYPTION_KEY:<span class="w"> </span>ci-test-encryption-key-32-chars-minimum
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="w">  </span>PLEX_CLIENT_ID:<span class="w"> </span>ci-test-plex-client-id
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11"></a><span class="w">  </span>PLEX_CLIENT_SECRET:<span class="w"> </span>ci-test-plex-client-secret
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="w">  </span>LOG_LEVEL:<span class="w"> </span>error
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">  </span>TEST_TIMEOUT:<span class="w"> </span><span class="m">30000</span>
</span></code></pre></div></td></tr></table></div><h3 id="common-deployment-scenarios">Common Deployment Scenarios<a class="headerlink" href="#common-deployment-scenarios" title="Permanent link">&para;</a></h3><h4 id="docker-development-stack">Docker Development Stack<a class="headerlink" href="#docker-development-stack" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1"># Full development stack</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.dev.yml<span class="w"> </span><span class="se">\</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">  </span>--env-file<span class="w"> </span>docker-environment.env<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="c1"># Services: postgres, redis, backend, frontend</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="c1"># Ports: 3000 (frontend), 4000 (backend), 5432 (postgres), 6379 (redis)</span>
</span></code></pre></div></td></tr></table></div><h4 id="production-with-ssl">Production with SSL<a class="headerlink" href="#production-with-ssl" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span>
<span class="normal"><a href="#__codelineno-12-2">2</a></span>
<span class="normal"><a href="#__codelineno-12-3">3</a></span>
<span class="normal"><a href="#__codelineno-12-4">4</a></span>
<span class="normal"><a href="#__codelineno-12-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="c1"># Production with Traefik reverse proxy and SSL</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.prod.yml<span class="w"> </span><span class="se">\</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">  </span>--env-file<span class="w"> </span>docker-environment.env<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4"></a>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="c1"># Includes: SSL termination, monitoring, backups</span>
</span></code></pre></div></td></tr></table></div><h4 id="testing-stack">Testing Stack<a class="headerlink" href="#testing-stack" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1">1</a></span>
<span class="normal"><a href="#__codelineno-13-2">2</a></span>
<span class="normal"><a href="#__codelineno-13-3">3</a></span>
<span class="normal"><a href="#__codelineno-13-4">4</a></span>
<span class="normal"><a href="#__codelineno-13-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="c1"># Isolated testing environment</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.test.yml<span class="w"> </span><span class="se">\</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="w">  </span>--env-file<span class="w"> </span>docker-environment.test.env<span class="w"> </span>up<span class="w"> </span>-d
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4"></a>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="c1"># Clean environment for running tests</span>
</span></code></pre></div></td></tr></table></div><h3 id="validation-commands">Validation Commands<a class="headerlink" href="#validation-commands" title="Permanent link">&para;</a></h3><h4 id="environment-validation-script">Environment Validation Script<a class="headerlink" href="#environment-validation-script" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-14-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-14-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-14-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-14-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-14-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-14-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-14-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-14-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-14-10">10</a></span>
<span class="normal"><a href="#__codelineno-14-11">11</a></span>
<span class="normal"><a href="#__codelineno-14-12">12</a></span>
<span class="normal"><a href="#__codelineno-14-13">13</a></span>
<span class="normal"><a href="#__codelineno-14-14">14</a></span>
<span class="normal"><a href="#__codelineno-14-15">15</a></span>
<span class="normal"><a href="#__codelineno-14-16">16</a></span>
<span class="normal"><a href="#__codelineno-14-17">17</a></span>
<span class="normal"><a href="#__codelineno-14-18">18</a></span>
<span class="normal"><a href="#__codelineno-14-19">19</a></span>
<span class="normal"><a href="#__codelineno-14-20">20</a></span>
<span class="normal"><a href="#__codelineno-14-21">21</a></span>
<span class="normal"><a href="#__codelineno-14-22">22</a></span>
<span class="normal"><a href="#__codelineno-14-23">23</a></span>
<span class="normal"><a href="#__codelineno-14-24">24</a></span>
<span class="normal"><a href="#__codelineno-14-25">25</a></span>
<span class="normal"><a href="#__codelineno-14-26">26</a></span>
<span class="normal"><a href="#__codelineno-14-27">27</a></span>
<span class="normal"><a href="#__codelineno-14-28">28</a></span>
<span class="normal"><a href="#__codelineno-14-29">29</a></span>
<span class="normal"><a href="#__codelineno-14-30">30</a></span>
<span class="normal"><a href="#__codelineno-14-31">31</a></span>
<span class="normal"><a href="#__codelineno-14-32">32</a></span>
<span class="normal"><a href="#__codelineno-14-33">33</a></span>
<span class="normal"><a href="#__codelineno-14-34">34</a></span>
<span class="normal"><a href="#__codelineno-14-35">35</a></span>
<span class="normal"><a href="#__codelineno-14-36">36</a></span>
<span class="normal"><a href="#__codelineno-14-37">37</a></span>
<span class="normal"><a href="#__codelineno-14-38">38</a></span>
<span class="normal"><a href="#__codelineno-14-39">39</a></span>
<span class="normal"><a href="#__codelineno-14-40">40</a></span>
<span class="normal"><a href="#__codelineno-14-41">41</a></span>
<span class="normal"><a href="#__codelineno-14-42">42</a></span>
<span class="normal"><a href="#__codelineno-14-43">43</a></span>
<span class="normal"><a href="#__codelineno-14-44">44</a></span>
<span class="normal"><a href="#__codelineno-14-45">45</a></span>
<span class="normal"><a href="#__codelineno-14-46">46</a></span>
<span class="normal"><a href="#__codelineno-14-47">47</a></span>
<span class="normal"><a href="#__codelineno-14-48">48</a></span>
<span class="normal"><a href="#__codelineno-14-49">49</a></span>
<span class="normal"><a href="#__codelineno-14-50">50</a></span>
<span class="normal"><a href="#__codelineno-14-51">51</a></span>
<span class="normal"><a href="#__codelineno-14-52">52</a></span>
<span class="normal"><a href="#__codelineno-14-53">53</a></span>
<span class="normal"><a href="#__codelineno-14-54">54</a></span>
<span class="normal"><a href="#__codelineno-14-55">55</a></span>
<span class="normal"><a href="#__codelineno-14-56">56</a></span>
<span class="normal"><a href="#__codelineno-14-57">57</a></span>
<span class="normal"><a href="#__codelineno-14-58">58</a></span>
<span class="normal"><a href="#__codelineno-14-59">59</a></span>
<span class="normal"><a href="#__codelineno-14-60">60</a></span>
<span class="normal"><a href="#__codelineno-14-61">61</a></span>
<span class="normal"><a href="#__codelineno-14-62">62</a></span>
<span class="normal"><a href="#__codelineno-14-63">63</a></span>
<span class="normal"><a href="#__codelineno-14-64">64</a></span>
<span class="normal"><a href="#__codelineno-14-65">65</a></span>
<span class="normal"><a href="#__codelineno-14-66">66</a></span>
<span class="normal"><a href="#__codelineno-14-67">67</a></span>
<span class="normal"><a href="#__codelineno-14-68">68</a></span>
<span class="normal"><a href="#__codelineno-14-69">69</a></span>
<span class="normal"><a href="#__codelineno-14-70">70</a></span>
<span class="normal"><a href="#__codelineno-14-71">71</a></span>
<span class="normal"><a href="#__codelineno-14-72">72</a></span>
<span class="normal"><a href="#__codelineno-14-73">73</a></span>
<span class="normal"><a href="#__codelineno-14-74">74</a></span>
<span class="normal"><a href="#__codelineno-14-75">75</a></span>
<span class="normal"><a href="#__codelineno-14-76">76</a></span>
<span class="normal"><a href="#__codelineno-14-77">77</a></span>
<span class="normal"><a href="#__codelineno-14-78">78</a></span>
<span class="normal"><a href="#__codelineno-14-79">79</a></span>
<span class="normal"><a href="#__codelineno-14-80">80</a></span>
<span class="normal"><a href="#__codelineno-14-81">81</a></span>
<span class="normal"><a href="#__codelineno-14-82">82</a></span>
<span class="normal"><a href="#__codelineno-14-83">83</a></span>
<span class="normal"><a href="#__codelineno-14-84">84</a></span>
<span class="normal"><a href="#__codelineno-14-85">85</a></span>
<span class="normal"><a href="#__codelineno-14-86">86</a></span>
<span class="normal"><a href="#__codelineno-14-87">87</a></span>
<span class="normal"><a href="#__codelineno-14-88">88</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="c1"># validate-environment.sh</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3"></a>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🔍 Validating MediaNest Environment Configuration&quot;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5"></a>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="c1"># Check required files</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;docker-environment.env&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ docker-environment.env not found&quot;</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="k">fi</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11"></a>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="c1"># Source environment file</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="nb">set</span><span class="w"> </span>-a
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="nb">source</span><span class="w"> </span>docker-environment.env
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="nb">set</span><span class="w"> </span>+a
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16"></a>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17"></a><span class="c1"># Validate required variables</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="nv">REQUIRED_VARS</span><span class="o">=(</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="w">  </span><span class="s2">&quot;NODE_ENV&quot;</span>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="w">  </span><span class="s2">&quot;DATABASE_URL&quot;</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="w">  </span><span class="s2">&quot;REDIS_URL&quot;</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="w">  </span><span class="s2">&quot;JWT_SECRET&quot;</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="w">  </span><span class="s2">&quot;NEXTAUTH_SECRET&quot;</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="w">  </span><span class="s2">&quot;ENCRYPTION_KEY&quot;</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25"></a><span class="w">  </span><span class="s2">&quot;FRONTEND_URL&quot;</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="o">)</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27"></a>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="k">for</span><span class="w"> </span>var<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">REQUIRED_VARS</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!var</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Required variable </span><span class="nv">$var</span><span class="s2"> is not set&quot;</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31"></a><span class="w">    </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ </span><span class="nv">$var</span><span class="s2"> is set&quot;</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35"></a><span class="k">done</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36"></a>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37"></a><span class="c1"># Validate secret lengths</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">JWT_SECRET</span><span class="si">}</span><span class="w"> </span>-lt<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ JWT_SECRET must be at least 32 characters&quot;</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41"></a><span class="k">fi</span>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42"></a>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">NEXTAUTH_SECRET</span><span class="si">}</span><span class="w"> </span>-lt<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ NEXTAUTH_SECRET must be at least 32 characters&quot;</span>
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46"></a><span class="k">fi</span>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47"></a>
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">ENCRYPTION_KEY</span><span class="si">}</span><span class="w"> </span>-lt<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ ENCRYPTION_KEY must be at least 32 characters&quot;</span>
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51"></a><span class="k">fi</span>
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52"></a>
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53"></a><span class="c1"># Test database connection</span>
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🗄️  Testing database connection...&quot;</span>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55"></a><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>psql<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-56"><a id="__codelineno-14-56" name="__codelineno-14-56"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;SELECT 1;&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-57"><a id="__codelineno-14-57" name="__codelineno-14-57"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Database connection successful&quot;</span>
</span><span id="__span-14-58"><a id="__codelineno-14-58" name="__codelineno-14-58"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-14-59"><a id="__codelineno-14-59" name="__codelineno-14-59"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Database connection failed&quot;</span>
</span><span id="__span-14-60"><a id="__codelineno-14-60" name="__codelineno-14-60"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-61"><a id="__codelineno-14-61" name="__codelineno-14-61"></a><span class="k">else</span>
</span><span id="__span-14-62"><a id="__codelineno-14-62" name="__codelineno-14-62"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚠️  psql not found, skipping database test&quot;</span>
</span><span id="__span-14-63"><a id="__codelineno-14-63" name="__codelineno-14-63"></a><span class="k">fi</span>
</span><span id="__span-14-64"><a id="__codelineno-14-64" name="__codelineno-14-64"></a>
</span><span id="__span-14-65"><a id="__codelineno-14-65" name="__codelineno-14-65"></a><span class="c1"># Test Redis connection</span>
</span><span id="__span-14-66"><a id="__codelineno-14-66" name="__codelineno-14-66"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;📊 Testing Redis connection...&quot;</span>
</span><span id="__span-14-67"><a id="__codelineno-14-67" name="__codelineno-14-67"></a><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>redis-cli<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-68"><a id="__codelineno-14-68" name="__codelineno-14-68"></a><span class="w">  </span><span class="nv">REDIS_HOST</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$REDIS_URL</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/.*@\([^:]*\).*/\1/p&#39;</span><span class="k">)</span>
</span><span id="__span-14-69"><a id="__codelineno-14-69" name="__codelineno-14-69"></a><span class="w">  </span><span class="nv">REDIS_PORT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$REDIS_URL</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/.*:\([0-9]*\).*/\1/p&#39;</span><span class="k">)</span>
</span><span id="__span-14-70"><a id="__codelineno-14-70" name="__codelineno-14-70"></a>
</span><span id="__span-14-71"><a id="__codelineno-14-71" name="__codelineno-14-71"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_HOST</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-72"><a id="__codelineno-14-72" name="__codelineno-14-72"></a><span class="w">    </span><span class="nv">REDIS_HOST</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$REDIS_URL</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/redis:\/\/\([^:]*\).*/\1/p&#39;</span><span class="k">)</span>
</span><span id="__span-14-73"><a id="__codelineno-14-73" name="__codelineno-14-73"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-74"><a id="__codelineno-14-74" name="__codelineno-14-74"></a>
</span><span id="__span-14-75"><a id="__codelineno-14-75" name="__codelineno-14-75"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_PORT</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-76"><a id="__codelineno-14-76" name="__codelineno-14-76"></a><span class="w">    </span><span class="nv">REDIS_PORT</span><span class="o">=</span><span class="m">6379</span>
</span><span id="__span-14-77"><a id="__codelineno-14-77" name="__codelineno-14-77"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-78"><a id="__codelineno-14-78" name="__codelineno-14-78"></a>
</span><span id="__span-14-79"><a id="__codelineno-14-79" name="__codelineno-14-79"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span>redis-cli<span class="w"> </span>-h<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_HOST</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_PORT</span><span class="s2">&quot;</span><span class="w"> </span>ping<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-14-80"><a id="__codelineno-14-80" name="__codelineno-14-80"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Redis connection successful&quot;</span>
</span><span id="__span-14-81"><a id="__codelineno-14-81" name="__codelineno-14-81"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-14-82"><a id="__codelineno-14-82" name="__codelineno-14-82"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Redis connection failed&quot;</span>
</span><span id="__span-14-83"><a id="__codelineno-14-83" name="__codelineno-14-83"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-14-84"><a id="__codelineno-14-84" name="__codelineno-14-84"></a><span class="k">else</span>
</span><span id="__span-14-85"><a id="__codelineno-14-85" name="__codelineno-14-85"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚠️  redis-cli not found, skipping Redis test&quot;</span>
</span><span id="__span-14-86"><a id="__codelineno-14-86" name="__codelineno-14-86"></a><span class="k">fi</span>
</span><span id="__span-14-87"><a id="__codelineno-14-87" name="__codelineno-14-87"></a>
</span><span id="__span-14-88"><a id="__codelineno-14-88" name="__codelineno-14-88"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Environment validation complete&quot;</span>
</span></code></pre></div></td></tr></table></div><p>Make it executable and run:</p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1"></a>chmod<span class="w"> </span>+x<span class="w"> </span>validate-environment.sh
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2"></a>./validate-environment.sh
</span></code></pre></div></td></tr></table></div><h4 id="application-health-check">Application Health Check<a class="headerlink" href="#application-health-check" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span>
<span class="normal"><a href="#__codelineno-16-13">13</a></span>
<span class="normal"><a href="#__codelineno-16-14">14</a></span>
<span class="normal"><a href="#__codelineno-16-15">15</a></span>
<span class="normal"><a href="#__codelineno-16-16">16</a></span>
<span class="normal"><a href="#__codelineno-16-17">17</a></span>
<span class="normal"><a href="#__codelineno-16-18">18</a></span>
<span class="normal"><a href="#__codelineno-16-19">19</a></span>
<span class="normal"><a href="#__codelineno-16-20">20</a></span>
<span class="normal"><a href="#__codelineno-16-21">21</a></span>
<span class="normal"><a href="#__codelineno-16-22">22</a></span>
<span class="normal"><a href="#__codelineno-16-23">23</a></span>
<span class="normal"><a href="#__codelineno-16-24">24</a></span>
<span class="normal"><a href="#__codelineno-16-25">25</a></span>
<span class="normal"><a href="#__codelineno-16-26">26</a></span>
<span class="normal"><a href="#__codelineno-16-27">27</a></span>
<span class="normal"><a href="#__codelineno-16-28">28</a></span>
<span class="normal"><a href="#__codelineno-16-29">29</a></span>
<span class="normal"><a href="#__codelineno-16-30">30</a></span>
<span class="normal"><a href="#__codelineno-16-31">31</a></span>
<span class="normal"><a href="#__codelineno-16-32">32</a></span>
<span class="normal"><a href="#__codelineno-16-33">33</a></span>
<span class="normal"><a href="#__codelineno-16-34">34</a></span>
<span class="normal"><a href="#__codelineno-16-35">35</a></span>
<span class="normal"><a href="#__codelineno-16-36">36</a></span>
<span class="normal"><a href="#__codelineno-16-37">37</a></span>
<span class="normal"><a href="#__codelineno-16-38">38</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="c1"># health-check.sh</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🏥 MediaNest Health Check&quot;</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="c1"># Check if services are running</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7"></a><span class="nv">services</span><span class="o">=(</span><span class="s2">&quot;frontend&quot;</span><span class="w"> </span><span class="s2">&quot;backend&quot;</span><span class="w"> </span><span class="s2">&quot;postgres&quot;</span><span class="w"> </span><span class="s2">&quot;redis&quot;</span><span class="o">)</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8"></a>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="k">for</span><span class="w"> </span>service<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">services</span><span class="p">[@]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span>docker-compose<span class="w"> </span>ps<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$service</span><span class="s2">&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="k">$(</span>docker-compose<span class="w"> </span>ps<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$service</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>docker<span class="w"> </span>inspect<span class="w"> </span>--format<span class="o">=</span><span class="s1">&#39;{{.State.Health.Status}}&#39;</span><span class="k">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;healthy&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ </span><span class="nv">$service</span><span class="s2"> is healthy&quot;</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚠️  </span><span class="nv">$service</span><span class="s2"> is running but not healthy&quot;</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ </span><span class="nv">$service</span><span class="s2"> is not running&quot;</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="k">done</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20"></a>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="c1"># Test API endpoints</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🔗 Testing API endpoints...&quot;</span>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23"></a>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="c1"># Backend health</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25"></a><span class="k">if</span><span class="w"> </span>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:4000/health<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Backend API is responding&quot;</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27"></a><span class="k">else</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Backend API is not responding&quot;</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29"></a><span class="k">fi</span>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30"></a>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31"></a><span class="c1"># Frontend health</span>
</span><span id="__span-16-32"><a id="__codelineno-16-32" name="__codelineno-16-32"></a><span class="k">if</span><span class="w"> </span>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:3000<span class="w"> </span>&gt;<span class="w"> </span>/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-16-33"><a id="__codelineno-16-33" name="__codelineno-16-33"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Frontend is responding&quot;</span>
</span><span id="__span-16-34"><a id="__codelineno-16-34" name="__codelineno-16-34"></a><span class="k">else</span>
</span><span id="__span-16-35"><a id="__codelineno-16-35" name="__codelineno-16-35"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Frontend is not responding&quot;</span>
</span><span id="__span-16-36"><a id="__codelineno-16-36" name="__codelineno-16-36"></a><span class="k">fi</span>
</span><span id="__span-16-37"><a id="__codelineno-16-37" name="__codelineno-16-37"></a>
</span><span id="__span-16-38"><a id="__codelineno-16-38" name="__codelineno-16-38"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🏁 Health check complete&quot;</span>
</span></code></pre></div></td></tr></table></div><hr><h2 id="security-best-practices">Security Best Practices<a class="headerlink" href="#security-best-practices" title="Permanent link">&para;</a></h2><h3 id="secret-generation-guidelines">Secret Generation Guidelines<a class="headerlink" href="#secret-generation-guidelines" title="Permanent link">&para;</a></h3><h4 id="1-strong-secret-requirements">1. Strong Secret Requirements<a class="headerlink" href="#1-strong-secret-requirements" title="Permanent link">&para;</a></h4><table><thead><tr><th>Secret Type</th><th>Minimum Length</th><th>Recommended Length</th><th>Algorithm</th></tr></thead><tbody><tr><td>JWT_SECRET</td><td>32 characters</td><td>64 characters</td><td>HMAC-SHA256</td></tr><tr><td>NEXTAUTH_SECRET</td><td>32 characters</td><td>64 characters</td><td>Random</td></tr><tr><td>ENCRYPTION_KEY</td><td>32 bytes</td><td>32 bytes</td><td>AES-256-GCM</td></tr><tr><td>SESSION_SECRET</td><td>32 characters</td><td>64 characters</td><td>Random</td></tr><tr><td>Database Passwords</td><td>16 characters</td><td>32 characters</td><td>Random</td></tr></tbody></table><h4 id="2-secure-secret-generation-commands">2. Secure Secret Generation Commands<a class="headerlink" href="#2-secure-secret-generation-commands" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="c1"># JWT Secret (HMAC-SHA256 compatible)</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="nv">JWT_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="c1"># NextAuth Secret</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="nv">NEXTAUTH_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="c1"># AES-256-GCM Encryption Key</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="nv">ENCRYPTION_KEY</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9"></a>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="c1"># Database Password</span>
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="nv">DB_PASSWORD</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;=+/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-c1-20<span class="k">)</span>
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12"></a>
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13"></a><span class="c1"># Redis Password</span>
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="nv">REDIS_PASSWORD</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;=+/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-c1-20<span class="k">)</span>
</span></code></pre></div></td></tr></table></div><h4 id="3-secret-validation-script">3. Secret Validation Script<a class="headerlink" href="#3-secret-validation-script" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-18-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-18-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-18-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-18-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-18-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-18-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-18-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-18-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-18-10">10</a></span>
<span class="normal"><a href="#__codelineno-18-11">11</a></span>
<span class="normal"><a href="#__codelineno-18-12">12</a></span>
<span class="normal"><a href="#__codelineno-18-13">13</a></span>
<span class="normal"><a href="#__codelineno-18-14">14</a></span>
<span class="normal"><a href="#__codelineno-18-15">15</a></span>
<span class="normal"><a href="#__codelineno-18-16">16</a></span>
<span class="normal"><a href="#__codelineno-18-17">17</a></span>
<span class="normal"><a href="#__codelineno-18-18">18</a></span>
<span class="normal"><a href="#__codelineno-18-19">19</a></span>
<span class="normal"><a href="#__codelineno-18-20">20</a></span>
<span class="normal"><a href="#__codelineno-18-21">21</a></span>
<span class="normal"><a href="#__codelineno-18-22">22</a></span>
<span class="normal"><a href="#__codelineno-18-23">23</a></span>
<span class="normal"><a href="#__codelineno-18-24">24</a></span>
<span class="normal"><a href="#__codelineno-18-25">25</a></span>
<span class="normal"><a href="#__codelineno-18-26">26</a></span>
<span class="normal"><a href="#__codelineno-18-27">27</a></span>
<span class="normal"><a href="#__codelineno-18-28">28</a></span>
<span class="normal"><a href="#__codelineno-18-29">29</a></span>
<span class="normal"><a href="#__codelineno-18-30">30</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="c1"># validate-secrets.sh</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4"></a>validate_secret_strength<span class="o">()</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="nv">$1</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">value</span><span class="o">=</span><span class="nv">$2</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">min_length</span><span class="o">=</span><span class="nv">$3</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8"></a>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">value</span><span class="si">}</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$min_length</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ </span><span class="nv">$name</span><span class="s2"> is too short (</span><span class="si">${#</span><span class="nv">value</span><span class="si">}</span><span class="s2"> &lt; </span><span class="nv">$min_length</span><span class="s2">)&quot;</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13"></a>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">  </span><span class="c1"># Check for common weak patterns</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span>a-zA-Z<span class="o">]</span>+$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚠️  </span><span class="nv">$name</span><span class="s2"> contains only letters (consider adding numbers/symbols)&quot;</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚠️  </span><span class="nv">$name</span><span class="s2"> contains only numbers (consider adding letters/symbols)&quot;</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">  </span><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;password&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;secret&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;⚠️  </span><span class="nv">$name</span><span class="s2"> contains dictionary words&quot;</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ </span><span class="nv">$name</span><span class="s2"> meets strength requirements&quot;</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24"></a><span class="o">}</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25"></a>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="c1"># Validate secrets</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27"></a>validate_secret_strength<span class="w"> </span><span class="s2">&quot;JWT_SECRET&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JWT_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">32</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28"></a>validate_secret_strength<span class="w"> </span><span class="s2">&quot;NEXTAUTH_SECRET&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$NEXTAUTH_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">32</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29"></a>validate_secret_strength<span class="w"> </span><span class="s2">&quot;ENCRYPTION_KEY&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ENCRYPTION_KEY</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">32</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30"></a>validate_secret_strength<span class="w"> </span><span class="s2">&quot;SESSION_SECRET&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SESSION_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="m">32</span>
</span></code></pre></div></td></tr></table></div><h3 id="docker-secrets-integration">Docker Secrets Integration<a class="headerlink" href="#docker-secrets-integration" title="Permanent link">&para;</a></h3><h4 id="1-create-docker-secrets">1. Create Docker Secrets<a class="headerlink" href="#1-create-docker-secrets" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span>
<span class="normal"><a href="#__codelineno-19-22">22</a></span>
<span class="normal"><a href="#__codelineno-19-23">23</a></span>
<span class="normal"><a href="#__codelineno-19-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="c1"># setup-docker-secrets.sh</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="c1"># Create secrets directory</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5"></a>mkdir<span class="w"> </span>-p<span class="w"> </span>./secrets
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6"></a>chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span>./secrets
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7"></a>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="c1"># Generate and store secrets</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>jwt_secret<span class="w"> </span>-
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>nextauth_secret<span class="w"> </span>-
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>encryption_key<span class="w"> </span>-
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">16</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>postgres_password<span class="w"> </span>-
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">16</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>redis_password<span class="w"> </span>-
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14"></a>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="c1"># Plex secrets (you need to provide these)</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;your_plex_client_id&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>plex_client_id<span class="w"> </span>-
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;your_plex_client_secret&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>plex_client_secret<span class="w"> </span>-
</span><span id="__span-19-18"><a id="__codelineno-19-18" name="__codelineno-19-18"></a>
</span><span id="__span-19-19"><a id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="c1"># Database URL with generated password</span>
</span><span id="__span-19-20"><a id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="nv">POSTGRES_PASSWORD</span><span class="o">=</span><span class="k">$(</span>docker<span class="w"> </span>secret<span class="w"> </span>inspect<span class="w"> </span>postgres_password<span class="w"> </span>--format<span class="w"> </span><span class="s1">&#39;{{.Spec.Data}}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="k">)</span>
</span><span id="__span-19-21"><a id="__codelineno-19-21" name="__codelineno-19-21"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;postgresql://medianest:</span><span class="si">${</span><span class="nv">POSTGRES_PASSWORD</span><span class="si">}</span><span class="s2">@postgres:5432/medianest_prod&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>database_url<span class="w"> </span>-
</span><span id="__span-19-22"><a id="__codelineno-19-22" name="__codelineno-19-22"></a>
</span><span id="__span-19-23"><a id="__codelineno-19-23" name="__codelineno-19-23"></a><span class="c1"># List created secrets</span>
</span><span id="__span-19-24"><a id="__codelineno-19-24" name="__codelineno-19-24"></a>docker<span class="w"> </span>secret<span class="w"> </span>ls
</span></code></pre></div></td></tr></table></div><h4 id="2-docker-compose-secrets-configuration">2. Docker Compose Secrets Configuration<a class="headerlink" href="#2-docker-compose-secrets-configuration" title="Permanent link">&para;</a></h4><div class="language-yaml highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">YAML</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span>
<span class="normal"><a href="#__codelineno-20-14">14</a></span>
<span class="normal"><a href="#__codelineno-20-15">15</a></span>
<span class="normal"><a href="#__codelineno-20-16">16</a></span>
<span class="normal"><a href="#__codelineno-20-17">17</a></span>
<span class="normal"><a href="#__codelineno-20-18">18</a></span>
<span class="normal"><a href="#__codelineno-20-19">19</a></span>
<span class="normal"><a href="#__codelineno-20-20">20</a></span>
<span class="normal"><a href="#__codelineno-20-21">21</a></span>
<span class="normal"><a href="#__codelineno-20-22">22</a></span>
<span class="normal"><a href="#__codelineno-20-23">23</a></span>
<span class="normal"><a href="#__codelineno-20-24">24</a></span>
<span class="normal"><a href="#__codelineno-20-25">25</a></span>
<span class="normal"><a href="#__codelineno-20-26">26</a></span>
<span class="normal"><a href="#__codelineno-20-27">27</a></span>
<span class="normal"><a href="#__codelineno-20-28">28</a></span>
<span class="normal"><a href="#__codelineno-20-29">29</a></span>
<span class="normal"><a href="#__codelineno-20-30">30</a></span>
<span class="normal"><a href="#__codelineno-20-31">31</a></span>
<span class="normal"><a href="#__codelineno-20-32">32</a></span>
<span class="normal"><a href="#__codelineno-20-33">33</a></span>
<span class="normal"><a href="#__codelineno-20-34">34</a></span>
<span class="normal"><a href="#__codelineno-20-35">35</a></span>
<span class="normal"><a href="#__codelineno-20-36">36</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># docker-compose.prod.yml secrets section</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="nt">secrets</span><span class="p">:</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">  </span><span class="nt">database_url</span><span class="p">:</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">  </span><span class="nt">jwt_secret</span><span class="p">:</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="w">  </span><span class="nt">nextauth_secret</span><span class="p">:</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="w">  </span><span class="nt">encryption_key</span><span class="p">:</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">  </span><span class="nt">plex_client_id</span><span class="p">:</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13"></a><span class="w">  </span><span class="nt">plex_client_secret</span><span class="p">:</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="w">  </span><span class="nt">postgres_password</span><span class="p">:</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-17"><a id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="w">  </span><span class="nt">redis_password</span><span class="p">:</span>
</span><span id="__span-20-18"><a id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-19"><a id="__codelineno-20-19" name="__codelineno-20-19"></a>
</span><span id="__span-20-20"><a id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="nt">services</span><span class="p">:</span>
</span><span id="__span-20-21"><a id="__codelineno-20-21" name="__codelineno-20-21"></a><span class="w">  </span><span class="nt">backend</span><span class="p">:</span>
</span><span id="__span-20-22"><a id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
</span><span id="__span-20-23"><a id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">database_url</span>
</span><span id="__span-20-24"><a id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jwt_secret</span>
</span><span id="__span-20-25"><a id="__codelineno-20-25" name="__codelineno-20-25"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nextauth_secret</span>
</span><span id="__span-20-26"><a id="__codelineno-20-26" name="__codelineno-20-26"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">encryption_key</span>
</span><span id="__span-20-27"><a id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">plex_client_id</span>
</span><span id="__span-20-28"><a id="__codelineno-20-28" name="__codelineno-20-28"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">plex_client_secret</span>
</span><span id="__span-20-29"><a id="__codelineno-20-29" name="__codelineno-20-29"></a><span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
</span><span id="__span-20-30"><a id="__codelineno-20-30" name="__codelineno-20-30"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_DOCKER_SECRETS=true</span>
</span><span id="__span-20-31"><a id="__codelineno-20-31" name="__codelineno-20-31"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DATABASE_URL_FILE=/run/secrets/database_url</span>
</span><span id="__span-20-32"><a id="__codelineno-20-32" name="__codelineno-20-32"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">JWT_SECRET_FILE=/run/secrets/jwt_secret</span>
</span><span id="__span-20-33"><a id="__codelineno-20-33" name="__codelineno-20-33"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NEXTAUTH_SECRET_FILE=/run/secrets/nextauth_secret</span>
</span><span id="__span-20-34"><a id="__codelineno-20-34" name="__codelineno-20-34"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ENCRYPTION_KEY_FILE=/run/secrets/encryption_key</span>
</span><span id="__span-20-35"><a id="__codelineno-20-35" name="__codelineno-20-35"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PLEX_CLIENT_ID_FILE=/run/secrets/plex_client_id</span>
</span><span id="__span-20-36"><a id="__codelineno-20-36" name="__codelineno-20-36"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PLEX_CLIENT_SECRET_FILE=/run/secrets/plex_client_secret</span>
</span></code></pre></div></td></tr></table></div><h3 id="environment-security-checklist">Environment Security Checklist<a class="headerlink" href="#environment-security-checklist" title="Permanent link">&para;</a></h3><h4 id="development-environment">Development Environment<a class="headerlink" href="#development-environment" title="Permanent link">&para;</a></h4><ul class="task-list"><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use development-specific secrets (never production secrets)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable debug logging (<code>LOG_LEVEL=debug</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use local development domains (<code>localhost</code>, <code>*.local</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Disable SSL requirements (<code>DB_SSL=false</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use Docker internal networking</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Keep development secrets in <code>.env.local</code> (gitignored)</li></ul><h4 id="staging-environment">Staging Environment<a class="headerlink" href="#staging-environment" title="Permanent link">&para;</a></h4><ul class="task-list"><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use staging-specific secrets</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Test production-like security settings</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable SSL/TLS (<code>DB_SSL=true</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use staging domains</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Test Docker secrets integration</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Validate secret rotation procedures</li></ul><h4 id="production-environment">Production Environment<a class="headerlink" href="#production-environment" title="Permanent link">&para;</a></h4><ul class="task-list"><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Generate cryptographically secure secrets</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use Docker secrets or external secret management</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable all security headers</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use HTTPS everywhere (<code>NEXTAUTH_URL=https://...</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable strict cookie settings (<code>SESSION_SECURE=true</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Set production logging levels (<code>LOG_LEVEL=warn</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable error reporting (<code>ERROR_REPORTING_ENABLED=true</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Configure rate limiting</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Use production-grade database credentials</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable database SSL (<code>DB_SSL=true</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Set strong BCrypt rounds (<code>BCRYPT_ROUNDS=14</code>)</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Configure proper CORS origins</li><li class="task-list-item"><label class="task-list-control"><input type="checkbox"><span class="task-list-indicator"></span></label> Enable security monitoring</li></ul><h3 id="secret-rotation-procedures">Secret Rotation Procedures<a class="headerlink" href="#secret-rotation-procedures" title="Permanent link">&para;</a></h3><h4 id="1-jwt-secret-rotation">1. JWT Secret Rotation<a class="headerlink" href="#1-jwt-secret-rotation" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-21-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-21-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-21-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-21-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-21-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-21-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-21-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-21-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-21-10">10</a></span>
<span class="normal"><a href="#__codelineno-21-11">11</a></span>
<span class="normal"><a href="#__codelineno-21-12">12</a></span>
<span class="normal"><a href="#__codelineno-21-13">13</a></span>
<span class="normal"><a href="#__codelineno-21-14">14</a></span>
<span class="normal"><a href="#__codelineno-21-15">15</a></span>
<span class="normal"><a href="#__codelineno-21-16">16</a></span>
<span class="normal"><a href="#__codelineno-21-17">17</a></span>
<span class="normal"><a href="#__codelineno-21-18">18</a></span>
<span class="normal"><a href="#__codelineno-21-19">19</a></span>
<span class="normal"><a href="#__codelineno-21-20">20</a></span>
<span class="normal"><a href="#__codelineno-21-21">21</a></span>
<span class="normal"><a href="#__codelineno-21-22">22</a></span>
<span class="normal"><a href="#__codelineno-21-23">23</a></span>
<span class="normal"><a href="#__codelineno-21-24">24</a></span>
<span class="normal"><a href="#__codelineno-21-25">25</a></span>
<span class="normal"><a href="#__codelineno-21-26">26</a></span>
<span class="normal"><a href="#__codelineno-21-27">27</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="c1"># rotate-jwt-secret.sh</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3"></a>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="nv">OLD_SECRET</span><span class="o">=</span><span class="nv">$JWT_SECRET</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="nv">NEW_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🔄 Rotating JWT Secret&quot;</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Old secret: </span><span class="si">${</span><span class="nv">OLD_SECRET</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">8</span><span class="si">}</span><span class="s2">...&quot;</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;New secret: </span><span class="si">${</span><span class="nv">NEW_SECRET</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">8</span><span class="si">}</span><span class="s2">...&quot;</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11"></a><span class="c1"># Update environment</span>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/JWT_SECRET=.*/JWT_SECRET=</span><span class="nv">$NEW_SECRET</span><span class="s2">/&quot;</span><span class="w"> </span>docker-environment.env
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13"></a>
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14"></a><span class="c1"># Restart backend services</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15"></a>docker-compose<span class="w"> </span>restart<span class="w"> </span>backend
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16"></a>
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="c1"># Wait for health check</span>
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18"></a>sleep<span class="w"> </span><span class="m">10</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19"></a>
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="c1"># Verify new secret is working</span>
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="k">if</span><span class="w"> </span>curl<span class="w"> </span>-s<span class="w"> </span>http://localhost:4000/health<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-q<span class="w"> </span><span class="s2">&quot;ok&quot;</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ JWT secret rotation successful&quot;</span>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="k">else</span>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ JWT secret rotation failed, rolling back&quot;</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25"></a><span class="w">  </span>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s/JWT_SECRET=.*/JWT_SECRET=</span><span class="nv">$OLD_SECRET</span><span class="s2">/&quot;</span><span class="w"> </span>docker-environment.env
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26"></a><span class="w">  </span>docker-compose<span class="w"> </span>restart<span class="w"> </span>backend
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27"></a><span class="k">fi</span>
</span></code></pre></div></td></tr></table></div><h4 id="2-database-password-rotation">2. Database Password Rotation<a class="headerlink" href="#2-database-password-rotation" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-22-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-22-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-22-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-22-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-22-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-22-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-22-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-22-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-22-10">10</a></span>
<span class="normal"><a href="#__codelineno-22-11">11</a></span>
<span class="normal"><a href="#__codelineno-22-12">12</a></span>
<span class="normal"><a href="#__codelineno-22-13">13</a></span>
<span class="normal"><a href="#__codelineno-22-14">14</a></span>
<span class="normal"><a href="#__codelineno-22-15">15</a></span>
<span class="normal"><a href="#__codelineno-22-16">16</a></span>
<span class="normal"><a href="#__codelineno-22-17">17</a></span>
<span class="normal"><a href="#__codelineno-22-18">18</a></span>
<span class="normal"><a href="#__codelineno-22-19">19</a></span>
<span class="normal"><a href="#__codelineno-22-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="c1"># rotate-database-password.sh</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3"></a>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="nv">NEW_PASSWORD</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-base64<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tr<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;=+/&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-c1-20<span class="k">)</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5"></a>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🔄 Rotating Database Password&quot;</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7"></a>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="c1"># Update password in database</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>medianest_postgres_1<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;ALTER USER medianest PASSWORD &#39;</span><span class="nv">$NEW_PASSWORD</span><span class="s2">&#39;;&quot;</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10"></a>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="c1"># Update environment</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="nv">OLD_URL</span><span class="o">=</span><span class="nv">$DATABASE_URL</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="nv">NEW_URL</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="nv">$DATABASE_URL</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s2">&quot;s/:.*@/:</span><span class="nv">$NEW_PASSWORD</span><span class="s2">@/&quot;</span><span class="k">)</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14"></a>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15"></a>sed<span class="w"> </span>-i<span class="w"> </span><span class="s2">&quot;s|DATABASE_URL=.*|DATABASE_URL=</span><span class="nv">$NEW_URL</span><span class="s2">|&quot;</span><span class="w"> </span>docker-environment.env
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16"></a>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17"></a><span class="c1"># Restart services</span>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18"></a>docker-compose<span class="w"> </span>restart<span class="w"> </span>backend
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19"></a>
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Database password rotation complete&quot;</span>
</span></code></pre></div></td></tr></table></div><h3 id="security-headers-configuration">Security Headers Configuration<a class="headerlink" href="#security-headers-configuration" title="Permanent link">&para;</a></h3><h4 id="backend-security-headers">Backend Security Headers<a class="headerlink" href="#backend-security-headers" title="Permanent link">&para;</a></h4><div class="language-typescript highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">TypeScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-23-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-23-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-23-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-23-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-23-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-23-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-23-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-23-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-23-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="c1">// backend/src/middleware/security.ts</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">securityHeaders</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="w">  </span><span class="s1">&#39;X-Frame-Options&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;DENY&#39;</span><span class="p">,</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4"></a><span class="w">  </span><span class="s1">&#39;X-Content-Type-Options&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;nosniff&#39;</span><span class="p">,</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="w">  </span><span class="s1">&#39;X-XSS-Protection&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;1; mode=block&#39;</span><span class="p">,</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">  </span><span class="s1">&#39;Referrer-Policy&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;strict-origin-when-cross-origin&#39;</span><span class="p">,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="w">  </span><span class="s1">&#39;Permissions-Policy&#39;</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;geolocation=(), microphone=(), camera=()&#39;</span><span class="p">,</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="w">  </span><span class="s1">&#39;Strict-Transport-Security&#39;</span><span class="o">:</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="w">    </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;production&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s1">&#39;max-age=31536000; includeSubDomains&#39;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">undefined</span><span class="p">,</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="p">};</span>
</span></code></pre></div></td></tr></table></div><h4 id="cors-security-configuration">CORS Security Configuration<a class="headerlink" href="#cors-security-configuration" title="Permanent link">&para;</a></h4><div class="language-typescript highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">TypeScript</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="c1">// backend/src/config/cors.ts</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="k">export</span><span class="w"> </span><span class="kd">const</span><span class="w"> </span><span class="nx">corsConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">  </span><span class="nx">origin</span><span class="o">:</span><span class="w"> </span><span class="kt">process.env.CORS_ORIGIN?.split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;http://localhost:3000&#39;</span><span class="p">,</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">  </span><span class="nx">credentials</span><span class="o">:</span><span class="w"> </span><span class="kt">process.env.CORS_CREDENTIALS</span><span class="w"> </span><span class="o">!==</span><span class="w"> </span><span class="s1">&#39;false&#39;</span><span class="p">,</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">  </span><span class="nx">optionsSuccessStatus</span><span class="o">:</span><span class="w"> </span><span class="kt">200</span><span class="p">,</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="w">  </span><span class="nx">methods</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DELETE&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;OPTIONS&#39;</span><span class="p">],</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="w">  </span><span class="nx">allowedHeaders</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="w">    </span><span class="s1">&#39;Origin&#39;</span><span class="p">,</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9"></a><span class="w">    </span><span class="s1">&#39;X-Requested-With&#39;</span><span class="p">,</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="w">    </span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="w">    </span><span class="s1">&#39;Accept&#39;</span><span class="p">,</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="w">    </span><span class="s1">&#39;Authorization&#39;</span><span class="p">,</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="w">    </span><span class="s1">&#39;X-CSRF-Token&#39;</span><span class="p">,</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15"></a><span class="p">};</span>
</span></code></pre></div></td></tr></table></div><hr><h2 id="troubleshooting-guide">Troubleshooting Guide<a class="headerlink" href="#troubleshooting-guide" title="Permanent link">&para;</a></h2><h3 id="common-configuration-errors">Common Configuration Errors<a class="headerlink" href="#common-configuration-errors" title="Permanent link">&para;</a></h3><h4 id="1-database-connection-issues">1. Database Connection Issues<a class="headerlink" href="#1-database-connection-issues" title="Permanent link">&para;</a></h4><p><strong>Error: <code>connection to server at "localhost" (127.0.0.1), port 5432 failed</code></strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1">1</a></span>
<span class="normal"><a href="#__codelineno-25-2">2</a></span>
<span class="normal"><a href="#__codelineno-25-3">3</a></span>
<span class="normal"><a href="#__codelineno-25-4">4</a></span>
<span class="normal"><a href="#__codelineno-25-5">5</a></span>
<span class="normal"><a href="#__codelineno-25-6">6</a></span>
<span class="normal"><a href="#__codelineno-25-7">7</a></span>
<span class="normal"><a href="#__codelineno-25-8">8</a></span>
<span class="normal"><a href="#__codelineno-25-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="c1"># Check if PostgreSQL is running</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2"></a>docker-compose<span class="w"> </span>ps<span class="w"> </span>postgres
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="c1"># Test connection manually</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5"></a>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;SELECT 1;&quot;</span>
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6"></a>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7"></a><span class="c1"># Check connection string format</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="nb">echo</span><span class="w"> </span><span class="nv">$DATABASE_URL</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="c1"># Should be: postgresql://user:password@host:port/database</span>
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-26-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-26-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-26-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-26-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-26-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-26-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-26-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-26-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-26-10">10</a></span>
<span class="normal"><a href="#__codelineno-26-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="c1"># Fix 1: Ensure PostgreSQL is running</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.dev.yml<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>postgres
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="c1"># Fix 2: Check connection string format</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="nv">DATABASE_URL</span><span class="o">=</span><span class="s2">&quot;postgresql://medianest:medianest_dev_password@postgres:5432/medianest_dev&quot;</span>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="c1"># Fix 3: Use localhost for local development</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8"></a><span class="nv">DATABASE_URL</span><span class="o">=</span><span class="s2">&quot;postgresql://medianest:medianest_dev_password@localhost:5432/medianest_dev&quot;</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9"></a>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="c1"># Fix 4: Check database initialization</span>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11"></a>docker-compose<span class="w"> </span>logs<span class="w"> </span>postgres
</span></code></pre></div></td></tr></table></div><h4 id="2-redis-connection-failures">2. Redis Connection Failures<a class="headerlink" href="#2-redis-connection-failures" title="Permanent link">&para;</a></h4><p><strong>Error: <code>Redis connection failed: connect ECONNREFUSED 127.0.0.1:6379</code></strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span>
<span class="normal"><a href="#__codelineno-27-3">3</a></span>
<span class="normal"><a href="#__codelineno-27-4">4</a></span>
<span class="normal"><a href="#__codelineno-27-5">5</a></span>
<span class="normal"><a href="#__codelineno-27-6">6</a></span>
<span class="normal"><a href="#__codelineno-27-7">7</a></span>
<span class="normal"><a href="#__codelineno-27-8">8</a></span>
<span class="normal"><a href="#__codelineno-27-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="c1"># Check Redis status</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2"></a>docker-compose<span class="w"> </span>ps<span class="w"> </span>redis
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3"></a>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="c1"># Test Redis connection</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5"></a>redis-cli<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-p<span class="w"> </span><span class="m">6379</span><span class="w"> </span>ping
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6"></a>
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="c1"># Verify Redis URL format</span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="nb">echo</span><span class="w"> </span><span class="nv">$REDIS_URL</span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9"></a><span class="c1"># Should be: redis://localhost:6379 or redis://username:password@host:port</span>
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="c1"># Fix 1: Start Redis service</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2"></a>docker-compose<span class="w"> </span>-f<span class="w"> </span>config/docker/docker-compose.dev.yml<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>redis
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3"></a>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4"></a><span class="c1"># Fix 2: Correct Redis URL format</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5"></a><span class="nv">REDIS_URL</span><span class="o">=</span><span class="s2">&quot;redis://localhost:6379&quot;</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6"></a>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7"></a><span class="c1"># Fix 3: With authentication</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8"></a><span class="nv">REDIS_URL</span><span class="o">=</span><span class="s2">&quot;redis://:password@localhost:6379&quot;</span>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9"></a>
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10"></a><span class="c1"># Fix 4: Check Redis logs</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11"></a>docker-compose<span class="w"> </span>logs<span class="w"> </span>redis
</span></code></pre></div></td></tr></table></div><h4 id="3-jwt-secret-validation-errors">3. JWT Secret Validation Errors<a class="headerlink" href="#3-jwt-secret-validation-errors" title="Permanent link">&para;</a></h4><p><strong>Error: <code>JWT_SECRET must be at least 32 characters long</code></strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span>
<span class="normal"><a href="#__codelineno-29-3">3</a></span>
<span class="normal"><a href="#__codelineno-29-4">4</a></span>
<span class="normal"><a href="#__codelineno-29-5">5</a></span>
<span class="normal"><a href="#__codelineno-29-6">6</a></span>
<span class="normal"><a href="#__codelineno-29-7">7</a></span>
<span class="normal"><a href="#__codelineno-29-8">8</a></span>
<span class="normal"><a href="#__codelineno-29-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1"></a><span class="c1"># Check secret length</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;JWT_SECRET length: </span><span class="si">${#</span><span class="nv">JWT_SECRET</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3"></a>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4"></a><span class="c1"># Check if secret is set</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JWT_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-29-6"><a id="__codelineno-29-6" name="__codelineno-29-6"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;JWT_SECRET is not set&quot;</span>
</span><span id="__span-29-7"><a id="__codelineno-29-7" name="__codelineno-29-7"></a><span class="k">else</span>
</span><span id="__span-29-8"><a id="__codelineno-29-8" name="__codelineno-29-8"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;JWT_SECRET is set (</span><span class="si">${#</span><span class="nv">JWT_SECRET</span><span class="si">}</span><span class="s2"> characters)&quot;</span>
</span><span id="__span-29-9"><a id="__codelineno-29-9" name="__codelineno-29-9"></a><span class="k">fi</span>
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="c1"># Generate proper JWT secret</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2"></a><span class="nv">JWT_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;JWT_SECRET=</span><span class="nv">$JWT_SECRET</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>docker-environment.env
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4"></a>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5"></a><span class="c1"># Or use a specific 32+ character string</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6"></a><span class="nv">JWT_SECRET</span><span class="o">=</span><span class="s2">&quot;your-super-secure-jwt-secret-that-is-at-least-32-characters-long&quot;</span>
</span></code></pre></div></td></tr></table></div><h4 id="4-nextauth-configuration-issues">4. NextAuth Configuration Issues<a class="headerlink" href="#4-nextauth-configuration-issues" title="Permanent link">&para;</a></h4><p><strong>Error: <code>NEXTAUTH_URL mismatch</code> or <code>NEXTAUTH_SECRET missing</code></strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1"></a><span class="c1"># Check NextAuth variables</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NEXTAUTH_URL: </span><span class="nv">$NEXTAUTH_URL</span><span class="s2">&quot;</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NEXTAUTH_SECRET length: </span><span class="si">${#</span><span class="nv">NEXTAUTH_SECRET</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;FRONTEND_URL: </span><span class="nv">$FRONTEND_URL</span><span class="s2">&quot;</span>
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span>
<span class="normal"><a href="#__codelineno-32-6">6</a></span>
<span class="normal"><a href="#__codelineno-32-7">7</a></span>
<span class="normal"><a href="#__codelineno-32-8">8</a></span>
<span class="normal"><a href="#__codelineno-32-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="c1"># Ensure URLs match</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="nv">NEXTAUTH_URL</span><span class="o">=</span><span class="s2">&quot;http://localhost:3000&quot;</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="nv">FRONTEND_URL</span><span class="o">=</span><span class="s2">&quot;http://localhost:3000&quot;</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4"></a>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="c1"># Generate NextAuth secret</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6"></a><span class="nv">NEXTAUTH_SECRET</span><span class="o">=</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7"></a>
</span><span id="__span-32-8"><a id="__codelineno-32-8" name="__codelineno-32-8"></a><span class="c1"># Production URLs must use HTTPS</span>
</span><span id="__span-32-9"><a id="__codelineno-32-9" name="__codelineno-32-9"></a><span class="nv">NEXTAUTH_URL</span><span class="o">=</span><span class="s2">&quot;https://yourdomain.com&quot;</span>
</span></code></pre></div></td></tr></table></div><h3 id="environment-variable-validation">Environment Variable Validation<a class="headerlink" href="#environment-variable-validation" title="Permanent link">&para;</a></h3><h4 id="comprehensive-validation-script">Comprehensive Validation Script<a class="headerlink" href="#comprehensive-validation-script" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">  1</a></span>
<span class="normal"><a href="#__codelineno-33-2">  2</a></span>
<span class="normal"><a href="#__codelineno-33-3">  3</a></span>
<span class="normal"><a href="#__codelineno-33-4">  4</a></span>
<span class="normal"><a href="#__codelineno-33-5">  5</a></span>
<span class="normal"><a href="#__codelineno-33-6">  6</a></span>
<span class="normal"><a href="#__codelineno-33-7">  7</a></span>
<span class="normal"><a href="#__codelineno-33-8">  8</a></span>
<span class="normal"><a href="#__codelineno-33-9">  9</a></span>
<span class="normal"><a href="#__codelineno-33-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-33-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-33-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-33-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-33-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-33-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-33-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-33-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-33-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-33-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-33-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-33-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-33-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-33-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-33-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-33-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-33-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-33-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-33-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-33-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-33-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-33-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-33-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-33-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-33-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-33-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-33-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-33-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-33-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-33-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-33-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-33-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-33-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-33-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-33-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-33-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-33-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-33-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-33-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-33-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-33-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-33-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-33-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-33-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-33-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-33-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-33-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-33-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-33-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-33-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-33-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-33-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-33-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-33-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-33-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-33-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-33-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-33-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-33-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-33-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-33-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-33-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-33-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-33-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-33-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-33-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-33-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-33-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-33-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-33-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-33-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-33-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-33-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-33-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-33-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-33-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-33-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-33-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-33-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-33-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-33-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-33-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-33-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-33-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-33-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-33-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-33-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-33-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-33-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-33-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-33-100">100</a></span>
<span class="normal"><a href="#__codelineno-33-101">101</a></span>
<span class="normal"><a href="#__codelineno-33-102">102</a></span>
<span class="normal"><a href="#__codelineno-33-103">103</a></span>
<span class="normal"><a href="#__codelineno-33-104">104</a></span>
<span class="normal"><a href="#__codelineno-33-105">105</a></span>
<span class="normal"><a href="#__codelineno-33-106">106</a></span>
<span class="normal"><a href="#__codelineno-33-107">107</a></span>
<span class="normal"><a href="#__codelineno-33-108">108</a></span>
<span class="normal"><a href="#__codelineno-33-109">109</a></span>
<span class="normal"><a href="#__codelineno-33-110">110</a></span>
<span class="normal"><a href="#__codelineno-33-111">111</a></span>
<span class="normal"><a href="#__codelineno-33-112">112</a></span>
<span class="normal"><a href="#__codelineno-33-113">113</a></span>
<span class="normal"><a href="#__codelineno-33-114">114</a></span>
<span class="normal"><a href="#__codelineno-33-115">115</a></span>
<span class="normal"><a href="#__codelineno-33-116">116</a></span>
<span class="normal"><a href="#__codelineno-33-117">117</a></span>
<span class="normal"><a href="#__codelineno-33-118">118</a></span>
<span class="normal"><a href="#__codelineno-33-119">119</a></span>
<span class="normal"><a href="#__codelineno-33-120">120</a></span>
<span class="normal"><a href="#__codelineno-33-121">121</a></span>
<span class="normal"><a href="#__codelineno-33-122">122</a></span>
<span class="normal"><a href="#__codelineno-33-123">123</a></span>
<span class="normal"><a href="#__codelineno-33-124">124</a></span>
<span class="normal"><a href="#__codelineno-33-125">125</a></span>
<span class="normal"><a href="#__codelineno-33-126">126</a></span>
<span class="normal"><a href="#__codelineno-33-127">127</a></span>
<span class="normal"><a href="#__codelineno-33-128">128</a></span>
<span class="normal"><a href="#__codelineno-33-129">129</a></span>
<span class="normal"><a href="#__codelineno-33-130">130</a></span>
<span class="normal"><a href="#__codelineno-33-131">131</a></span>
<span class="normal"><a href="#__codelineno-33-132">132</a></span>
<span class="normal"><a href="#__codelineno-33-133">133</a></span>
<span class="normal"><a href="#__codelineno-33-134">134</a></span>
<span class="normal"><a href="#__codelineno-33-135">135</a></span>
<span class="normal"><a href="#__codelineno-33-136">136</a></span>
<span class="normal"><a href="#__codelineno-33-137">137</a></span>
<span class="normal"><a href="#__codelineno-33-138">138</a></span>
<span class="normal"><a href="#__codelineno-33-139">139</a></span>
<span class="normal"><a href="#__codelineno-33-140">140</a></span>
<span class="normal"><a href="#__codelineno-33-141">141</a></span>
<span class="normal"><a href="#__codelineno-33-142">142</a></span>
<span class="normal"><a href="#__codelineno-33-143">143</a></span>
<span class="normal"><a href="#__codelineno-33-144">144</a></span>
<span class="normal"><a href="#__codelineno-33-145">145</a></span>
<span class="normal"><a href="#__codelineno-33-146">146</a></span>
<span class="normal"><a href="#__codelineno-33-147">147</a></span>
<span class="normal"><a href="#__codelineno-33-148">148</a></span>
<span class="normal"><a href="#__codelineno-33-149">149</a></span>
<span class="normal"><a href="#__codelineno-33-150">150</a></span>
<span class="normal"><a href="#__codelineno-33-151">151</a></span>
<span class="normal"><a href="#__codelineno-33-152">152</a></span>
<span class="normal"><a href="#__codelineno-33-153">153</a></span>
<span class="normal"><a href="#__codelineno-33-154">154</a></span>
<span class="normal"><a href="#__codelineno-33-155">155</a></span>
<span class="normal"><a href="#__codelineno-33-156">156</a></span>
<span class="normal"><a href="#__codelineno-33-157">157</a></span>
<span class="normal"><a href="#__codelineno-33-158">158</a></span>
<span class="normal"><a href="#__codelineno-33-159">159</a></span>
<span class="normal"><a href="#__codelineno-33-160">160</a></span>
<span class="normal"><a href="#__codelineno-33-161">161</a></span>
<span class="normal"><a href="#__codelineno-33-162">162</a></span>
<span class="normal"><a href="#__codelineno-33-163">163</a></span>
<span class="normal"><a href="#__codelineno-33-164">164</a></span>
<span class="normal"><a href="#__codelineno-33-165">165</a></span>
<span class="normal"><a href="#__codelineno-33-166">166</a></span>
<span class="normal"><a href="#__codelineno-33-167">167</a></span>
<span class="normal"><a href="#__codelineno-33-168">168</a></span>
<span class="normal"><a href="#__codelineno-33-169">169</a></span>
<span class="normal"><a href="#__codelineno-33-170">170</a></span>
<span class="normal"><a href="#__codelineno-33-171">171</a></span>
<span class="normal"><a href="#__codelineno-33-172">172</a></span>
<span class="normal"><a href="#__codelineno-33-173">173</a></span>
<span class="normal"><a href="#__codelineno-33-174">174</a></span>
<span class="normal"><a href="#__codelineno-33-175">175</a></span>
<span class="normal"><a href="#__codelineno-33-176">176</a></span>
<span class="normal"><a href="#__codelineno-33-177">177</a></span>
<span class="normal"><a href="#__codelineno-33-178">178</a></span>
<span class="normal"><a href="#__codelineno-33-179">179</a></span>
<span class="normal"><a href="#__codelineno-33-180">180</a></span>
<span class="normal"><a href="#__codelineno-33-181">181</a></span>
<span class="normal"><a href="#__codelineno-33-182">182</a></span>
<span class="normal"><a href="#__codelineno-33-183">183</a></span>
<span class="normal"><a href="#__codelineno-33-184">184</a></span>
<span class="normal"><a href="#__codelineno-33-185">185</a></span>
<span class="normal"><a href="#__codelineno-33-186">186</a></span>
<span class="normal"><a href="#__codelineno-33-187">187</a></span>
<span class="normal"><a href="#__codelineno-33-188">188</a></span>
<span class="normal"><a href="#__codelineno-33-189">189</a></span>
<span class="normal"><a href="#__codelineno-33-190">190</a></span>
<span class="normal"><a href="#__codelineno-33-191">191</a></span>
<span class="normal"><a href="#__codelineno-33-192">192</a></span>
<span class="normal"><a href="#__codelineno-33-193">193</a></span>
<span class="normal"><a href="#__codelineno-33-194">194</a></span>
<span class="normal"><a href="#__codelineno-33-195">195</a></span>
<span class="normal"><a href="#__codelineno-33-196">196</a></span>
<span class="normal"><a href="#__codelineno-33-197">197</a></span>
<span class="normal"><a href="#__codelineno-33-198">198</a></span>
<span class="normal"><a href="#__codelineno-33-199">199</a></span>
<span class="normal"><a href="#__codelineno-33-200">200</a></span>
<span class="normal"><a href="#__codelineno-33-201">201</a></span>
<span class="normal"><a href="#__codelineno-33-202">202</a></span>
<span class="normal"><a href="#__codelineno-33-203">203</a></span>
<span class="normal"><a href="#__codelineno-33-204">204</a></span>
<span class="normal"><a href="#__codelineno-33-205">205</a></span>
<span class="normal"><a href="#__codelineno-33-206">206</a></span>
<span class="normal"><a href="#__codelineno-33-207">207</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="c1"># comprehensive-env-validation.sh</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3"></a>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="nb">set</span><span class="w"> </span>-euo<span class="w"> </span>pipefail
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5"></a>
</span><span id="__span-33-6"><a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="nv">RED</span><span class="o">=</span><span class="s1">&#39;\033[0;31m&#39;</span>
</span><span id="__span-33-7"><a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="nv">GREEN</span><span class="o">=</span><span class="s1">&#39;\033[0;32m&#39;</span>
</span><span id="__span-33-8"><a id="__codelineno-33-8" name="__codelineno-33-8"></a><span class="nv">YELLOW</span><span class="o">=</span><span class="s1">&#39;\033[1;33m&#39;</span>
</span><span id="__span-33-9"><a id="__codelineno-33-9" name="__codelineno-33-9"></a><span class="nv">NC</span><span class="o">=</span><span class="s1">&#39;\033[0m&#39;</span><span class="w"> </span><span class="c1"># No Color</span>
</span><span id="__span-33-10"><a id="__codelineno-33-10" name="__codelineno-33-10"></a>
</span><span id="__span-33-11"><a id="__codelineno-33-11" name="__codelineno-33-11"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">🔍 MediaNest Environment Validation</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-12"><a id="__codelineno-33-12" name="__codelineno-33-12"></a>
</span><span id="__span-33-13"><a id="__codelineno-33-13" name="__codelineno-33-13"></a><span class="c1"># Load environment file</span>
</span><span id="__span-33-14"><a id="__codelineno-33-14" name="__codelineno-33-14"></a><span class="nv">ENV_FILE</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">1</span><span class="k">:-</span><span class="nv">docker</span><span class="p">-environment.env</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-15"><a id="__codelineno-33-15" name="__codelineno-33-15"></a>
</span><span id="__span-33-16"><a id="__codelineno-33-16" name="__codelineno-33-16"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span>-f<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ENV_FILE</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-17"><a id="__codelineno-33-17" name="__codelineno-33-17"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ Environment file </span><span class="nv">$ENV_FILE</span><span class="s2"> not found</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-18"><a id="__codelineno-33-18" name="__codelineno-33-18"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-33-19"><a id="__codelineno-33-19" name="__codelineno-33-19"></a><span class="k">fi</span>
</span><span id="__span-33-20"><a id="__codelineno-33-20" name="__codelineno-33-20"></a>
</span><span id="__span-33-21"><a id="__codelineno-33-21" name="__codelineno-33-21"></a><span class="nb">set</span><span class="w"> </span>-a
</span><span id="__span-33-22"><a id="__codelineno-33-22" name="__codelineno-33-22"></a><span class="nb">source</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$ENV_FILE</span><span class="s2">&quot;</span>
</span><span id="__span-33-23"><a id="__codelineno-33-23" name="__codelineno-33-23"></a><span class="nb">set</span><span class="w"> </span>+a
</span><span id="__span-33-24"><a id="__codelineno-33-24" name="__codelineno-33-24"></a>
</span><span id="__span-33-25"><a id="__codelineno-33-25" name="__codelineno-33-25"></a><span class="nv">VALIDATION_ERRORS</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-33-26"><a id="__codelineno-33-26" name="__codelineno-33-26"></a>
</span><span id="__span-33-27"><a id="__codelineno-33-27" name="__codelineno-33-27"></a><span class="c1"># Helper function to validate variable</span>
</span><span id="__span-33-28"><a id="__codelineno-33-28" name="__codelineno-33-28"></a>validate_var<span class="o">()</span><span class="w"> </span><span class="o">{</span>
</span><span id="__span-33-29"><a id="__codelineno-33-29" name="__codelineno-33-29"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">var_name</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$1</span><span class="s2">&quot;</span>
</span><span id="__span-33-30"><a id="__codelineno-33-30" name="__codelineno-33-30"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">var_value</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="p">!var_name</span><span class="k">:-</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-31"><a id="__codelineno-33-31" name="__codelineno-33-31"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">required</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$2</span><span class="s2">&quot;</span>
</span><span id="__span-33-32"><a id="__codelineno-33-32" name="__codelineno-33-32"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">min_length</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">3</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-33"><a id="__codelineno-33-33" name="__codelineno-33-33"></a><span class="w">  </span><span class="nb">local</span><span class="w"> </span><span class="nv">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">4</span><span class="k">:-</span><span class="nv">any</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-34"><a id="__codelineno-33-34" name="__codelineno-33-34"></a>
</span><span id="__span-33-35"><a id="__codelineno-33-35" name="__codelineno-33-35"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$var_value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-36"><a id="__codelineno-33-36" name="__codelineno-33-36"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$required</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-37"><a id="__codelineno-33-37" name="__codelineno-33-37"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_name</span><span class="s2"> is required but not set</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-38"><a id="__codelineno-33-38" name="__codelineno-33-38"></a><span class="w">      </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-39"><a id="__codelineno-33-39" name="__codelineno-33-39"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-33-40"><a id="__codelineno-33-40" name="__codelineno-33-40"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">YELLOW</span><span class="si">}</span><span class="s2">⚠️  </span><span class="nv">$var_name</span><span class="s2"> is not set (optional)</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-41"><a id="__codelineno-33-41" name="__codelineno-33-41"></a><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-33-42"><a id="__codelineno-33-42" name="__codelineno-33-42"></a><span class="w">    </span><span class="k">return</span>
</span><span id="__span-33-43"><a id="__codelineno-33-43" name="__codelineno-33-43"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-44"><a id="__codelineno-33-44" name="__codelineno-33-44"></a>
</span><span id="__span-33-45"><a id="__codelineno-33-45" name="__codelineno-33-45"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">var_value</span><span class="si">}</span><span class="w"> </span>-lt<span class="w"> </span><span class="nv">$min_length</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-46"><a id="__codelineno-33-46" name="__codelineno-33-46"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_name</span><span class="s2"> is too short (</span><span class="si">${#</span><span class="nv">var_value</span><span class="si">}</span><span class="s2"> &lt; </span><span class="nv">$min_length</span><span class="s2">)</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-47"><a id="__codelineno-33-47" name="__codelineno-33-47"></a><span class="w">    </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-48"><a id="__codelineno-33-48" name="__codelineno-33-48"></a><span class="w">    </span><span class="k">return</span>
</span><span id="__span-33-49"><a id="__codelineno-33-49" name="__codelineno-33-49"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-50"><a id="__codelineno-33-50" name="__codelineno-33-50"></a>
</span><span id="__span-33-51"><a id="__codelineno-33-51" name="__codelineno-33-51"></a><span class="w">  </span><span class="k">case</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$format</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">in</span>
</span><span id="__span-33-52"><a id="__codelineno-33-52" name="__codelineno-33-52"></a><span class="w">    </span><span class="s2">&quot;url&quot;</span><span class="o">)</span>
</span><span id="__span-33-53"><a id="__codelineno-33-53" name="__codelineno-33-53"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$var_value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^https?://<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-54"><a id="__codelineno-33-54" name="__codelineno-33-54"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_name</span><span class="s2"> is not a valid URL</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-55"><a id="__codelineno-33-55" name="__codelineno-33-55"></a><span class="w">        </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-56"><a id="__codelineno-33-56" name="__codelineno-33-56"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-33-57"><a id="__codelineno-33-57" name="__codelineno-33-57"></a><span class="w">      </span><span class="k">fi</span>
</span><span id="__span-33-58"><a id="__codelineno-33-58" name="__codelineno-33-58"></a><span class="w">      </span><span class="p">;;</span>
</span><span id="__span-33-59"><a id="__codelineno-33-59" name="__codelineno-33-59"></a><span class="w">    </span><span class="s2">&quot;postgres&quot;</span><span class="o">)</span>
</span><span id="__span-33-60"><a id="__codelineno-33-60" name="__codelineno-33-60"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$var_value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^postgresql://<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-61"><a id="__codelineno-33-61" name="__codelineno-33-61"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_value</span><span class="s2"> is not a valid PostgreSQL URL</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-62"><a id="__codelineno-33-62" name="__codelineno-33-62"></a><span class="w">        </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-63"><a id="__codelineno-33-63" name="__codelineno-33-63"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-33-64"><a id="__codelineno-33-64" name="__codelineno-33-64"></a><span class="w">      </span><span class="k">fi</span>
</span><span id="__span-33-65"><a id="__codelineno-33-65" name="__codelineno-33-65"></a><span class="w">      </span><span class="p">;;</span>
</span><span id="__span-33-66"><a id="__codelineno-33-66" name="__codelineno-33-66"></a><span class="w">    </span><span class="s2">&quot;redis&quot;</span><span class="o">)</span>
</span><span id="__span-33-67"><a id="__codelineno-33-67" name="__codelineno-33-67"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$var_value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^redis://<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-68"><a id="__codelineno-33-68" name="__codelineno-33-68"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_value</span><span class="s2"> is not a valid Redis URL</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-69"><a id="__codelineno-33-69" name="__codelineno-33-69"></a><span class="w">        </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-70"><a id="__codelineno-33-70" name="__codelineno-33-70"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-33-71"><a id="__codelineno-33-71" name="__codelineno-33-71"></a><span class="w">      </span><span class="k">fi</span>
</span><span id="__span-33-72"><a id="__codelineno-33-72" name="__codelineno-33-72"></a><span class="w">      </span><span class="p">;;</span>
</span><span id="__span-33-73"><a id="__codelineno-33-73" name="__codelineno-33-73"></a><span class="w">    </span><span class="s2">&quot;email&quot;</span><span class="o">)</span>
</span><span id="__span-33-74"><a id="__codelineno-33-74" name="__codelineno-33-74"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$var_value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span>A-Za-z0-9._%+-<span class="o">]</span>+@<span class="o">[</span>A-Za-z0-9.-<span class="o">]</span>+<span class="se">\.</span><span class="o">[</span>A-Za-z<span class="o">]{</span><span class="m">2</span>,<span class="o">}</span>$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-75"><a id="__codelineno-33-75" name="__codelineno-33-75"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_name</span><span class="s2"> is not a valid email</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-76"><a id="__codelineno-33-76" name="__codelineno-33-76"></a><span class="w">        </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-77"><a id="__codelineno-33-77" name="__codelineno-33-77"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-33-78"><a id="__codelineno-33-78" name="__codelineno-33-78"></a><span class="w">      </span><span class="k">fi</span>
</span><span id="__span-33-79"><a id="__codelineno-33-79" name="__codelineno-33-79"></a><span class="w">      </span><span class="p">;;</span>
</span><span id="__span-33-80"><a id="__codelineno-33-80" name="__codelineno-33-80"></a><span class="w">    </span><span class="s2">&quot;number&quot;</span><span class="o">)</span>
</span><span id="__span-33-81"><a id="__codelineno-33-81" name="__codelineno-33-81"></a><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>!<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$var_value</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">=</span>~<span class="w"> </span>^<span class="o">[</span><span class="m">0</span>-9<span class="o">]</span>+$<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-82"><a id="__codelineno-33-82" name="__codelineno-33-82"></a><span class="w">        </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ </span><span class="nv">$var_name</span><span class="s2"> must be a number</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-83"><a id="__codelineno-33-83" name="__codelineno-33-83"></a><span class="w">        </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-84"><a id="__codelineno-33-84" name="__codelineno-33-84"></a><span class="w">        </span><span class="k">return</span>
</span><span id="__span-33-85"><a id="__codelineno-33-85" name="__codelineno-33-85"></a><span class="w">      </span><span class="k">fi</span>
</span><span id="__span-33-86"><a id="__codelineno-33-86" name="__codelineno-33-86"></a><span class="w">      </span><span class="p">;;</span>
</span><span id="__span-33-87"><a id="__codelineno-33-87" name="__codelineno-33-87"></a><span class="w">  </span><span class="k">esac</span>
</span><span id="__span-33-88"><a id="__codelineno-33-88" name="__codelineno-33-88"></a>
</span><span id="__span-33-89"><a id="__codelineno-33-89" name="__codelineno-33-89"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">✅ </span><span class="nv">$var_name</span><span class="s2"> is valid</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-90"><a id="__codelineno-33-90" name="__codelineno-33-90"></a><span class="o">}</span>
</span><span id="__span-33-91"><a id="__codelineno-33-91" name="__codelineno-33-91"></a>
</span><span id="__span-33-92"><a id="__codelineno-33-92" name="__codelineno-33-92"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">📋 Validating Required Variables</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-93"><a id="__codelineno-33-93" name="__codelineno-33-93"></a>
</span><span id="__span-33-94"><a id="__codelineno-33-94" name="__codelineno-33-94"></a><span class="c1"># Core required variables</span>
</span><span id="__span-33-95"><a id="__codelineno-33-95" name="__codelineno-33-95"></a>validate_var<span class="w"> </span><span class="s2">&quot;NODE_ENV&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-96"><a id="__codelineno-33-96" name="__codelineno-33-96"></a>validate_var<span class="w"> </span><span class="s2">&quot;DATABASE_URL&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="s2">&quot;postgres&quot;</span>
</span><span id="__span-33-97"><a id="__codelineno-33-97" name="__codelineno-33-97"></a>validate_var<span class="w"> </span><span class="s2">&quot;REDIS_URL&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="s2">&quot;redis&quot;</span>
</span><span id="__span-33-98"><a id="__codelineno-33-98" name="__codelineno-33-98"></a>validate_var<span class="w"> </span><span class="s2">&quot;JWT_SECRET&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-99"><a id="__codelineno-33-99" name="__codelineno-33-99"></a>validate_var<span class="w"> </span><span class="s2">&quot;NEXTAUTH_SECRET&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-100"><a id="__codelineno-33-100" name="__codelineno-33-100"></a>validate_var<span class="w"> </span><span class="s2">&quot;ENCRYPTION_KEY&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-101"><a id="__codelineno-33-101" name="__codelineno-33-101"></a>validate_var<span class="w"> </span><span class="s2">&quot;FRONTEND_URL&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="s2">&quot;url&quot;</span>
</span><span id="__span-33-102"><a id="__codelineno-33-102" name="__codelineno-33-102"></a>
</span><span id="__span-33-103"><a id="__codelineno-33-103" name="__codelineno-33-103"></a><span class="c1"># Plex OAuth (required for auth)</span>
</span><span id="__span-33-104"><a id="__codelineno-33-104" name="__codelineno-33-104"></a>validate_var<span class="w"> </span><span class="s2">&quot;PLEX_CLIENT_ID&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-105"><a id="__codelineno-33-105" name="__codelineno-33-105"></a>validate_var<span class="w"> </span><span class="s2">&quot;PLEX_CLIENT_SECRET&quot;</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-106"><a id="__codelineno-33-106" name="__codelineno-33-106"></a>
</span><span id="__span-33-107"><a id="__codelineno-33-107" name="__codelineno-33-107"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">🔧 Validating Optional Variables</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-108"><a id="__codelineno-33-108" name="__codelineno-33-108"></a>
</span><span id="__span-33-109"><a id="__codelineno-33-109" name="__codelineno-33-109"></a><span class="c1"># Optional but recommended</span>
</span><span id="__span-33-110"><a id="__codelineno-33-110" name="__codelineno-33-110"></a>validate_var<span class="w"> </span><span class="s2">&quot;NEXTAUTH_URL&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="s2">&quot;url&quot;</span>
</span><span id="__span-33-111"><a id="__codelineno-33-111" name="__codelineno-33-111"></a>validate_var<span class="w"> </span><span class="s2">&quot;NEXT_PUBLIC_API_URL&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="s2">&quot;url&quot;</span>
</span><span id="__span-33-112"><a id="__codelineno-33-112" name="__codelineno-33-112"></a>validate_var<span class="w"> </span><span class="s2">&quot;CORS_ORIGIN&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="s2">&quot;url&quot;</span>
</span><span id="__span-33-113"><a id="__codelineno-33-113" name="__codelineno-33-113"></a>validate_var<span class="w"> </span><span class="s2">&quot;LOG_LEVEL&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-114"><a id="__codelineno-33-114" name="__codelineno-33-114"></a>
</span><span id="__span-33-115"><a id="__codelineno-33-115" name="__codelineno-33-115"></a><span class="c1"># Email configuration</span>
</span><span id="__span-33-116"><a id="__codelineno-33-116" name="__codelineno-33-116"></a>validate_var<span class="w"> </span><span class="s2">&quot;EMAIL_FROM&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="s2">&quot;email&quot;</span>
</span><span id="__span-33-117"><a id="__codelineno-33-117" name="__codelineno-33-117"></a>validate_var<span class="w"> </span><span class="s2">&quot;SMTP_HOST&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;any&quot;</span>
</span><span id="__span-33-118"><a id="__codelineno-33-118" name="__codelineno-33-118"></a>validate_var<span class="w"> </span><span class="s2">&quot;SMTP_PORT&quot;</span><span class="w"> </span><span class="nb">false</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;number&quot;</span>
</span><span id="__span-33-119"><a id="__codelineno-33-119" name="__codelineno-33-119"></a>
</span><span id="__span-33-120"><a id="__codelineno-33-120" name="__codelineno-33-120"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">🧪 Testing Connections</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-121"><a id="__codelineno-33-121" name="__codelineno-33-121"></a>
</span><span id="__span-33-122"><a id="__codelineno-33-122" name="__codelineno-33-122"></a><span class="c1"># Test database connection</span>
</span><span id="__span-33-123"><a id="__codelineno-33-123" name="__codelineno-33-123"></a><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>psql<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-124"><a id="__codelineno-33-124" name="__codelineno-33-124"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span>timeout<span class="w"> </span><span class="m">10</span><span class="w"> </span>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;SELECT 1;&quot;</span><span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-125"><a id="__codelineno-33-125" name="__codelineno-33-125"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">✅ Database connection successful</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-126"><a id="__codelineno-33-126" name="__codelineno-33-126"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-33-127"><a id="__codelineno-33-127" name="__codelineno-33-127"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ Database connection failed</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-128"><a id="__codelineno-33-128" name="__codelineno-33-128"></a><span class="w">    </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-129"><a id="__codelineno-33-129" name="__codelineno-33-129"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-130"><a id="__codelineno-33-130" name="__codelineno-33-130"></a><span class="k">else</span>
</span><span id="__span-33-131"><a id="__codelineno-33-131" name="__codelineno-33-131"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">YELLOW</span><span class="si">}</span><span class="s2">⚠️  psql not available, skipping database test</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-132"><a id="__codelineno-33-132" name="__codelineno-33-132"></a><span class="k">fi</span>
</span><span id="__span-33-133"><a id="__codelineno-33-133" name="__codelineno-33-133"></a>
</span><span id="__span-33-134"><a id="__codelineno-33-134" name="__codelineno-33-134"></a><span class="c1"># Test Redis connection</span>
</span><span id="__span-33-135"><a id="__codelineno-33-135" name="__codelineno-33-135"></a><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>redis-cli<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-136"><a id="__codelineno-33-136" name="__codelineno-33-136"></a><span class="w">  </span><span class="c1"># Parse Redis URL</span>
</span><span id="__span-33-137"><a id="__codelineno-33-137" name="__codelineno-33-137"></a><span class="w">  </span><span class="nv">REDIS_HOST</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/.*@\([^:]*\).*/\1/p&#39;</span><span class="k">)</span>
</span><span id="__span-33-138"><a id="__codelineno-33-138" name="__codelineno-33-138"></a><span class="w">  </span><span class="nv">REDIS_PORT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/.*:\([0-9]*\).*/\1/p&#39;</span><span class="k">)</span>
</span><span id="__span-33-139"><a id="__codelineno-33-139" name="__codelineno-33-139"></a>
</span><span id="__span-33-140"><a id="__codelineno-33-140" name="__codelineno-33-140"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_HOST</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-141"><a id="__codelineno-33-141" name="__codelineno-33-141"></a><span class="w">    </span><span class="nv">REDIS_HOST</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>-n<span class="w"> </span><span class="s1">&#39;s/redis:\/\/\([^:]*\).*/\1/p&#39;</span><span class="k">)</span>
</span><span id="__span-33-142"><a id="__codelineno-33-142" name="__codelineno-33-142"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-143"><a id="__codelineno-33-143" name="__codelineno-33-143"></a>
</span><span id="__span-33-144"><a id="__codelineno-33-144" name="__codelineno-33-144"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-z<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_PORT</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-145"><a id="__codelineno-33-145" name="__codelineno-33-145"></a><span class="w">    </span><span class="nv">REDIS_PORT</span><span class="o">=</span><span class="m">6379</span>
</span><span id="__span-33-146"><a id="__codelineno-33-146" name="__codelineno-33-146"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-147"><a id="__codelineno-33-147" name="__codelineno-33-147"></a>
</span><span id="__span-33-148"><a id="__codelineno-33-148" name="__codelineno-33-148"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span>timeout<span class="w"> </span><span class="m">5</span><span class="w"> </span>redis-cli<span class="w"> </span>-h<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_HOST</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_PORT</span><span class="s2">&quot;</span><span class="w"> </span>ping<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-149"><a id="__codelineno-33-149" name="__codelineno-33-149"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">✅ Redis connection successful</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-150"><a id="__codelineno-33-150" name="__codelineno-33-150"></a><span class="w">  </span><span class="k">else</span>
</span><span id="__span-33-151"><a id="__codelineno-33-151" name="__codelineno-33-151"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ Redis connection failed</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-152"><a id="__codelineno-33-152" name="__codelineno-33-152"></a><span class="w">    </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-153"><a id="__codelineno-33-153" name="__codelineno-33-153"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-154"><a id="__codelineno-33-154" name="__codelineno-33-154"></a><span class="k">else</span>
</span><span id="__span-33-155"><a id="__codelineno-33-155" name="__codelineno-33-155"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">YELLOW</span><span class="si">}</span><span class="s2">⚠️  redis-cli not available, skipping Redis test</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-156"><a id="__codelineno-33-156" name="__codelineno-33-156"></a><span class="k">fi</span>
</span><span id="__span-33-157"><a id="__codelineno-33-157" name="__codelineno-33-157"></a>
</span><span id="__span-33-158"><a id="__codelineno-33-158" name="__codelineno-33-158"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">🔐 Security Validation</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-159"><a id="__codelineno-33-159" name="__codelineno-33-159"></a>
</span><span id="__span-33-160"><a id="__codelineno-33-160" name="__codelineno-33-160"></a><span class="c1"># Check secret strength</span>
</span><span id="__span-33-161"><a id="__codelineno-33-161" name="__codelineno-33-161"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">JWT_SECRET</span><span class="si">}</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">64</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-162"><a id="__codelineno-33-162" name="__codelineno-33-162"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">✅ JWT_SECRET has excellent length</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-163"><a id="__codelineno-33-163" name="__codelineno-33-163"></a><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">JWT_SECRET</span><span class="si">}</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-164"><a id="__codelineno-33-164" name="__codelineno-33-164"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">YELLOW</span><span class="si">}</span><span class="s2">⚠️  JWT_SECRET meets minimum requirements</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-165"><a id="__codelineno-33-165" name="__codelineno-33-165"></a><span class="k">fi</span>
</span><span id="__span-33-166"><a id="__codelineno-33-166" name="__codelineno-33-166"></a>
</span><span id="__span-33-167"><a id="__codelineno-33-167" name="__codelineno-33-167"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">NEXTAUTH_SECRET</span><span class="si">}</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">64</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-168"><a id="__codelineno-33-168" name="__codelineno-33-168"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">✅ NEXTAUTH_SECRET has excellent length</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-169"><a id="__codelineno-33-169" name="__codelineno-33-169"></a><span class="k">elif</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="si">${#</span><span class="nv">NEXTAUTH_SECRET</span><span class="si">}</span><span class="w"> </span>-ge<span class="w"> </span><span class="m">32</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-170"><a id="__codelineno-33-170" name="__codelineno-33-170"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">YELLOW</span><span class="si">}</span><span class="s2">⚠️  NEXTAUTH_SECRET meets minimum requirements</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-171"><a id="__codelineno-33-171" name="__codelineno-33-171"></a><span class="k">fi</span>
</span><span id="__span-33-172"><a id="__codelineno-33-172" name="__codelineno-33-172"></a>
</span><span id="__span-33-173"><a id="__codelineno-33-173" name="__codelineno-33-173"></a><span class="c1"># Check for weak secrets</span>
</span><span id="__span-33-174"><a id="__codelineno-33-174" name="__codelineno-33-174"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JWT_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;password&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JWT_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;secret&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$JWT_SECRET</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span>*<span class="s2">&quot;123&quot;</span>*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-175"><a id="__codelineno-33-175" name="__codelineno-33-175"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ JWT_SECRET appears to be weak</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-176"><a id="__codelineno-33-176" name="__codelineno-33-176"></a><span class="w">  </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-177"><a id="__codelineno-33-177" name="__codelineno-33-177"></a><span class="k">fi</span>
</span><span id="__span-33-178"><a id="__codelineno-33-178" name="__codelineno-33-178"></a>
</span><span id="__span-33-179"><a id="__codelineno-33-179" name="__codelineno-33-179"></a><span class="c1"># Production-specific checks</span>
</span><span id="__span-33-180"><a id="__codelineno-33-180" name="__codelineno-33-180"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$NODE_ENV</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;production&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-181"><a id="__codelineno-33-181" name="__codelineno-33-181"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">🏭 Production Environment Checks</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-182"><a id="__codelineno-33-182" name="__codelineno-33-182"></a>
</span><span id="__span-33-183"><a id="__codelineno-33-183" name="__codelineno-33-183"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$FRONTEND_URL</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>https://*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-184"><a id="__codelineno-33-184" name="__codelineno-33-184"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ Production FRONTEND_URL should use HTTPS</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-185"><a id="__codelineno-33-185" name="__codelineno-33-185"></a><span class="w">    </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-186"><a id="__codelineno-33-186" name="__codelineno-33-186"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-187"><a id="__codelineno-33-187" name="__codelineno-33-187"></a>
</span><span id="__span-33-188"><a id="__codelineno-33-188" name="__codelineno-33-188"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$NEXTAUTH_URL</span><span class="s2">&quot;</span><span class="w"> </span>!<span class="o">=</span><span class="w"> </span>https://*<span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-189"><a id="__codelineno-33-189" name="__codelineno-33-189"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ Production NEXTAUTH_URL should use HTTPS</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-190"><a id="__codelineno-33-190" name="__codelineno-33-190"></a><span class="w">    </span><span class="o">((</span>VALIDATION_ERRORS++<span class="o">))</span>
</span><span id="__span-33-191"><a id="__codelineno-33-191" name="__codelineno-33-191"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-192"><a id="__codelineno-33-192" name="__codelineno-33-192"></a>
</span><span id="__span-33-193"><a id="__codelineno-33-193" name="__codelineno-33-193"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$LOG_LEVEL</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;debug&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-194"><a id="__codelineno-33-194" name="__codelineno-33-194"></a><span class="w">    </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">YELLOW</span><span class="si">}</span><span class="s2">⚠️  Debug logging enabled in production</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-195"><a id="__codelineno-33-195" name="__codelineno-33-195"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-33-196"><a id="__codelineno-33-196" name="__codelineno-33-196"></a><span class="k">fi</span>
</span><span id="__span-33-197"><a id="__codelineno-33-197" name="__codelineno-33-197"></a>
</span><span id="__span-33-198"><a id="__codelineno-33-198" name="__codelineno-33-198"></a><span class="c1"># Summary</span>
</span><span id="__span-33-199"><a id="__codelineno-33-199" name="__codelineno-33-199"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">📊 Validation Summary</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-200"><a id="__codelineno-33-200" name="__codelineno-33-200"></a>
</span><span id="__span-33-201"><a id="__codelineno-33-201" name="__codelineno-33-201"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="nv">$VALIDATION_ERRORS</span><span class="w"> </span>-eq<span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-33-202"><a id="__codelineno-33-202" name="__codelineno-33-202"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GREEN</span><span class="si">}</span><span class="s2">✅ All validations passed! Environment is ready.</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-203"><a id="__codelineno-33-203" name="__codelineno-33-203"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">0</span>
</span><span id="__span-33-204"><a id="__codelineno-33-204" name="__codelineno-33-204"></a><span class="k">else</span>
</span><span id="__span-33-205"><a id="__codelineno-33-205" name="__codelineno-33-205"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">RED</span><span class="si">}</span><span class="s2">❌ Found </span><span class="nv">$VALIDATION_ERRORS</span><span class="s2"> validation error(s). Please fix before proceeding.</span><span class="si">${</span><span class="nv">NC</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-33-206"><a id="__codelineno-33-206" name="__codelineno-33-206"></a><span class="w">  </span><span class="nb">exit</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-33-207"><a id="__codelineno-33-207" name="__codelineno-33-207"></a><span class="k">fi</span>
</span></code></pre></div></td></tr></table></div><h3 id="performance-issues">Performance Issues<a class="headerlink" href="#performance-issues" title="Permanent link">&para;</a></h3><h4 id="database-performance-problems">Database Performance Problems<a class="headerlink" href="#database-performance-problems" title="Permanent link">&para;</a></h4><p><strong>Issue: Slow database queries</strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-34-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-34-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-34-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-34-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-34-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-34-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-34-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-34-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-34-10">10</a></span>
<span class="normal"><a href="#__codelineno-34-11">11</a></span>
<span class="normal"><a href="#__codelineno-34-12">12</a></span>
<span class="normal"><a href="#__codelineno-34-13">13</a></span>
<span class="normal"><a href="#__codelineno-34-14">14</a></span>
<span class="normal"><a href="#__codelineno-34-15">15</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1"></a><span class="c1"># Check connection pool settings</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DB_POOL_MIN: </span><span class="nv">$DB_POOL_MIN</span><span class="s2">&quot;</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DB_POOL_MAX: </span><span class="nv">$DB_POOL_MAX</span><span class="s2">&quot;</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DB_TIMEOUT: </span><span class="nv">$DB_TIMEOUT</span><span class="s2">&quot;</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5"></a>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6"></a><span class="c1"># Monitor active connections</span>
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>medianest_postgres_1<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span>
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8"></a><span class="s2">  SELECT count(*) as active_connections,</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9"></a><span class="s2">         state,</span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10"></a><span class="s2">         wait_event_type,</span>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11"></a><span class="s2">         wait_event</span>
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12"></a><span class="s2">  FROM pg_stat_activity</span>
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13"></a><span class="s2">  GROUP BY state, wait_event_type, wait_event</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14"></a><span class="s2">  ORDER BY active_connections DESC;</span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15"></a><span class="s2">&quot;</span>
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span>
<span class="normal"><a href="#__codelineno-35-15">15</a></span>
<span class="normal"><a href="#__codelineno-35-16">16</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="c1"># Increase connection pool</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="nv">DB_POOL_MIN</span><span class="o">=</span><span class="m">5</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="nv">DB_POOL_MAX</span><span class="o">=</span><span class="m">20</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4"></a><span class="nv">DB_TIMEOUT</span><span class="o">=</span><span class="m">60000</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5"></a>
</span><span id="__span-35-6"><a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="c1"># Enable connection pooling with PgBouncer</span>
</span><span id="__span-35-7"><a id="__codelineno-35-7" name="__codelineno-35-7"></a>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>pgbouncer<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-8"><a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">DATABASES_HOST</span><span class="o">=</span>postgres<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-9"><a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">DATABASES_PORT</span><span class="o">=</span><span class="m">5432</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-10"><a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">DATABASES_USER</span><span class="o">=</span>medianest<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-11"><a id="__codelineno-35-11" name="__codelineno-35-11"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">DATABASES_PASSWORD</span><span class="o">=</span>medianest_dev_password<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-12"><a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">DATABASES_DBNAME</span><span class="o">=</span>medianest_dev<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-13"><a id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">POOL_MODE</span><span class="o">=</span>transaction<span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-14"><a id="__codelineno-35-14" name="__codelineno-35-14"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">MAX_CLIENT_CONN</span><span class="o">=</span><span class="m">200</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-15"><a id="__codelineno-35-15" name="__codelineno-35-15"></a><span class="w">  </span>-e<span class="w"> </span><span class="nv">DEFAULT_POOL_SIZE</span><span class="o">=</span><span class="m">25</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-35-16"><a id="__codelineno-35-16" name="__codelineno-35-16"></a><span class="w">  </span>pgbouncer/pgbouncer:latest
</span></code></pre></div></td></tr></table></div><h4 id="redis-performance-issues">Redis Performance Issues<a class="headerlink" href="#redis-performance-issues" title="Permanent link">&para;</a></h4><p><strong>Issue: Redis connection timeouts</strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span>
<span class="normal"><a href="#__codelineno-36-7">7</a></span>
<span class="normal"><a href="#__codelineno-36-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="c1"># Check Redis memory usage</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>medianest_redis_1<span class="w"> </span>redis-cli<span class="w"> </span>INFO<span class="w"> </span>memory
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3"></a>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="c1"># Check Redis connections</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>medianest_redis_1<span class="w"> </span>redis-cli<span class="w"> </span>INFO<span class="w"> </span>clients
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6"></a>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="c1"># Monitor Redis commands</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8"></a>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>medianest_redis_1<span class="w"> </span>redis-cli<span class="w"> </span>MONITOR
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span>
<span class="normal"><a href="#__codelineno-37-5">5</a></span>
<span class="normal"><a href="#__codelineno-37-6">6</a></span>
<span class="normal"><a href="#__codelineno-37-7">7</a></span>
<span class="normal"><a href="#__codelineno-37-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="c1"># Increase Redis memory and connections</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2"></a><span class="nv">REDIS_MAX_MEMORY_POLICY</span><span class="o">=</span>allkeys-lru
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="nv">REDIS_MAX_CLIENTS</span><span class="o">=</span><span class="m">2000</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4"></a>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5"></a><span class="c1"># Add Redis configuration</span>
</span><span id="__span-37-6"><a id="__codelineno-37-6" name="__codelineno-37-6"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;maxmemory 256mb&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>redis.conf
</span><span id="__span-37-7"><a id="__codelineno-37-7" name="__codelineno-37-7"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;maxmemory-policy allkeys-lru&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>redis.conf
</span><span id="__span-37-8"><a id="__codelineno-37-8" name="__codelineno-37-8"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;maxclients 2000&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>redis.conf
</span></code></pre></div></td></tr></table></div><h3 id="ssltls-configuration-issues">SSL/TLS Configuration Issues<a class="headerlink" href="#ssltls-configuration-issues" title="Permanent link">&para;</a></h3><h4 id="lets-encrypt-certificate-problems">Let's Encrypt Certificate Problems<a class="headerlink" href="#lets-encrypt-certificate-problems" title="Permanent link">&para;</a></h4><p><strong>Issue: Certificate generation fails</strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span>
<span class="normal"><a href="#__codelineno-38-4">4</a></span>
<span class="normal"><a href="#__codelineno-38-5">5</a></span>
<span class="normal"><a href="#__codelineno-38-6">6</a></span>
<span class="normal"><a href="#__codelineno-38-7">7</a></span>
<span class="normal"><a href="#__codelineno-38-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="c1"># Check Certbot logs</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2"></a>docker-compose<span class="w"> </span>logs<span class="w"> </span>certbot
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3"></a>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4"></a><span class="c1"># Verify domain DNS</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5"></a>nslookup<span class="w"> </span>yourdomain.com
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6"></a>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7"></a><span class="c1"># Check if port 80 is accessible</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8"></a>curl<span class="w"> </span>-I<span class="w"> </span>http://yourdomain.com/.well-known/acme-challenge/test
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-39-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-39-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-39-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-39-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-39-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-39-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-39-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-39-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-39-10">10</a></span>
<span class="normal"><a href="#__codelineno-39-11">11</a></span>
<span class="normal"><a href="#__codelineno-39-12">12</a></span>
<span class="normal"><a href="#__codelineno-39-13">13</a></span>
<span class="normal"><a href="#__codelineno-39-14">14</a></span>
<span class="normal"><a href="#__codelineno-39-15">15</a></span>
<span class="normal"><a href="#__codelineno-39-16">16</a></span>
<span class="normal"><a href="#__codelineno-39-17">17</a></span>
<span class="normal"><a href="#__codelineno-39-18">18</a></span>
<span class="normal"><a href="#__codelineno-39-19">19</a></span>
<span class="normal"><a href="#__codelineno-39-20">20</a></span>
<span class="normal"><a href="#__codelineno-39-21">21</a></span>
<span class="normal"><a href="#__codelineno-39-22">22</a></span>
<span class="normal"><a href="#__codelineno-39-23">23</a></span>
<span class="normal"><a href="#__codelineno-39-24">24</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="c1"># Manual certificate generation</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3"></a><span class="w">  </span>-v<span class="w"> </span><span class="s2">&quot;/etc/letsencrypt:/etc/letsencrypt&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4"></a><span class="w">  </span>-v<span class="w"> </span><span class="s2">&quot;/var/lib/letsencrypt:/var/lib/letsencrypt&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5"></a><span class="w">  </span>certbot/certbot<span class="w"> </span>certonly<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6"></a><span class="w">  </span>--webroot<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7"></a><span class="w">  </span>--webroot-path<span class="o">=</span>/var/www/certbot<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8"></a><span class="w">  </span>--email<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CERTBOT_EMAIL</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9"></a><span class="w">  </span>--agree-tos<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10"></a><span class="w">  </span>--no-eff-email<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11"></a><span class="w">  </span>-d<span class="w"> </span>yourdomain.com
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12"></a>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13"></a><span class="c1"># Debug mode</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15"></a><span class="w">  </span>-v<span class="w"> </span><span class="s2">&quot;/etc/letsencrypt:/etc/letsencrypt&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-16"><a id="__codelineno-39-16" name="__codelineno-39-16"></a><span class="w">  </span>-v<span class="w"> </span><span class="s2">&quot;/var/lib/letsencrypt:/var/lib/letsencrypt&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-17"><a id="__codelineno-39-17" name="__codelineno-39-17"></a><span class="w">  </span>certbot/certbot<span class="w"> </span>certonly<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-18"><a id="__codelineno-39-18" name="__codelineno-39-18"></a><span class="w">  </span>--dry-run<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-19"><a id="__codelineno-39-19" name="__codelineno-39-19"></a><span class="w">  </span>--webroot<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-20"><a id="__codelineno-39-20" name="__codelineno-39-20"></a><span class="w">  </span>--webroot-path<span class="o">=</span>/var/www/certbot<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-21"><a id="__codelineno-39-21" name="__codelineno-39-21"></a><span class="w">  </span>--email<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$CERTBOT_EMAIL</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-22"><a id="__codelineno-39-22" name="__codelineno-39-22"></a><span class="w">  </span>--agree-tos<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-23"><a id="__codelineno-39-23" name="__codelineno-39-23"></a><span class="w">  </span>--no-eff-email<span class="w"> </span><span class="se">\</span>
</span><span id="__span-39-24"><a id="__codelineno-39-24" name="__codelineno-39-24"></a><span class="w">  </span>-d<span class="w"> </span>yourdomain.com
</span></code></pre></div></td></tr></table></div><h3 id="docker-specific-issues">Docker-Specific Issues<a class="headerlink" href="#docker-specific-issues" title="Permanent link">&para;</a></h3><h4 id="container-startup-problems">Container Startup Problems<a class="headerlink" href="#container-startup-problems" title="Permanent link">&para;</a></h4><p><strong>Issue: Backend container exits immediately</strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-40-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-40-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-40-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-40-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-40-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-40-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-40-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-40-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-40-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="c1"># Check container logs</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2"></a>docker-compose<span class="w"> </span>logs<span class="w"> </span>backend
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3"></a>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4"></a><span class="c1"># Check environment variables in container</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5"></a>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>backend<span class="w"> </span>env<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-E<span class="w"> </span><span class="s2">&quot;(DATABASE_URL|JWT_SECRET|REDIS_URL)&quot;</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6"></a>
</span><span id="__span-40-7"><a id="__codelineno-40-7" name="__codelineno-40-7"></a><span class="c1"># Test container manually</span>
</span><span id="__span-40-8"><a id="__codelineno-40-8" name="__codelineno-40-8"></a>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-9"><a id="__codelineno-40-9" name="__codelineno-40-9"></a><span class="w">  </span>--env-file<span class="w"> </span>docker-environment.env<span class="w"> </span><span class="se">\</span>
</span><span id="__span-40-10"><a id="__codelineno-40-10" name="__codelineno-40-10"></a><span class="w">  </span>medianest/backend:latest<span class="w"> </span>/bin/bash
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-41-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-41-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-41-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-41-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-41-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-41-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-41-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-41-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-41-10">10</a></span>
<span class="normal"><a href="#__codelineno-41-11">11</a></span>
<span class="normal"><a href="#__codelineno-41-12">12</a></span>
<span class="normal"><a href="#__codelineno-41-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="c1"># Fix 1: Ensure all required environment variables are set</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="c1"># (Use validation script above)</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3"></a>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4"></a><span class="c1"># Fix 2: Check Docker secrets mounting</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5"></a>docker-compose<span class="w"> </span>config
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6"></a>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7"></a><span class="c1"># Fix 3: Verify image build</span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8"></a>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>medianest/backend:latest<span class="w"> </span>./backend
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9"></a>
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10"></a><span class="c1"># Fix 4: Check startup dependencies</span>
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11"></a>depends_on:
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12"></a><span class="w">  </span>-<span class="w"> </span>postgres
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13"></a><span class="w">  </span>-<span class="w"> </span>redis
</span></code></pre></div></td></tr></table></div><h4 id="docker-secrets-not-loading">Docker Secrets Not Loading<a class="headerlink" href="#docker-secrets-not-loading" title="Permanent link">&para;</a></h4><p><strong>Issue: <code>readSecretFromFile</code> returns empty</strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-42-1">1</a></span>
<span class="normal"><a href="#__codelineno-42-2">2</a></span>
<span class="normal"><a href="#__codelineno-42-3">3</a></span>
<span class="normal"><a href="#__codelineno-42-4">4</a></span>
<span class="normal"><a href="#__codelineno-42-5">5</a></span>
<span class="normal"><a href="#__codelineno-42-6">6</a></span>
<span class="normal"><a href="#__codelineno-42-7">7</a></span>
<span class="normal"><a href="#__codelineno-42-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1"></a><span class="c1"># Check if secrets are mounted</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2"></a>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>backend<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/run/secrets/
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3"></a>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4"></a><span class="c1"># Verify secret content</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5"></a>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>backend<span class="w"> </span>cat<span class="w"> </span>/run/secrets/jwt_secret
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6"></a>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7"></a><span class="c1"># Check Docker secrets exist</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8"></a>docker<span class="w"> </span>secret<span class="w"> </span>ls
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-43-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-43-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-43-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-43-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-43-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-43-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-43-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-43-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-43-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-43-10">10</a></span>
<span class="normal"><a href="#__codelineno-43-11">11</a></span>
<span class="normal"><a href="#__codelineno-43-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1"></a><span class="c1"># Recreate Docker secrets</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2"></a>docker<span class="w"> </span>secret<span class="w"> </span>rm<span class="w"> </span>jwt_secret
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>openssl<span class="w"> </span>rand<span class="w"> </span>-hex<span class="w"> </span><span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>jwt_secret<span class="w"> </span>-
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4"></a>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5"></a><span class="c1"># Verify secrets configuration in compose file</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6"></a>secrets:
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7"></a><span class="w">  </span>jwt_secret:
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8"></a><span class="w">    </span>external:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9"></a>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10"></a><span class="c1"># Enable Docker secrets in environment</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11"></a><span class="nv">USE_DOCKER_SECRETS</span><span class="o">=</span><span class="nb">true</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12"></a><span class="nv">DOCKER_SECRETS_PATH</span><span class="o">=</span>/run/secrets
</span></code></pre></div></td></tr></table></div><h3 id="testing-environment-issues">Testing Environment Issues<a class="headerlink" href="#testing-environment-issues" title="Permanent link">&para;</a></h3><h4 id="test-database-connection-problems">Test Database Connection Problems<a class="headerlink" href="#test-database-connection-problems" title="Permanent link">&para;</a></h4><p><strong>Issue: Tests fail with database connection errors</strong></p><p><strong>Diagnosis:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-44-1">1</a></span>
<span class="normal"><a href="#__codelineno-44-2">2</a></span>
<span class="normal"><a href="#__codelineno-44-3">3</a></span>
<span class="normal"><a href="#__codelineno-44-4">4</a></span>
<span class="normal"><a href="#__codelineno-44-5">5</a></span>
<span class="normal"><a href="#__codelineno-44-6">6</a></span>
<span class="normal"><a href="#__codelineno-44-7">7</a></span>
<span class="normal"><a href="#__codelineno-44-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1"></a><span class="c1"># Check test database URL</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST_DATABASE_URL: </span><span class="nv">$TEST_DATABASE_URL</span><span class="s2">&quot;</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3"></a>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4"></a><span class="c1"># Test connection manually</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5"></a>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TEST_DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;SELECT 1;&quot;</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6"></a>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7"></a><span class="c1"># Check if test database exists</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8"></a>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$TEST_DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-l
</span></code></pre></div></td></tr></table></div><p><strong>Solutions:</strong></p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-45-1">1</a></span>
<span class="normal"><a href="#__codelineno-45-2">2</a></span>
<span class="normal"><a href="#__codelineno-45-3">3</a></span>
<span class="normal"><a href="#__codelineno-45-4">4</a></span>
<span class="normal"><a href="#__codelineno-45-5">5</a></span>
<span class="normal"><a href="#__codelineno-45-6">6</a></span>
<span class="normal"><a href="#__codelineno-45-7">7</a></span>
<span class="normal"><a href="#__codelineno-45-8">8</a></span>
<span class="normal"><a href="#__codelineno-45-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1"></a><span class="c1"># Create test database</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2"></a>createdb<span class="w"> </span>-h<span class="w"> </span>localhost<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>medianest_test
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4"></a><span class="c1"># Set correct test environment</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5"></a><span class="nv">NODE_ENV</span><span class="o">=</span><span class="nb">test</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6"></a><span class="nv">TEST_DATABASE_URL</span><span class="o">=</span><span class="s2">&quot;postgresql://test_user:test_password@localhost:5432/medianest_test&quot;</span>
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7"></a>
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8"></a><span class="c1"># Run database migrations for tests</span>
</span><span id="__span-45-9"><a id="__codelineno-45-9" name="__codelineno-45-9"></a>npm<span class="w"> </span>run<span class="w"> </span>db:migrate:test
</span></code></pre></div></td></tr></table></div><h3 id="monitoring-and-debugging-tools">Monitoring and Debugging Tools<a class="headerlink" href="#monitoring-and-debugging-tools" title="Permanent link">&para;</a></h3><h4 id="environment-debug-script">Environment Debug Script<a class="headerlink" href="#environment-debug-script" title="Permanent link">&para;</a></h4><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-46-1">  1</a></span>
<span class="normal"><a href="#__codelineno-46-2">  2</a></span>
<span class="normal"><a href="#__codelineno-46-3">  3</a></span>
<span class="normal"><a href="#__codelineno-46-4">  4</a></span>
<span class="normal"><a href="#__codelineno-46-5">  5</a></span>
<span class="normal"><a href="#__codelineno-46-6">  6</a></span>
<span class="normal"><a href="#__codelineno-46-7">  7</a></span>
<span class="normal"><a href="#__codelineno-46-8">  8</a></span>
<span class="normal"><a href="#__codelineno-46-9">  9</a></span>
<span class="normal"><a href="#__codelineno-46-10"> 10</a></span>
<span class="normal"><a href="#__codelineno-46-11"> 11</a></span>
<span class="normal"><a href="#__codelineno-46-12"> 12</a></span>
<span class="normal"><a href="#__codelineno-46-13"> 13</a></span>
<span class="normal"><a href="#__codelineno-46-14"> 14</a></span>
<span class="normal"><a href="#__codelineno-46-15"> 15</a></span>
<span class="normal"><a href="#__codelineno-46-16"> 16</a></span>
<span class="normal"><a href="#__codelineno-46-17"> 17</a></span>
<span class="normal"><a href="#__codelineno-46-18"> 18</a></span>
<span class="normal"><a href="#__codelineno-46-19"> 19</a></span>
<span class="normal"><a href="#__codelineno-46-20"> 20</a></span>
<span class="normal"><a href="#__codelineno-46-21"> 21</a></span>
<span class="normal"><a href="#__codelineno-46-22"> 22</a></span>
<span class="normal"><a href="#__codelineno-46-23"> 23</a></span>
<span class="normal"><a href="#__codelineno-46-24"> 24</a></span>
<span class="normal"><a href="#__codelineno-46-25"> 25</a></span>
<span class="normal"><a href="#__codelineno-46-26"> 26</a></span>
<span class="normal"><a href="#__codelineno-46-27"> 27</a></span>
<span class="normal"><a href="#__codelineno-46-28"> 28</a></span>
<span class="normal"><a href="#__codelineno-46-29"> 29</a></span>
<span class="normal"><a href="#__codelineno-46-30"> 30</a></span>
<span class="normal"><a href="#__codelineno-46-31"> 31</a></span>
<span class="normal"><a href="#__codelineno-46-32"> 32</a></span>
<span class="normal"><a href="#__codelineno-46-33"> 33</a></span>
<span class="normal"><a href="#__codelineno-46-34"> 34</a></span>
<span class="normal"><a href="#__codelineno-46-35"> 35</a></span>
<span class="normal"><a href="#__codelineno-46-36"> 36</a></span>
<span class="normal"><a href="#__codelineno-46-37"> 37</a></span>
<span class="normal"><a href="#__codelineno-46-38"> 38</a></span>
<span class="normal"><a href="#__codelineno-46-39"> 39</a></span>
<span class="normal"><a href="#__codelineno-46-40"> 40</a></span>
<span class="normal"><a href="#__codelineno-46-41"> 41</a></span>
<span class="normal"><a href="#__codelineno-46-42"> 42</a></span>
<span class="normal"><a href="#__codelineno-46-43"> 43</a></span>
<span class="normal"><a href="#__codelineno-46-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-46-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-46-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-46-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-46-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-46-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-46-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-46-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-46-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-46-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-46-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-46-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-46-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-46-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-46-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-46-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-46-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-46-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-46-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-46-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-46-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-46-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-46-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-46-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-46-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-46-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-46-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-46-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-46-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-46-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-46-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-46-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-46-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-46-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-46-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-46-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-46-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-46-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-46-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-46-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-46-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-46-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-46-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-46-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-46-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-46-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-46-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-46-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-46-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-46-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-46-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-46-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-46-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-46-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-46-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-46-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-46-100">100</a></span>
<span class="normal"><a href="#__codelineno-46-101">101</a></span>
<span class="normal"><a href="#__codelineno-46-102">102</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1"></a><span class="ch">#!/bin/bash</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2"></a><span class="c1"># debug-environment.sh</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3"></a>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🔧 MediaNest Environment Debug Report&quot;</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Generated: </span><span class="k">$(</span>date<span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;==================================================&quot;</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7"></a>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n📋 Environment Summary&quot;</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NODE_ENV: </span><span class="si">${</span><span class="nv">NODE_ENV</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Host: </span><span class="k">$(</span>hostname<span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;User: </span><span class="k">$(</span>whoami<span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Working Directory: </span><span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13"></a>
</span><span id="__span-46-14"><a id="__codelineno-46-14" name="__codelineno-46-14"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n🐳 Docker Status&quot;</span>
</span><span id="__span-46-15"><a id="__codelineno-46-15" name="__codelineno-46-15"></a><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>docker<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-16"><a id="__codelineno-46-16" name="__codelineno-46-16"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Docker Version: </span><span class="k">$(</span>docker<span class="w"> </span>--version<span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-17"><a id="__codelineno-46-17" name="__codelineno-46-17"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Docker Compose Version: </span><span class="k">$(</span>docker-compose<span class="w"> </span>--version<span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-18"><a id="__codelineno-46-18" name="__codelineno-46-18"></a>
</span><span id="__span-46-19"><a id="__codelineno-46-19" name="__codelineno-46-19"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nRunning Containers:&quot;</span>
</span><span id="__span-46-20"><a id="__codelineno-46-20" name="__codelineno-46-20"></a><span class="w">  </span>docker-compose<span class="w"> </span>ps
</span><span id="__span-46-21"><a id="__codelineno-46-21" name="__codelineno-46-21"></a>
</span><span id="__span-46-22"><a id="__codelineno-46-22" name="__codelineno-46-22"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nDocker Networks:&quot;</span>
</span><span id="__span-46-23"><a id="__codelineno-46-23" name="__codelineno-46-23"></a><span class="w">  </span>docker<span class="w"> </span>network<span class="w"> </span>ls<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>medianest
</span><span id="__span-46-24"><a id="__codelineno-46-24" name="__codelineno-46-24"></a><span class="k">else</span>
</span><span id="__span-46-25"><a id="__codelineno-46-25" name="__codelineno-46-25"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Docker not available&quot;</span>
</span><span id="__span-46-26"><a id="__codelineno-46-26" name="__codelineno-46-26"></a><span class="k">fi</span>
</span><span id="__span-46-27"><a id="__codelineno-46-27" name="__codelineno-46-27"></a>
</span><span id="__span-46-28"><a id="__codelineno-46-28" name="__codelineno-46-28"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n🗄️  Database Status&quot;</span>
</span><span id="__span-46-29"><a id="__codelineno-46-29" name="__codelineno-46-29"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-30"><a id="__codelineno-46-30" name="__codelineno-46-30"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Database URL: </span><span class="si">${</span><span class="nv">DATABASE_URL</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">20</span><span class="si">}</span><span class="s2">...&quot;</span>
</span><span id="__span-46-31"><a id="__codelineno-46-31" name="__codelineno-46-31"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>psql<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-32"><a id="__codelineno-46-32" name="__codelineno-46-32"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span>timeout<span class="w"> </span><span class="m">5</span><span class="w"> </span>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;SELECT version();&quot;</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-33"><a id="__codelineno-46-33" name="__codelineno-46-33"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Database connection successful&quot;</span>
</span><span id="__span-46-34"><a id="__codelineno-46-34" name="__codelineno-46-34"></a><span class="w">      </span>psql<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DATABASE_URL</span><span class="s2">&quot;</span><span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;SELECT current_database(), current_user, inet_server_addr(), inet_server_port();&quot;</span>
</span><span id="__span-46-35"><a id="__codelineno-46-35" name="__codelineno-46-35"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-46-36"><a id="__codelineno-46-36" name="__codelineno-46-36"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Database connection failed&quot;</span>
</span><span id="__span-46-37"><a id="__codelineno-46-37" name="__codelineno-46-37"></a><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-46-38"><a id="__codelineno-46-38" name="__codelineno-46-38"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-46-39"><a id="__codelineno-46-39" name="__codelineno-46-39"></a><span class="k">else</span>
</span><span id="__span-46-40"><a id="__codelineno-46-40" name="__codelineno-46-40"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DATABASE_URL not set&quot;</span>
</span><span id="__span-46-41"><a id="__codelineno-46-41" name="__codelineno-46-41"></a><span class="k">fi</span>
</span><span id="__span-46-42"><a id="__codelineno-46-42" name="__codelineno-46-42"></a>
</span><span id="__span-46-43"><a id="__codelineno-46-43" name="__codelineno-46-43"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n📊 Redis Status&quot;</span>
</span><span id="__span-46-44"><a id="__codelineno-46-44" name="__codelineno-46-44"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span>-n<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-45"><a id="__codelineno-46-45" name="__codelineno-46-45"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Redis URL: </span><span class="si">${</span><span class="nv">REDIS_URL</span><span class="p">:</span><span class="nv">0</span><span class="p">:</span><span class="nv">20</span><span class="si">}</span><span class="s2">...&quot;</span>
</span><span id="__span-46-46"><a id="__codelineno-46-46" name="__codelineno-46-46"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="nb">command</span><span class="w"> </span>-v<span class="w"> </span>redis-cli<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-47"><a id="__codelineno-46-47" name="__codelineno-46-47"></a><span class="w">    </span><span class="c1"># Extract host and port</span>
</span><span id="__span-46-48"><a id="__codelineno-46-48" name="__codelineno-46-48"></a><span class="w">    </span><span class="nv">REDIS_HOST</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s|redis://||&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d:<span class="w"> </span>-f1<span class="k">)</span>
</span><span id="__span-46-49"><a id="__codelineno-46-49" name="__codelineno-46-49"></a><span class="w">    </span><span class="nv">REDIS_PORT</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_URL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s1">&#39;s|redis://||&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d:<span class="w"> </span>-f2<span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d/<span class="w"> </span>-f1<span class="k">)</span>
</span><span id="__span-46-50"><a id="__codelineno-46-50" name="__codelineno-46-50"></a>
</span><span id="__span-46-51"><a id="__codelineno-46-51" name="__codelineno-46-51"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span>timeout<span class="w"> </span><span class="m">5</span><span class="w"> </span>redis-cli<span class="w"> </span>-h<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_HOST</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_PORT</span><span class="s2">&quot;</span><span class="w"> </span>ping<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-52"><a id="__codelineno-46-52" name="__codelineno-46-52"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;✅ Redis connection successful&quot;</span>
</span><span id="__span-46-53"><a id="__codelineno-46-53" name="__codelineno-46-53"></a><span class="w">      </span>redis-cli<span class="w"> </span>-h<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_HOST</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$REDIS_PORT</span><span class="s2">&quot;</span><span class="w"> </span>INFO<span class="w"> </span>server<span class="w"> </span><span class="p">|</span><span class="w"> </span>head<span class="w"> </span>-5
</span><span id="__span-46-54"><a id="__codelineno-46-54" name="__codelineno-46-54"></a><span class="w">    </span><span class="k">else</span>
</span><span id="__span-46-55"><a id="__codelineno-46-55" name="__codelineno-46-55"></a><span class="w">      </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;❌ Redis connection failed&quot;</span>
</span><span id="__span-46-56"><a id="__codelineno-46-56" name="__codelineno-46-56"></a><span class="w">    </span><span class="k">fi</span>
</span><span id="__span-46-57"><a id="__codelineno-46-57" name="__codelineno-46-57"></a><span class="w">  </span><span class="k">fi</span>
</span><span id="__span-46-58"><a id="__codelineno-46-58" name="__codelineno-46-58"></a><span class="k">else</span>
</span><span id="__span-46-59"><a id="__codelineno-46-59" name="__codelineno-46-59"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;REDIS_URL not set&quot;</span>
</span><span id="__span-46-60"><a id="__codelineno-46-60" name="__codelineno-46-60"></a><span class="k">fi</span>
</span><span id="__span-46-61"><a id="__codelineno-46-61" name="__codelineno-46-61"></a>
</span><span id="__span-46-62"><a id="__codelineno-46-62" name="__codelineno-46-62"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n🔐 Security Configuration&quot;</span>
</span><span id="__span-46-63"><a id="__codelineno-46-63" name="__codelineno-46-63"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;JWT_SECRET length: </span><span class="si">${#</span><span class="nv">JWT_SECRET</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-64"><a id="__codelineno-46-64" name="__codelineno-46-64"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NEXTAUTH_SECRET length: </span><span class="si">${#</span><span class="nv">NEXTAUTH_SECRET</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-65"><a id="__codelineno-46-65" name="__codelineno-46-65"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;ENCRYPTION_KEY length: </span><span class="si">${#</span><span class="nv">ENCRYPTION_KEY</span><span class="k">:-</span><span class="nv">0</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-66"><a id="__codelineno-46-66" name="__codelineno-46-66"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;USE_DOCKER_SECRETS: </span><span class="si">${</span><span class="nv">USE_DOCKER_SECRETS</span><span class="k">:-</span><span class="nv">false</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-67"><a id="__codelineno-46-67" name="__codelineno-46-67"></a>
</span><span id="__span-46-68"><a id="__codelineno-46-68" name="__codelineno-46-68"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$USE_DOCKER_SECRETS</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;true&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-69"><a id="__codelineno-46-69" name="__codelineno-46-69"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\nDocker Secrets:&quot;</span>
</span><span id="__span-46-70"><a id="__codelineno-46-70" name="__codelineno-46-70"></a><span class="w">  </span>ls<span class="w"> </span>-la<span class="w"> </span>/run/secrets/<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Secrets directory not accessible&quot;</span>
</span><span id="__span-46-71"><a id="__codelineno-46-71" name="__codelineno-46-71"></a><span class="k">fi</span>
</span><span id="__span-46-72"><a id="__codelineno-46-72" name="__codelineno-46-72"></a>
</span><span id="__span-46-73"><a id="__codelineno-46-73" name="__codelineno-46-73"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n🌐 Network Configuration&quot;</span>
</span><span id="__span-46-74"><a id="__codelineno-46-74" name="__codelineno-46-74"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;FRONTEND_URL: </span><span class="si">${</span><span class="nv">FRONTEND_URL</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-75"><a id="__codelineno-46-75" name="__codelineno-46-75"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;NEXTAUTH_URL: </span><span class="si">${</span><span class="nv">NEXTAUTH_URL</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-76"><a id="__codelineno-46-76" name="__codelineno-46-76"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;CORS_ORIGIN: </span><span class="si">${</span><span class="nv">CORS_ORIGIN</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-77"><a id="__codelineno-46-77" name="__codelineno-46-77"></a>
</span><span id="__span-46-78"><a id="__codelineno-46-78" name="__codelineno-46-78"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n📝 Logging Configuration&quot;</span>
</span><span id="__span-46-79"><a id="__codelineno-46-79" name="__codelineno-46-79"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;LOG_LEVEL: </span><span class="si">${</span><span class="nv">LOG_LEVEL</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-80"><a id="__codelineno-46-80" name="__codelineno-46-80"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;LOG_FORMAT: </span><span class="si">${</span><span class="nv">LOG_FORMAT</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-81"><a id="__codelineno-46-81" name="__codelineno-46-81"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DEBUG: </span><span class="si">${</span><span class="nv">DEBUG</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-82"><a id="__codelineno-46-82" name="__codelineno-46-82"></a>
</span><span id="__span-46-83"><a id="__codelineno-46-83" name="__codelineno-46-83"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n🚀 Performance Settings&quot;</span>
</span><span id="__span-46-84"><a id="__codelineno-46-84" name="__codelineno-46-84"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;DB_POOL_MAX: </span><span class="si">${</span><span class="nv">DB_POOL_MAX</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-85"><a id="__codelineno-46-85" name="__codelineno-46-85"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;REDIS_MAX_CLIENTS: </span><span class="si">${</span><span class="nv">REDIS_MAX_CLIENTS</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-86"><a id="__codelineno-46-86" name="__codelineno-46-86"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;RATE_LIMIT_API_REQUESTS: </span><span class="si">${</span><span class="nv">RATE_LIMIT_API_REQUESTS</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-87"><a id="__codelineno-46-87" name="__codelineno-46-87"></a>
</span><span id="__span-46-88"><a id="__codelineno-46-88" name="__codelineno-46-88"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n🧪 Test Configuration&quot;</span>
</span><span id="__span-46-89"><a id="__codelineno-46-89" name="__codelineno-46-89"></a><span class="k">if</span><span class="w"> </span><span class="o">[[</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$NODE_ENV</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;test&quot;</span><span class="w"> </span><span class="o">]]</span><span class="p">;</span><span class="w"> </span><span class="k">then</span>
</span><span id="__span-46-90"><a id="__codelineno-46-90" name="__codelineno-46-90"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST_DATABASE_URL: </span><span class="si">${</span><span class="nv">TEST_DATABASE_URL</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-91"><a id="__codelineno-46-91" name="__codelineno-46-91"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;TEST_REDIS_URL: </span><span class="si">${</span><span class="nv">TEST_REDIS_URL</span><span class="k">:-</span><span class="s1">&#39;not set&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="__span-46-92"><a id="__codelineno-46-92" name="__codelineno-46-92"></a><span class="k">else</span>
</span><span id="__span-46-93"><a id="__codelineno-46-93" name="__codelineno-46-93"></a><span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Not in test environment&quot;</span>
</span><span id="__span-46-94"><a id="__codelineno-46-94" name="__codelineno-46-94"></a><span class="k">fi</span>
</span><span id="__span-46-95"><a id="__codelineno-46-95" name="__codelineno-46-95"></a>
</span><span id="__span-46-96"><a id="__codelineno-46-96" name="__codelineno-46-96"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n📊 System Resources&quot;</span>
</span><span id="__span-46-97"><a id="__codelineno-46-97" name="__codelineno-46-97"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Memory Usage: </span><span class="k">$(</span>free<span class="w"> </span>-h<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;^Mem:&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Not available&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-98"><a id="__codelineno-46-98" name="__codelineno-46-98"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Disk Usage: </span><span class="k">$(</span>df<span class="w"> </span>-h<span class="w"> </span>.<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="p">|</span><span class="w"> </span>tail<span class="w"> </span>-1<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Not available&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-99"><a id="__codelineno-46-99" name="__codelineno-46-99"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Load Average: </span><span class="k">$(</span>uptime<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;Not available&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
</span><span id="__span-46-100"><a id="__codelineno-46-100" name="__codelineno-46-100"></a>
</span><span id="__span-46-101"><a id="__codelineno-46-101" name="__codelineno-46-101"></a><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\n==================================================&quot;</span>
</span><span id="__span-46-102"><a id="__codelineno-46-102" name="__codelineno-46-102"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;🏁 Debug report complete&quot;</span>
</span></code></pre></div></td></tr></table></div><p>Make it executable and run:</p><div class="language-bash highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Bash</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-47-1">1</a></span>
<span class="normal"><a href="#__codelineno-47-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1"></a>chmod<span class="w"> </span>+x<span class="w"> </span>debug-environment.sh
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2"></a>./debug-environment.sh<span class="w"> </span>&gt;<span class="w"> </span>debug-report.txt
</span></code></pre></div></td></tr></table></div><p>This comprehensive environment variables documentation provides everything needed to configure MediaNest correctly across all deployment scenarios. The guide includes detailed variable references, setup instructions, security best practices, and troubleshooting procedures to ensure successful configuration and deployment.</p><aside class="md-source-file"><span class="md-source-file__fact"><span class="md-icon" title="Last update"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="September 11, 2025 15:09:40 UTC"><span class="timeago" datetime="2025-09-11T15:09:40+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="September 11, 2025 15:09:40 UTC">2025-09-11</span></span><span class="md-source-file__fact"><span class="md-icon" title="Created"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="September 9, 2025 18:20:40 UTC"><span class="timeago" datetime="2025-09-09T18:20:40+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="September 9, 2025 18:20:40 UTC">2025-09-09</span></span></aside><form class="md-feedback" name="feedback" hidden><fieldset><legend class="md-feedback__title"> Was this page helpful? </legend><div class="md-feedback__inner"><div class="md-feedback__list"><button class="md-feedback__icon md-icon" type="submit" title="This page was helpful" data-md-value="1"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m7 0c0 .8-.7 1.5-1.5 1.5S14 10.3 14 9.5 14.7 8 15.5 8s1.5.7 1.5 1.5m-5 7.73c-1.75 0-3.29-.73-4.19-1.81L9.23 14c.45.72 1.52 1.23 2.77 1.23s2.32-.51 2.77-1.23l1.42 1.42c-.9 1.08-2.44 1.81-4.19 1.81"/></svg></button><button class="md-feedback__icon md-icon" type="submit" title="This page could be improved" data-md-value="0"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M20 12a8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8 8 8 0 0 0 8-8m2 0a10 10 0 0 1-10 10A10 10 0 0 1 2 12 10 10 0 0 1 12 2a10 10 0 0 1 10 10m-6.5-4c.8 0 1.5.7 1.5 1.5s-.7 1.5-1.5 1.5-1.5-.7-1.5-1.5.7-1.5 1.5-1.5M10 9.5c0 .8-.7 1.5-1.5 1.5S7 10.3 7 9.5 7.7 8 8.5 8s1.5.7 1.5 1.5m2 4.5c1.75 0 3.29.72 4.19 1.81l-1.42 1.42C14.32 16.5 13.25 16 12 16s-2.32.5-2.77 1.23l-1.42-1.42C8.71 14.72 10.25 14 12 14"/></svg></button></div><div class="md-feedback__note"><div data-md-value="1" hidden> Thanks for your feedback! Consider starring us on <a href="https://github.com/kinginyellow/medianest" target="_blank" rel="noopener">GitHub</a> and sharing with the community. </div><div data-md-value="0" hidden> Thanks for your feedback! Help us improve by <a href="https://github.com/kinginyellow/medianest/issues/new/?title=[Docs]+MediaNest%20Environment%20Variables%20Reference+-+/environment-variables/" target="_blank" rel="noopener">creating an issue</a> or <a href="https://github.com/kinginyellow/medianest/edit/develop/docs/{path}" target="_blank" rel="noopener">editing this page</a>. </div></div></div></fieldset></form></article></div><script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script><script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script></div><button type="button" class="md-top md-icon" data-md-component="top" hidden><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button></main><footer class="md-footer"><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-copyright"><div class="md-copyright__highlight"> Copyright &copy; 2024 MediaNest Development Team - <a href="#__consent">Manage Cookies</a> | <a href="/privacy">Privacy Policy</a> | <a href="/terms">Terms of Service</a></div></div><div class="md-social"><a href="https://github.com/kinginyellow/medianest" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg></a><a href="https://hub.docker.com/r/medianest/medianest" target="_blank" rel="noopener" title="Docker Hub" class="md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 640 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M349.9 236.3h-66.1v-59.4h66.1zm0-204.3h-66.1v60.7h66.1zm78.2 144.8H362v59.4h66.1zm-156.3-72.1h-66.1v60.1h66.1zm78.1 0h-66.1v60.1h66.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1zm78.1 0h-66.1v59.4h66.1zm-78.1-72.1h-66.1v60.1h66.1z"/></svg></a><a href="https://discord.gg/medianest" target="_blank" rel="noopener" title="Discord Community" class="md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 576 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg></a><a href="https://twitter.com/medianest" target="_blank" rel="noopener" title="Twitter Updates" class="md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg></a><a href="https://medianest.com" target="_blank" rel="noopener" title="Official Website" class="md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg></a><a href="https://kinginyellow.github.io/medianest/" target="_blank" rel="noopener" title="Documentation" class="md-social__link"><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M384 512H96c-53 0-96-43-96-96V96C0 43 43 0 96 0h304c26.5 0 48 21.5 48 48v288c0 20.9-13.4 38.7-32 45.3V448c17.7 0 32 14.3 32 32s-14.3 32-32 32zM96 384c-17.7 0-32 14.3-32 32s14.3 32 32 32h256v-64zm32-232c0 13.3 10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24H152c-13.3 0-24 10.7-24 24m24 72c-13.3 0-24 10.7-24 24s10.7 24 24 24h176c13.3 0 24-10.7 24-24s-10.7-24-24-24z"/></svg></a></div></div></div></footer></div><div class="md-dialog" data-md-component="dialog"><div class="md-dialog__inner md-typeset"></div></div><div class="md-progress" data-md-component="progress" role="progressbar"></div><div class="md-consent" data-md-component="consent" id="__consent" hidden><div class="md-consent__overlay"></div><aside class="md-consent__inner"><form class="md-consent__form md-grid md-typeset" name="consent"><h4>Cookie consent</h4><p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p><input class="md-toggle" type="checkbox" id="__settings"><div class="md-consent__settings"><ul class="task-list"><li class="task-list-item"><label class="task-list-control"><input type="checkbox" name="analytics"><span class="task-list-indicator"></span> Google Analytics </label></li><li class="task-list-item"><label class="task-list-control"><input type="checkbox" name="github"><span class="task-list-indicator"></span> GitHub </label></li></ul></div><div class="md-consent__controls"><button class="md-button md-button--primary">Accept</button><button type="reset" class="md-button md-button--primary">Reject</button><label class="md-button" for="__settings">Manage settings</label></div></form></aside></div><script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script><script id="__config" type="application/json">{"base": "..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "content.footnote.tooltips", "content.tabs.link", "content.tooltips", "header.autohide", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.path", "navigation.prune", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow", "toc.integrate"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": {"API": "api", "Configuration": "config", "Docker": "docker", "Performance": "performance", "Reference": "reference", "Security": "security", "Setup": "setup", "Tutorial": "tutorial"}, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "default": "latest", "provider": "mike"}}</script><script src="../assets/javascripts/bundle.92b07e13.min.js"></script><script src="../js/timeago.min.js"></script><script src="../js/timeago_mkdocs_material.js"></script><script src="../javascripts/extra.js"></script><script src="../javascripts/medianest.js"></script><script src="../javascripts/search-enhancements.js"></script><script src="../javascripts/api-explorer.js"></script><script src="../javascripts/mermaid-config.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script><script src="https://unpkg.com/swagger-ui-dist@4.15.5/swagger-ui-bundle.js"></script></body></html>